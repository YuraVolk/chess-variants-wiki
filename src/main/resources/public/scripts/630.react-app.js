(self.webpackChunkspring_react_app=self.webpackChunkspring_react_app||[]).push([[630,513],{17015:function(e,t,i){"use strict";i.d(t,{w:function(){return o}});const o={doubleBackwardArrow:"!",downloadIcon:'"',endBackwardArrow:"#",forwardDoubleArrow:"α",userSearch:"$",userConnection:"%",notAllowed:"&",clock:"'",extraInformation:"(",authorshipNotice:")",draw:"+",backwardArrow:",",userInformation:"-",smallBackwardArrow:"/",leaderBoard:";",equal:"=",downwardArrow:"<",upperArrow:">",endForwardArrow:"@",urlAttached:"A",crossMark:"B",rightOutwardsArrow:"C",hashtag:"D",newspaper:"E",twitter:"F",checkMark:"G",camera:"H",alternativeLine:"I",play:"J",pause:"K",reload:"L",world:"M",points:"N",medal:"O",soundOff:"P",circleCrossMark:"Q",steadyEvaluation:"R",facebook:"S",circle:"T",soundOn:"U",plus:"V",openEye:"W",copyToClipboard:"X",wavingFlag:"Y",editText:"Z",fullArrowLeft:"[",fullArrowRight:"]",smallArrowForward:"\\",goBackArrow:"_",youtube:"`",calendar:"a",user:"b",chat:"c",lock:"d",box:"e",circularArrows:"f",lightBulb:"g",briefcase:"h",board:"i",knightArrows:"j",newMessage:"k",drawing:"l",twoUsers:"m",twoUsers2:"n",openingBook:"o",disclaimer:"p",ringingBell:"q",list:"r",rookAndPawn:"s",hamburgerList:"t",mail:"u",userExtraInformation:"v",house:"w",sheetAndPencil:"x",openMail:"y",chatBox:"z",fullArrowDown:"{",smallArrowUp:"|",fullArrowUp:"}",arrowIntoBox:"¡",key:"¢",file:"£",books:"¤",sharing:"¥",userNotAllowed:"¦",userCrossMark:"§",questionMark:"©",boardWithCircle:"«",googlePlus:"®",reset:"°",reddit:"±",openBook:"´",userPlus:"¶",cog:"·",pin:"»",suitcase:"¼",mark:"½",cake:"¾",openLink:"¿",bishopStroke:"Ä",linkedin:"Å",knight:"Ç",threeCheck:"Ë",chess960rapid:"Ñ",connection:"Õ",quotes:"Ö",exit:"×",crossedBinoculars:"Þ",leaderBoardReversed:"ß",bishopFull:"ä",printer:"å",verticalEvaluation:"ç",t:"ë",pawn:"í",twoPawns:"î",unrated:"ð",elite:"ñ",bug:"õ",cpu:"ö",forwardArrowCircle:"÷",squareCrossMark:"ü",android:"þ",twoUsersPlus:"ÿ",crossedArrows:"Đ",king:"Ā",kingFull:"ā",bishop:"Ă",twoFullRooks:"ă",kingStrokes:"Ą",fullKnight2:"ą",chess960:"Č",leaderBoardAscent:"č",crazyhouse:"Ď",checklist:"ď",target:"đ",pawnAndHalfRook:"Ē",halfRookAndPawn:"ē",knightStrokes:"Ė",pawnLogo:"Ę",queenFull:"ę",exchange:"Ě",userNext:"Ğ",userPrevious:"Ġ",compass:"ġ",pawnStrokes:"Ģ",rookStrokes:"ģ",screenDisplays:"Ħ",kingOfTheHill:"Ī",antichess:"ī",queen:"Į",threePawns:"į",queenStrokes:"Ķ",rookSmallStrokes:"Ļ",rookSmall:"Ľ",bishopPair:"Ł",rookPair:"Ņ",knightPair:"Ň",twoUsersSearch:"Ŋ",shield:"ŋ",kingSmall:"Ō",bishopSmall:"Ő",knightSmall:"Ŗ",userNoConnection:"Ř",userStream:"v",queenAlternative:"Ş",pawnAlternative:"Š",threePawnsAlternative:"Ţ",twoPawnsAlternative:"Ť",rookAlternative:"Ŧ",knightPairFull:"Ż",bishopPairFull:"Ž",addBoard:"ˆ",diamond:"Ͱ",scales:"ͱ",pawn3d:"Ͳ",userShieldPlus:"ͳ",gold:"Ͷ",ellipsis:"Ώ",analysis:"Δ",archive:"Θ",arrowBottomIntoBox:"Ξ",disclaimerEditor:"Σ",sendTrophy:"Υ",addCheckMark:"Φ",checkMarkSquare:"Ψ",squareStaircase:"ά",arrowsUpBottom:"έ",star:"ή",verticalDash:"ί",shieldCheckMark:"β",top3:"ε",addImage:"ζ",chessStream:"η",removeTrophy:"κ",importantMail:"λ",arrowLeave:"μ",donut:"ν",computerAnalysis:"ξ",checkMarkSquareSmall:"ο",diagonalExpandArrows:"π",leaderBoardHorizontal:"ρ",checkMarkAsCircle:"χ",arrowFromBox:"ϊ",boxArrowBottom:"ό",boxArrowLeft:"ύ",boxArrowRight:"ώ",fourArrowsCentral:"Ϙ",clashingSwords:"τ",ratingOffset:"υ",smilingFace:"ς",fileCabinet:"σ",editClock:"ϙ",userShield:"Ϛ",homeFilled:"ϛ",paymentCard:"Ϝ",fourArrowsOutwards:"ϝ",puzzle:"Ϟ",addPhoto:"ϟ",arrowWallLeft:"Ϡ",arrowWallRight:"ϡ",boardConfiguration:"Ϸ",fourBlocks:"ϸ",sandglass:"Ϻ",crown:"ϻ",cloudUpload:"Ẹ",webChatBox:"ẹ",puzzleRush:"Ẻ",knightHops:"ẻ",instagram:"ἀ",squarePlus:"ἁ",squareMinus:"ἂ",squareEqual:"ἃ",square:"ἄ",fireFull:"ἅ",pawnRecycle:"ἆ",noEngine:"ἇ",google:"Ἀ",fourPlayer:"Ἁ",pieceMeal:"Ἂ",arrowBoldUp:"Ἃ",arrowBoldDown:"Ἄ",blunder:"Ἅ",mistake:"Ἆ",videoChatBox:"Ἇ",bonesCrossed:"ἐ",displays:"ἑ",arrowEnter:"ἒ",newspaperHalf:"ἓ",bookmark:"ἔ",puzzleLarge:"ἕ",movePawn:"Ἐ",pawn3dLarge:"Ἑ",sun:"Ἒ",rapid:"Ἓ",blitz:"Ἔ",bullet:"Ἕ",mortarboard:"ἠ",laptop:"ἡ",resetWidth:"ἢ",pawnConnection:"ἣ",copyToClipboardFromText:"ἤ",fire:"ἥ",crownSmall:"ἦ",orderedList:"ἧ",chess960daily:"Ἠ",arrowWallBottom:"Ἡ",pawn3dBold:"Ἢ",plusInCircle:"Ἣ",lightCorner:"Ἤ",darkCorner:"Ἥ",steepCurve:"Ἦ",heart:"Ἧ",checkMarkThin:"ἰ",connectionDiagonal:"ἱ",diadem:"ἲ",plusMinus:"ἳ",recycling:"ἴ",metrics:"ἵ",top1:"ἶ",engineCheckMark:"ἷ",wikipedia:"Ἰ",tournament:"Ἱ",houseConfiguration:"Ἲ",computerHindsight:"Ἳ",computerCheckMark:"Ἴ",lightDarkTheme:"Ἵ",whistlingBell:"Ἶ",crossMarkCompact:"Ἷ",eyeCrossed:"ὀ",fide:"ὁ",favorite:"ὂ",tShirtPawn:"ὃ",addSmile:"ὄ",library:"ὅ",discord:"Ὀ",analysisCheckMark:"Ὁ",versusComputer:"Ὂ",dollarSign:"Ὃ",bestMove:"Ὄ",gift:"Ὅ",evaluationLinear:"ὐ",evaluationThrowaway:"ὑ",evaluationEqual:"ὒ",evaluationDead:"ὓ",evaluationSharp:"ὔ",evaluationPerplexing:"ὕ",evaluationSmooth:"ὖ",libraryAdd:"ὗ",selfPartner:"Ὑ",fourPlayerConfiguration:"Ὓ",listDownFlow:"Ὕ",puzzleBattle:"Ὗ",hyperbullet:"ὠ",gameLink:"ὡ",gameStudy:"ὢ",evaluationCrazy:"ὣ",engine:"ὤ",crossedSwordsInCircle:"ὥ",hallmark:"ὦ",like:"ὧ",boardTwoPlayers:"Ὠ",fourPlayerChess:"Ὡ",variants:"Ὢ",cloudUploadCompact:"Ὣ",clockIncrement:"Ὤ",videoCamera:"Ὥ",inaccuracy:"Ὧ",bot:"ὰ",torpedo:"ά",vk:"ὲ",blindfold:"έ",customSettings:"ή",captureAnything:"ὶ",pawnSideways:"ί",noCastling:"ὸ",fogOfWar:"ό",automate:"ὺ",atomic:"ύ",pawnCounterfeit:"ὼ",elephant:"ώ",fullBlock:"ᾀ",fourFullBlocks:"ᾁ",nineFullBlocks:"ᾂ",nineFullBlocksCrossed:"ᾃ",hamburgerMenuCompact:"ᾄ",listCompact:"ᾅ",geoMark:"ᾆ",crossedDonut:"ᾇ",handshake:"ᾈ",verified:"ᾉ",sandglassRunningOut:"ᾊ",rapidLowOnTime:"ᾋ",tourneyBanner:"ᾌ",noCloud:"ᾍ",fork:"ᾎ",donutTarget:"ᾏ",newCalendarDay:"ᾐ",cornerInfiltration:"ᾑ",hastTagCompact:"ᾒ",chatterbox:"ᾓ",circleStar:"ᾔ",targetPractice:"ᾕ",pawnPromotion:"ᾖ",flagProgression:"ᾗ",pawnDoubleAttack:"ᾘ",kingAndRook:"ᾙ",specialMedal:"ᾚ",pawnBanner:"ᾛ",userSquare:"ᾜ",verifiedCandidate:"ᾝ",saveFile:"ᾞ",duck:"ᾟ",addBanner:"ᾠ",qrCode:"ᾡ",noAnalysis:"ᾢ",dualPawn:"ᾣ",gameEscape:"ᾤ",tournamentCup:"ᾥ",noExchanges:"ᾦ",tikTok:"ᾰ",pieChart:"ᾱ",search:"–",binoculars:"—",largeBoard:"’",exclamation:"†",tournamentCupIcon:"‡",trashBin:"•",arrowForwardBoldCompact:"…",giftDiamond:"‹",filter:"›",noChat:"⁄",newSheet:"€",xml:"∞",blockUser:"∫",facebookLike:"≤",facebookDislike:"≥",apple:"◊",phone:""}},72714:function(e,t,i){"use strict";i.d(t,{CG:function(){return n},VS:function(){return r},fJ:function(){return o},fi:function(){return s},h0:function(){return c},lM:function(){return a},s8:function(){return l}});const o=e=>"function"==typeof e,r=(e,t)=>Array.from({length:t}).fill(e),s=(e,t)=>Array.from({length:t},e),n=(e,t)=>e.length===t;function a(e){if(null==e)throw new Error("Expected the data above to be anything but null or undefined")}function c(e){throw console.dir(e),new TypeError("Unexpected argument that is supposed to be of type never")}function l(e){e.keys().forEach(e)}},5200:function(e,t,i){"use strict";i.d(t,{TG:function(){return r}});const o=/^#(?:[0-9a-fA-F]{3}){1,2}$/,r=e=>{if(o.test(e))return e;throw new TypeError("The supplied hex color is not a hex color: "+e)}},92052:function(e,t,i){"use strict";i.d(t,{BD:function(){return s},ft:function(){return a},sC:function(){return n},x_:function(){return c}});var o=i(72714),r=i(5593);const s=e=>(0,o.fi)((()=>(0,o.fi)(e,r.iJ)),r.iJ),n=e=>e%2==0;function a(e){const t=e%2;if(0!==t&&1!==t)throw new Error(`Invalid number passed: ${e}`);return t}function c(e){const t=e%2^1;if(0!==t&&1!==t)throw new Error(`Invalid number passed: ${e}`);return t}},59630:function(e,t,i){"use strict";i(21714);var o=i(53975),r=i(5593),s=i(12850),n=i(17744),a=i(14381),c=i(8971),l=i(20461),u=i(72714),d=i(30211);function p(e,t){let i;const o=t[0];if((0,n.$j)(o))i=e.getLegalMoves(o.startCoordinates[0],o.startCoordinates[1]);else if((0,n.x7)(o))i=e.getDroppingMoves(o.piece);else{if(!(0,n.LR)(o))throw new Error(`Unexpected move signature encountered: ${JSON.stringify(t)}`);i=e.getAllowedInternalMoves()}const r={hasEnPassant:!1};if(e.variantData.duckChess&&1===t.length)return!1;for(const e of t){const t=i.find((t=>(0,n.JG)(t,e)));if(!t)return!1;(0,n.$j)(t)&&t.specialType===n.uj.EnPassant&&(r.hasEnPassant=!0),t.nextChainedMoves&&(i=t.nextChainedMoves)}return r}var h=i(80171);function f(e,t){const i=e.createClone();i.moves=(0,h.g7)(i.createSnapshot()),i.pregenerateAttacks();const o=Math.max(...i.data.fenOptions.tag("dim"));return function t(a,l=0,d=(0,u.VS)(e.gameData.timeControl.baseTime,r.q3)){let f=-1;for(let e=0;e<a.length;e++){const u=a[e],{moveData:g,path:m,alternativeLines:v}=u,y=(0,n.Zp)({moveData:g,path:m.slice()},{comment:u.comment});let b;try{if(!(b=p(i,g)||void 0))break;y.moveData=g}catch{break}let P=!1;for(const e of g)(0,n.$j)(e)&&(e.promotion&&(e.promotion=e.promotion.map((e=>e.isWall()?e:(0,s.HC)(i.data.sideToMove,e.piece)))),P||(y.metadata.movingPiece=i.board[e.startCoordinates[0]][e.startCoordinates[1]],P=!0),b.hasEnPassant&&(e.specialType=n.uj.EnPassant,b.hasEnPassant=!1,y.metadata.isCapture=!0),i.data.getCapturedPieces(e).length>0&&(y.metadata.isCapture=!0));0!==e&&(0,c.qr)(i.data.fenOptions.tag("dead"),(e=>!e))!==f||(y.metadata.currentFullMove=++l),y.metadata.currentSideToMove=f=i.data.sideToMove;const C=i.makeMove(g);for(let e=0;e<r.q3;e++)C.checkmates[e]?y.metadata.checkmates++:C.checks[e]&&y.metadata.checks++;for(const e of v)y.alternativeLines.push(t(e,l,[...d]));u.metadata.playerClock&&(d[f]-=u.metadata.playerClock),y.metadata={...u.metadata},y.metadata.playerClock=d[f];const k=i.moves.getMove(y.path);(0,h.RR)(k),k.metadata=y.metadata,k.comment=u.comment,i.moves.stringifyMove(k,o)}return[]}(t.moves),i.moves}function g(e){const t=e.moves.getMove([e.moves.moves.length-1]),i=e.moves.getBoardSnapshot((0,h.xn)(t)?t:-1);if((0,u.lM)(i),i.boardSnapshot.data.gameOver){if(e.gameData.termination=i.boardSnapshot.data.gameOver,e.gameData.result)return;if(e.isTwoPlayer||e.gameType.type===r.Jy.Teams){const t=e.createSnapshot();e.loadSnapshot(i.boardSnapshot),e.gameData.result=e.data.getCurrentResult(),e.loadSnapshot(t)}else{const t=[],o=e.data.fenOptions.tag("dead"),s=e.data.fenOptions.tag("resigned"),n=e.data.fenOptions.tag("wb"),a=i.boardSnapshot.data.points;for(const e of r.O9)o[e]||s[e]||t.push(`${(0,r.oh)(e,n)}: ${a[e]}`);e.gameData.result=t.join(" – ")}}}var m=i(11390),v=i(43341),y=i(22953),b=function(e,t,i,o){var r,s=arguments.length,n=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(n=(s<3?r(n):s>3?r(t,i,n):r(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n},P=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const C=[],k=[],T={};function M(){return function(e,t,i){const o=i.value;i.value=function(...e){postMessage([t,o.apply(this,e)])}}}function S(e,t){return function(i,o){"required"===e?(k.push(o),C.push(o)):k.push(o),T[o]=t}}class w{board;initiallyAliveColors=[];internalMoves=[];legalMoves=new Map;fogOfWarPerspective=!1;stripPieceStrings(e){return JSON.parse(JSON.stringify(e))}generateInitiallyAliveColors(){return this.board.data.fenOptions.tag("dead").map((e=>!e)).reduce(((e,t,i)=>t?[...e,i]:e),[])}generateCurrentMoves(){this.internalMoves=this.board.getAllowedInternalMoves(),this.legalMoves=new Map;for(const e of this.board.getPlayerPieces()[this.board.data.sideToMove])this.legalMoves.set((0,d.Kv)(e),this.board.getLegalMoves(e[0],e[1]))}construct(e,t){this.board=new o.$(e),this.board=(0,a.I)(this.board,o.$,this.board.variantRules.boardDecorators),this.generateInitiallyAliveColors();const i=new m.InsufficientMaterialConstructor(this.board,(e=>{this.board.insufficientMaterialChecker=new v.InsufficientMaterialChecker(e,this.board),this.board.moves=f(this.board,this.board.moves),this.board.moves.currentMove=[-1],g(this.board),this.generateCurrentMoves(),postMessage(["construct",y.serializeInsufficientMaterialState(e)])}));return i.generateInsufficientMaterialState(),y.serializeInsufficientMaterialState(i.state)}constructWithGeneratedData(e,t){this.board=new o.$(e),this.board=(0,a.I)(this.board,o.$,this.board.variantRules.boardDecorators),this.generateInitiallyAliveColors(),this.board.insufficientMaterialChecker=new v.InsufficientMaterialChecker((0,y.deserializeInsufficientMaterialState)(t),this.board),this.board.moves=f(this.board,this.board.moves),this.board.moves.currentMove=[-1],g(this.board),this.generateCurrentMoves()}getFENSettings(){const e=this.board,t=(0,u.VS)(0,r.q3);let i=!1;for(const e of this.board.board){for(const o of e)if(o.isPiece()&&"K"===o.piece&&++t[o.color]>1){i=!0;break}if(i)break}const o=[...e.data.points];return{sideToMove:e.data.sideToMove,points:o,isCustomRoyals:i,fenOptions:e.data.fenOptions.createSerializedState()}}getInitiallyAliveColors(){return this.initiallyAliveColors}getMoveTree(){const e=(t,i=0)=>{const o=[];for(const r of t){const t={alternativeLines:[],comment:r.comment,path:r.path.slice(),cachedNames:{...r.cachedNames},metadata:{currentSideToMove:r.metadata.currentSideToMove,playerClock:r.metadata.playerClock,highlightedArrows:r.metadata.highlightedArrows,highlightedSquares:r.metadata.highlightedSquares}};r.metadata.currentFullMove&&(t.metadata.currentFullMove=r.metadata.currentFullMove);for(const o of r.alternativeLines)t.alternativeLines.push(e(o,i-1));o.push(t)}return o};return e(this.board.moves.moves)}loadSnapshotByPath(e){let t;if((0,c.Rt)(e,[-1])){const e=this.board.moves.getBoardSnapshot(-1);(0,u.lM)(e),t=e}else{const i=this.board.moves.getMove(e);(0,h.RR)(i);const o=this.board.moves.getBoardSnapshot(i);if(!o)return!1;t=o}return this.board.loadSnapshot(t.boardSnapshot),this.board.moves.currentMove=[...e],this.generateCurrentMoves(),!0}verifyNextChainedMovesAreDeleted(e){return!("nextChainedMoves"in e)}convertStrippedMoveToNormal(e){const t=[];for(const i of e){if(delete i.nextChainedMoves,!this.verifyNextChainedMovesAreDeleted(i))throw new Error("Could not delete nextChainedMoves in move component");(0,n.$j)(i)?t.push({...i,promotion:i.promotion?.map((e=>s.Ff.fromObjectToClass(e)))}):(0,n.x7)(i)?t.push({...i,piece:s.Ff.fromObjectToClass(i.piece)}):t.push(i)}if(!(0,n.nc)(t))throw new Error("Supplied move object had 0 move components");return t}makeMove(e){const t=this.board,i=this.convertStrippedMoveToNormal(e);t.moves.augmentMoveWithMetadata({move:i,board:t,makeMoveFunction:()=>t.makeMove(i)}),this.generateCurrentMoves()}serializeBoardToPGN(){return(0,l.V)(this.board)}getDroppingMoves(e){return this.board.data.gameOver?[]:this.stripPieceStrings(this.board.getDroppingMoves(s.Ff.fromObjectToClass(e)))}getLegalMoves(e,t){return this.board.data.gameOver?[]:this.stripPieceStrings(this.legalMoves.get((0,d.Kv)([e,t]))??this.board.getLegalMoves(e,t))}getInternalMoves(){return this.board.data.gameOver?[]:this.stripPieceStrings(this.internalMoves)}getVariantData(){return this.stripPieceStrings(this.board.variantData)}getBoard(){return this.board.board.map((e=>e.map((e=>e.toObject()))))}getGameData(){const e={...this.board.gameData};return"object"==typeof e.date&&(e.date=e.date.toUTCString()),e}getCurrentMove(){return this.board.moves.currentMove}getVariantRules(){const e=[];for(const t of this.board.variantRules)e.push(t.getPublicProperties());return e}getVariantType(){return this.board.gameType.type}deleteMove(e){0!==this.board.moves.moves.length&&this.board.moves.deleteMove(e)}playPreferredBotMove(){if(this.board.data.getRealPlayers()<=1)return;const e=[];for(const t of this.board.getPlayerPieces()[this.board.data.sideToMove])e.push(...this.legalMoves.get((0,d.Kv)(t))??this.board.getLegalMoves(t[0],t[1]));e.push(...this.board.preGeneratedAttacks[this.board.data.sideToMove].pieceDrops.piece),e.push(...this.board.preGeneratedAttacks[this.board.data.sideToMove].pieceDrops.pawn),e.push(...this.internalMoves);const t=this.board.data.fenOptions.getDefaultZombieAlgorithm(this.board.data.sideToMove),i=t.evaluate(e,this.board);return this.stripPieceStrings(t.pickPreferredMove(i))}changeFogPerspective(){if(!this.board.variantData.fogOfWar||this.board.data.getRealPlayers()<=1)return this.fogOfWarPerspective;if(!1===this.fogOfWarPerspective)this.fogOfWarPerspective=this.board.data.sideToMove;else{const e=this.board.data.nextTurn(this.fogOfWarPerspective);e===this.board.data.sideToMove?this.fogOfWarPerspective=!1:this.fogOfWarPerspective=e}return this.fogOfWarPerspective}getSquareVisibility(){if(!1===this.fogOfWarPerspective)return this.board.getSquareVisibility();{const e=this.board.data.sideToMove;this.board.data.sideToMove=this.fogOfWarPerspective;const t=this.board.getSquareVisibility();return this.board.data.sideToMove=e,t}}}b([M(),P("design:type",Function),P("design:paramtypes",[String,Object]),P("design:returntype",void 0)],w.prototype,"constructWithGeneratedData",null),b([S("required","publicFENSettings"),M(),P("design:type",Function),P("design:paramtypes",[]),P("design:returntype",void 0)],w.prototype,"getFENSettings",null),b([S("initial","initiallyAliveColors"),M(),P("design:type",Function),P("design:paramtypes",[]),P("design:returntype",void 0)],w.prototype,"getInitiallyAliveColors",null),b([S("required","moveTree"),M(),P("design:type",Function),P("design:paramtypes",[]),P("design:returntype",void 0)],w.prototype,"getMoveTree",null),b([M(),P("design:type",Function),P("design:paramtypes",[Array]),P("design:returntype",void 0)],w.prototype,"loadSnapshotByPath",null),b([M(),P("design:type",Function),P("design:paramtypes",[Object]),P("design:returntype",void 0)],w.prototype,"makeMove",null),b([S("required","serializedPGN"),M(),P("design:type",Function),P("design:paramtypes",[]),P("design:returntype",void 0)],w.prototype,"serializeBoardToPGN",null),b([M(),P("design:type",Function),P("design:paramtypes",[Object]),P("design:returntype",void 0)],w.prototype,"getDroppingMoves",null),b([M(),P("design:type",Function),P("design:paramtypes",[Number,Number]),P("design:returntype",void 0)],w.prototype,"getLegalMoves",null),b([S("required","allowedInternalMoves"),M(),P("design:type",Function),P("design:paramtypes",[]),P("design:returntype",void 0)],w.prototype,"getInternalMoves",null),b([S("initial","variantDataRules"),M(),P("design:type",Function),P("design:paramtypes",[]),P("design:returntype",void 0)],w.prototype,"getVariantData",null),b([S("required","boardSquares"),M(),P("design:type",Function),P("design:paramtypes",[]),P("design:returntype",void 0)],w.prototype,"getBoard",null),b([S("required","gameData"),M(),P("design:type",Function),P("design:paramtypes",[]),P("design:returntype",void 0)],w.prototype,"getGameData",null),b([S("required","currentMove"),M(),P("design:type",Function),P("design:paramtypes",[]),P("design:returntype",void 0)],w.prototype,"getCurrentMove",null),b([S("initial","variantRules"),M(),P("design:type",Function),P("design:paramtypes",[]),P("design:returntype",void 0)],w.prototype,"getVariantRules",null),b([S("initial","variantType"),M(),P("design:type",Function),P("design:paramtypes",[]),P("design:returntype",void 0)],w.prototype,"getVariantType",null),b([M(),P("design:type",Function),P("design:paramtypes",[Array]),P("design:returntype",void 0)],w.prototype,"deleteMove",null),b([M(),P("design:type",Function),P("design:paramtypes",[]),P("design:returntype",void 0)],w.prototype,"playPreferredBotMove",null),b([M(),P("design:type",Function),P("design:paramtypes",[]),P("design:returntype",void 0)],w.prototype,"changeFogPerspective",null),b([S("required","squareVisibility"),M(),P("design:type",Function),P("design:paramtypes",[]),P("design:returntype",void 0)],w.prototype,"getSquareVisibility",null);const D=new w;self.onmessage=e=>{e.data.requestName in w.prototype&&w.prototype[e.data.requestName].apply(D,e.data.parameters)}},53975:function(e,t,i){"use strict";i.d(t,{$:function(){return k},i:function(){return C}});var o=i(72714),r=i(92052),s=i(80171),n=i(17744),a=i(77028),c=i(5593),l=i(14230),u=i(12850),d=i(14381),p=i(34275),h=i(19659),f=i(88706);class g{_control;_isConfigured;constructor(e){this._control=e,this._isConfigured={coordinates:[0,0],board:(0,r.BD)((()=>u.v2)),immunePieces:(0,o.VS)(!1,c.q3),color:0}}setCoordinates(e,t){return this._isConfigured.coordinates=[e,t],this}setBaseImmunePieces(e){return this._isConfigured.immunePieces=e,this}setColor(e){return this._isConfigured.color=e,this}setBoard(e){return this._isConfigured.board=e,this}constructPieceControl(){return this._control.configure(this._isConfigured),this._control}}class m{_generalConfig;constructor(){this._generalConfig={}}setFENData(e){this._generalConfig.fenData=e}setVariantRules(e){this._generalConfig.variantRules=e}createPieceControlWrap(e){const t=new f.Gf[e].construct;if(!this._generalConfig.fenData||!this._generalConfig.variantRules)throw new Error("PieceControl builder setup is not complete");t.setFENData(this._generalConfig.fenData);const i=(0,d.I)(t,h.V,(0,p.KH)(this._generalConfig.variantRules));return()=>new g(i)}}var v=i(49727),y=i(30211),b=i(67037),P=i(20461);(0,v.D)();const C=(0,o.VS)(!1,c.q3);class k{controls={};data;moves;preGeneratedAttacks=(0,o.fi)(y.RN,c.q3);board;isComplexSetup=(0,y.Ov)();gameData;gameType=(0,y.Bd)();variantRules;variantData;isTwoPlayer;insufficientMaterialChecker;__baseClass;initDecoratorSettings(){}constructor(e){this.__baseClass=this;const t=(0,P.W)(e);this.gameType.type=t.gameType,this.variantRules=t.variantRules,this.gameData=t.gameData,this.board=t.board,this.data=t.fenData,this.data.injectBoard(this),this.data=(0,d.I)(this.data,a.c,this.variantRules.fenDataDecorators),this.variantData=t.variantRuleData,this.variantRules=(0,p.xU)(this),this.isTwoPlayer=2===this.data.getRealPlayers(),this.initPieceControls(t.pieceSet),this.moves=(0,s.g7)(this.createSnapshot()),this.moves.moves=t.moves,this.pregenerateAttacks()}initPieceControls(e){if(0===e.size)return;const t=new m;t.setFENData(this.data),t.setVariantRules(this.variantRules.pieceControlDecorators);for(const i of e){const e=t.createPieceControlWrap(i);this.controls[i]=e}}getSquareVisibility(){return(0,r.BD)((()=>[]))}createSnapshot(){return{data:this.data.createSnapshot(),board:this.board.map((e=>[...e])),isComplexSetup:Object.assign({},this.isComplexSetup)}}loadSnapshot(e){this.isComplexSetup={...e.isComplexSetup},this.data.loadSnapshot(e.data),this.board=e.board.map((e=>[...e])),this.pregenerateAttacks(),this.runComplexLegalityEvaluationChecks()}createClone(){let e=(0,b.lJ)(this.__baseClass,k);e.board=this.board.map((e=>[...e])),e.isComplexSetup=Object.assign({},this.isComplexSetup),e.preGeneratedAttacks=(0,o.fi)(y.RN,c.q3),e.data=this.data.createClone(),e=(0,d.I)(e,k,(0,p.KH)(this.__baseClass.variantRules.boardDecorators)),e.data.injectBoard(e),e.data=(0,d.I)(e.data,a.c,(0,p.KH)(this.__baseClass.variantRules.fenDataDecorators));const t=new Set;let i;for(i in this.controls)Object.prototype.hasOwnProperty.call(this.controls,i)&&t.add(i);return e.initPieceControls(t),e.pregenerateAttacks(),e}isKingInCheck(e,t=this.data.fenOptions.tag("royal")){const i=t[e];if(!i||this.data.fenOptions.tag("dead")[e])return!1;const o=i;return!(!this.preGeneratedAttacks[e].slidingPieces[o[0]][o[1]]&&!this.preGeneratedAttacks[e].hoppingPieces[o[0]][o[1]])}getPlayerPieces(){const e=[[],[],[],[]];for(let t=0;t<c.iJ;t++)for(let i=0;i<c.iJ;i++){const o=this.board[t][i];if(o.isEmpty())continue;const r=o.color;r!==u.Ir&&e[r].push([t,i])}return e}getCheckmatesAndStalemates(){const e=this.data.fenOptions.tag("dead"),t=this.data.fenOptions.tag("royal"),i=(0,o.VS)(!1,c.q3),r=(0,o.VS)(!1,c.q3),s=this.getPlayerPieces();r[this.data.sideToMove]=!0;for(const t of c.O9){if(e[t])continue;const o=s[t];this.isKingInCheck(t)&&(i[t]=!0);for(const e of o)if(this.getLegalMoves(e[0],e[1],t).length){r[t]=!0;break}r[t]||(this.preGeneratedAttacks[t].pieceDrops.pawn.length||this.preGeneratedAttacks[t].pieceDrops.piece.length)&&(r[t]=!0)}const n=t.map(((t,i)=>!(e[i]||!t)&&(this.board[t[0]][t[1]].isEmpty()||this.board[t[0]][t[1]].color!==i)));return{checkmates:r.map(((e,t)=>n[t]||!e&&i[t])),stalemates:r.map(((e,t)=>!e&&!i[t])),checks:i}}runComplexLegalityEvaluationChecks(){if(!this.isComplexSetup.hasComplexRules)for(let e=0;e<c.iJ;e++)for(let t=0;t<c.iJ;t++){const i=this.board[e][t];if(i.isPiece()&&f.Gf[i.piece].moveGenerationSettings.isComplex)return void(this.isComplexSetup.hasComplexPieces=!0)}}getCurrentChecks(e=this.data.sideToMove){const t=this.data.fenOptions.tag("dead"),i=this.data.fenOptions.tag("resigned"),r=this.data.fenOptions.tag("royal").map(((e,o)=>!e||t[o]||i[o]?null:e)),s=(0,o.fi)((()=>[]),c.q3);for(const[t,i]of this.preGeneratedAttacks[e].pieceMovements)for(const o of i)for(const i of c.O9){if(i===e)continue;const n=r[i];n&&(0,y.ef)(n,o.move)&&s[i].push(t)}return s}makeMove(e,t=!1){let i;const o=this.data.sideToMove,r=this.preGeneratedAttacks;for(let o=0;o<e.length;o++)o===e.length-1?i=this.data.affectOptions(e[o],{ignoreCheckmateChecks:t,ignoreNextTurn:!1}):this.data.affectOptions(e[o],{ignoreCheckmateChecks:t,ignoreNextTurn:!0});if(this.runComplexLegalityEvaluationChecks(),t)return i;const s=this.moves.currentMove.slice();return s[s.length-1]++,this.moves.currentMove=this.moves.setNewMove({move:(0,n.Zp)({path:s,moveData:e}),snapshot:{boardSnapshot:this.createSnapshot(),pregeneratedAttacks:r[o]},fenDataString:this.moves.constructPreliminaryHashString(this)}),this.data.gameOver||1===this.data.getRealPlayers()||(i.checkmates[this.data.sideToMove]?i=this.makeMove([{type:n.Fi.TeamsCheckmate}],!0):i.stalemates[this.data.sideToMove]&&(i=this.makeMove([{type:n.Fi.Stalemate}]))),i}pregenerateAttacks(e=!1){const t=this.data.fenOptions.tag("royal");this.preGeneratedAttacks=(0,o.fi)(y.RN,c.q3),this.getPlayerPieces().forEach(((i,o)=>{if(!1!==e&&e!==o)return;const r=this.preGeneratedAttacks[o];for(const e of i){const i=this.board[e[0]][e[1]];if(!i.isPiece())continue;const s=i.color,n=i.piece,a=this.controls[n]().setColor(s).setCoordinates(e[0],e[1]).setBoard(this.board),l=f.Gf[i.piece],u=[];let d=a.setBaseImmunePieces(this.gameType.getBaseColors(s)).constructPieceControl();if(u.push(...d.getPseudoLegalMoves()),d=a.setBaseImmunePieces(C).constructPieceControl(),l.moveGenerationSettings.isJumping){const t=d.rayGenJumpingAttacks();for(const{move:i}of t)for(const t of c.O9){if(t===o)continue;const r=this.preGeneratedAttacks[t];r.hoppingPieces[i[0]][i[1]]++,r.hoppingPieceLines.push([e,i]);const s=r.attackingColors[i[0]][i[1]];~s&&r.attackingColors[i[0]][i[1]]!==t+1&&(r.attackingColors[i[0]][i[1]]=0===s?1+t:-1)}}if(l.moveGenerationSettings.isSliding){const i=d.rayGenSlidingAttacks();for(const t of i)for(const i of c.O9){if(i===o)continue;const r=this.preGeneratedAttacks[i];for(const{move:e}of t){r.slidingPieces[e[0]][e[1]]++;const t=r.attackingColors[e[0]][e[1]];~t&&r.attackingColors[e[0]][e[1]]!==i+1&&(r.attackingColors[e[0]][e[1]]=0===t?1+i:-1)}if(0!==t.length)r.slidingPiecesLines.push([e,t.map((e=>e.move))]);else{const t=[];r.slidingPiecesLines.push([e,t])}}const r=d.rayGenSlidingAttacks(f.hK.RayTraceLimited);for(const i of r)for(const r of c.O9){if(r===o)continue;const s=this.preGeneratedAttacks[r];if(0!==i.length){let o=!1;const n=[];for(const{move:e}of i)n.push(e),o?s.slidingPieces[e[0]][e[1]]++:(0,y.ef)(t[r]??[-1,-1],e)&&(o=!0);s.slidingPiecesRayTracing.push([e,i.map((e=>e.move))])}else s.slidingPiecesLines.push([e,[]])}}r.pieceMovements.set((0,y.Kv)(e),u)}r.pieceDrops.piece=this.getDroppingMoves((0,u.HC)(o,l.KR.wall)),r.pieceDrops.pawn=this.getDroppingMoves((0,u.HC)(o,u.Fb.piece))}))}isSetupComplex(){return this.isComplexSetup.hasComplexPieces||this.isComplexSetup.hasComplexRules||this.data.isComplexEvaluation()}isTheMoveLegal(e,t,i=!1){const o=this.data.fenOptions.tag("royal"),{startCoordinates:[r,s],endCoordinates:[n,a]}=t,l=o[e];if(!this.board[n][a].isEmpty()&&l&&n===l[0]&&a===l[1])return!1;if(this.isSetupComplex()){const t=this.createSnapshot(),o=[{startCoordinates:[r,s],endCoordinates:[n,a]}];i&&o.push({piece:u.cG,endCoordinates:[r,s]});const{checks:c,checkmates:l}=this.makeMove(o,!0);let d=c[e]||l[e];return d||(this.pregenerateAttacks(e),d=this.isKingInCheck(e)),this.loadSnapshot(t),!d}{const[i,u]=l??[null,null],d=this.preGeneratedAttacks[e];if(null===i)return!0;const p=i===r&&u===s,h=d.hoppingPieces[i][u]+d.slidingPieces[i][u],f=d.slidingPieces[n][a]+d.hoppingPieces[n][a]===0,g={canKingCapture:void 0};for(const t of c.O9){const r=o[t];if(t!==e&&r&&r[0]===n&&r[1]===a){const e=d.attackingColors[r[1]][r[0]];e!==t+1&&0!==e||!p&&d.attackingColors[i][u]!==t+1||(g.canKingCapture=t+1)}}if(!this.gameType.isFFA()&&void 0!==g.canKingCapture)return!0;for(const[e,o]of d.slidingPiecesRayTracing){let c=!1,l=!1,d=!1;for(const[h,f]of o)if(c||h!==r||f!==s?d||l||h!==n||f!==a||(d=!0):c=!0,l||h!==i||f!==u||(l=!0),p){if(l&&h===n&&f===a){if(g.canKingCapture&&g.canKingCapture>0&&this.board[h][f].color+1===g.canKingCapture)continue;return!1}}else if(c&&l&&!(0,y.ef)(e,t.endCoordinates)&&!d){if(g.canKingCapture&&g.canKingCapture>0&&this.board[h][f].color+1===g.canKingCapture)continue;return!1}}if(h>1)return p&&f||Boolean(g.canKingCapture);if(1===h){if(p)return f||Boolean(g.canKingCapture);if(1===d.hoppingPieces[i][u]){for(const[e,t]of d.hoppingPieceLines)if(t[0]===i&&t[1]===u&&e[0]===n&&e[1]===a)return!0;return Boolean(g.canKingCapture)}for(const[e,o]of d.slidingPiecesLines){let r=!1,s=!1;for(const[c,l]of o)if(r||c!==i||l!==u?s||r||c!==n||l!==a||(s=!0):r=!0,r&&!(0,y.ef)(e,t.endCoordinates)&&!s){if(g.canKingCapture&&g.canKingCapture>0&&this.board[c][l].color+1===g.canKingCapture)continue;return Boolean(g.canKingCapture)}}return!0}return!p||f||Boolean(g.canKingCapture)}}getCastlingMoves(e){const{i:t,j:i,baseColor:o}=e,r=[],s=this.data.fenOptions.tag("royal")[o];return s&&s[0]===t&&s[1]===i&&(this.data.fenOptions.isKingsideCastlingAvailable(o,this)&&r.push({startCoordinates:[t,i],endCoordinates:this.data.fenOptions.getKingsideCastlingEndCoordinate(o),specialType:n.uj.CastlingKingside}),this.data.fenOptions.isQueensideCastlingAvailable(o,this)&&r.push({startCoordinates:[t,i],endCoordinates:this.data.fenOptions.getQueensideCastlingEndCoordinate(o),specialType:n.uj.CastlingQueenside})),r}getEnPassantMoves(e){const{i:t,j:i,baseColor:o,pieceLetter:r}=e,s=[];if(f.Gf[r].moveGenerationSettings.isPawn){const e=this.data.fenOptions.getAvailableEnPassantCaptures(o),a=this.controls[r]().setBaseImmunePieces(this.gameType.getBaseColors(o)).setBoard(this.board).setCoordinates(t,i).setColor(o).constructPieceControl().rayGenJumpingAttacks();if(0!==e.length)for(const r of a)for(const a of e)if((0,y.ef)(r.move,a)){const e=this.createSnapshot(),a=[{startCoordinates:[t,i],endCoordinates:r.move,specialType:n.uj.EnPassant,isIrreversible:r.irreversible}];this.makeMove(a,!0),this.pregenerateAttacks(),this.isKingInCheck(o)||s.push(a[0]),this.loadSnapshot(e)}}return s}getSpecialMoves(e){return[...this.getCastlingMoves(e),...this.getEnPassantMoves(e)]}getLegalMoves(e,t,i=this.data.sideToMove,r=!1){const s=this.board[e]?.[t],n=this.data.fenOptions.tag("royal")[i];if(s.isPiece()){const a=s.color;if(a!==i)return[];const c=this.preGeneratedAttacks[a].pieceMovements.get((0,y.Kv)([e,t]));(0,o.lM)(c);const l=this.getSpecialMoves({i:e,j:t,baseColor:i,pieceLetter:s.piece});return[...c.map((i=>{const o={startCoordinates:[e,t],endCoordinates:i.move,isIrreversible:i.irreversible};return i.move[2]&&(o.promotion=i.move[2].split("").map((e=>(0,u.HC)(a,e)))),o})).filter((e=>{const t=this.data.getCapturedPieces(e),i=n&&t.find((e=>n[0]===e[0]&&n[1]===e[1]));return this.isTheMoveLegal(a,e,r)&&!i})),...l]}return[]}getDroppingMoves(e,t=this.data.sideToMove){return[]}getAllowedInternalMoves(e=this.data.sideToMove){const t=[n.Fi.DrawByAgreement],i=this.createSnapshot();this.makeMove([{type:n.Fi.Resign}],!0);const o=Math.max(...this.data.points),r=this.data.points.reduce(((e,t,i)=>t===o?[...e,i]:e),[]);return this.loadSnapshot(i),1===r.length&&r[0]===e?t.push(n.Fi.ClaimWin):t.push(n.Fi.Resign,n.Fi.Timeout),t.map((e=>({type:e})))}}},30211:function(e,t,i){"use strict";i.d(t,{Bd:function(){return d},Ft:function(){return o},Kv:function(){return l},Ov:function(){return p},RN:function(){return h},Xm:function(){return u},ef:function(){return f}});var o,r=i(72714),s=i(92052),n=i(5593),a=i(14230);!function(e){e[e.Highlighted=0]="Highlighted",e[e.Fogged=1]="Fogged",e[e.Ghosted=2]="Ghosted",e[e.Blindfolded=3]="Blindfolded",e[e.PieceFacesCenter=4]="PieceFacesCenter"}(o||(o={}));const c=[!0,!1,!0,!1],l=e=>`${e[0]}:${e[1]}`,u=e=>{const t=e.split(":").map((e=>Number(e)));if((0,r.CG)(t,2)&&t.every((e=>!Number.isNaN(e))))return t;throw new Error(`Unexpected stringified coordinate: ${e}`)},d=()=>({type:n.Jy.FFA,teamSettings:{firstTeamColors:c.map((e=>e)),secondTeamColors:c.map((e=>!e))},getBaseColors(e){return this.isFFA()?(0,r.fi)(((t,i)=>i===e),n.q3):this.teamSettings.firstTeamColors[e]?this.teamSettings.firstTeamColors:this.teamSettings.secondTeamColors},isFFA(){return this.type===n.Jy.FFA||this.type===n.Jy.Solo},isSameTeam(e,t){return e===t||!this.isFFA()&&(this.teamSettings.firstTeamColors[e]?this.teamSettings.firstTeamColors[e]&&this.teamSettings.firstTeamColors[e]:this.teamSettings.secondTeamColors[e]&&this.teamSettings.secondTeamColors[t])},getTeammateColor(e){if(this.isFFA())return e;const t=this.teamSettings.firstTeamColors[e]?this.teamSettings.firstTeamColors.map(((t,i)=>t&&i!==e)).indexOf(!0):this.teamSettings.secondTeamColors.map(((t,i)=>t&&i!==e)).indexOf(!0);return(0,a.O3)(t)?t:e}}),p=()=>({hasComplexPieces:!1,hasComplexRules:!1}),h=()=>({hoppingPieces:(0,s.BD)((()=>0)),slidingPieces:(0,s.BD)((()=>0)),hoppingPieceLines:[],slidingPiecesLines:[],slidingPiecesRayTracing:[],attackingColors:(0,s.BD)((()=>0)),pieceMovements:new Map,pieceDrops:{pawn:[],piece:[]},variantRuleCache:{}}),f=(e,t)=>e[0]===t[0]&&e[1]===t[1]},77028:function(e,t,i){"use strict";i.d(t,{c:function(){return m}});var o=i(92052),r=i(15140),s=i(17744),n=i(72714),a=i(5593),c=i(12850),l=i(88706),u=i(30211),d=i(14230),p=i(95488),h=i(67037),f=i(61495);class g{tags=(0,f.fL)();castlingKingsideData=(0,n.fi)((()=>({endCoordinates:-1,pieceCoordinates:-1,pieceEndCoordinates:-1,checkSquares:[]})),a.q3);castlingQueensideData=(0,n.fi)((()=>({endCoordinates:-1,pieceCoordinates:-1,pieceEndCoordinates:-1,checkSquares:[]})),a.q3);createSnapshot(){return{tagsSnapshot:(0,f.rE)(this.tags)}}loadTagSnapshot(e,t){t.loadSnapshot(e)}loadSnapshot(e){let t;for(t in e.tagsSnapshot)Object.prototype.hasOwnProperty.call(e.tagsSnapshot,t)&&this.loadTagSnapshot(e.tagsSnapshot[t],this.tags[t])}verifyKeyTag(e,t){return e in t}createClone(){const e=(0,h.lJ)(this,g),t=this.createSnapshot();let i;for(i in e.tags=(0,f.fL)(),e.loadSnapshot(t),this.tags)Object.prototype.hasOwnProperty.call(this.tags,i)&&!this.verifyKeyTag(i,t.tagsSnapshot)&&(e.tags[i].value=this.tags[i].value);return e}tag(e){return this.tags[e].value}setTag(e,t){this.tags[e].value=t}createSerializedState(){const e={};let t;for(t in this.tags){if(!Object.prototype.hasOwnProperty.call(this.tags,t))continue;const i=this.tags[t];e[t]=i.createSnapshot()}return e}generateCastling(e){let[t,i]=this.tag("dim");this.tag("noCorners")||(t>8&&(t=8),i>8&&(i=8));const r=[t,i,t,i],s=this.tag("royal").map(((e,t)=>e?e[(0,o.x_)(t)]:e)),n=this.tag("royal").map(((e,t)=>e?e[(0,o.x_)(t)]:e)),a=[],c=[],l=e.board;for(let e=0;e<this.tag("royal").length;e++){const t=n[e],i=s[e];if(null===t||null===i){a.push(-1),c.push(-1);continue}const o=e%2==0;for(let e=t;e<14;e++){const t=l[o?i:e][o?e:i];if(!t.isEmpty()&&t.piece===this.tag("castleWith")){a.push(e);break}13===e&&a.push(-1)}for(let e=t;e>-1;e--){const t=l[o?i:e][o?e:i];if(!t.isEmpty()&&t.piece===this.tag("castleWith")){c.push(e);break}0===e&&c.push(-1)}}for(let e=0;e<this.tag("royal").length;e++){const t=n[e];if(null===t)continue;const i=r[e]-6<1?1:r[e]-6;if(-1===a[e])this.tag("castleKingside")[e]=!1;else{const o=[...Array(a[e]-t-1).keys()],r=t+i,s={endCoordinates:r,checkSquares:o.map((e=>e+t+1)),pieceCoordinates:a[e],pieceEndCoordinates:r-1};t<=6?this.castlingQueensideData[e]=s:this.castlingKingsideData[e]=s}if(-1===c[e])this.tags.castleQueenside.value[e]=!1;else{const o=[...Array(t-c[e]-1).keys()],r=t-i,s={endCoordinates:r,checkSquares:t<=6?o.map((e=>e+t-2)):o.map((e=>e+t-3)),pieceCoordinates:c[e],pieceEndCoordinates:r+1};t<=6?this.castlingKingsideData[e]=s:this.castlingQueensideData[e]=s}}}isCastlingAvailable(e,t,i){const r=this.tag("royal")[e];if(null===r)return!1;const s=r[(0,o.ft)(e)],n=t.board;for(const r of i){const i=(0,o.sC)(e)?s:r,a=(0,o.sC)(e)?r:s;if(!n[i][a].isEmpty()||t.preGeneratedAttacks[e].hoppingPieces[i][a]>0||t.preGeneratedAttacks[e].slidingPieces[i][a]>0)return!1}return!t.isKingInCheck(e)}isKingsideCastlingAvailable(e,t){return!!this.tag("castleKingside")[e]&&(-1===this.castlingKingsideData[e].endCoordinates&&this.generateCastling(t),this.isCastlingAvailable(e,t,this.castlingKingsideData[e].checkSquares))}isQueensideCastlingAvailable(e,t){return!!this.tag("castleQueenside")[e]&&(-1===this.castlingQueensideData[e].endCoordinates&&this.generateCastling(t),this.isCastlingAvailable(e,t,this.castlingQueensideData[e].checkSquares))}getCastlingEndCoordinate(e,t){const i=this.tag("royal")[e]?.[(0,o.ft)(e)];return(0,n.lM)(t),(0,n.lM)(i),[(0,o.sC)(e)?i:t,(0,o.sC)(e)?t:i]}getKingsideCastlingEndCoordinate(e){return this.getCastlingEndCoordinate(e,this.castlingKingsideData[e].endCoordinates)}getQueensideCastlingEndCoordinate(e){return this.getCastlingEndCoordinate(e,this.castlingQueensideData[e].endCoordinates)}getKingsideCastlingPieceEndCoordinate(e){return this.getCastlingEndCoordinate(e,this.castlingKingsideData[e].pieceEndCoordinates)}getQueensideCastlingPieceEndCoordinate(e){return this.getCastlingEndCoordinate(e,this.castlingQueensideData[e].pieceEndCoordinates)}getKingsideCastlingTandemPiece(e){return this.castlingKingsideData[e].pieceCoordinates}getQueensideCastlingTandemPiece(e){return this.castlingQueensideData[e].pieceCoordinates}getAvailableEnPassantCaptures(e){const t=[];return this.tag("enPassant").forEach(((i,o)=>{o!==e&&i&&t.push(i[0])})),t.map((e=>[...e]))}getDefaultZombieAlgorithm(e){const t=p.botAlgorithms.get(this.tag("resigned")[e]?this.tag("zombieType")[e]:p.ZombieType.F_Checker);return(0,n.lM)(t),t}}class m{points;sideToMove;fenOptions;plyCount;board;privateGameOver=!1;__baseClass;initDecoratorSettings(){}constructor(){this.points=[0,0,0,0],this.sideToMove=0,this.fenOptions=new g,this.plyCount=0,this.__baseClass=this}get gameOver(){return this.privateGameOver}set gameOver(e){!1!==e&&!1!==this.privateGameOver||(this.privateGameOver=e)}injectBoard(e){this.board=e,this.fenOptions.generateCastling(e)}createClone(){const e=new m;return e.fenOptions=this.fenOptions.createClone(),e.points=[...this.points],e.sideToMove=this.sideToMove,e.plyCount=this.plyCount,e}createSnapshot(){return{points:[...this.points],sideToMove:this.sideToMove,fenOptionsSnapshot:this.fenOptions.createSnapshot(),plyCount:this.plyCount,gameOver:this.gameOver}}loadSnapshot(e){this.fenOptions.loadSnapshot(e.fenOptionsSnapshot),this.points=[...e.points],this.sideToMove=e.sideToMove,this.plyCount=e.plyCount,this.privateGameOver=e.gameOver}getCapturedPieces(e){const t=this.board.board[e.endCoordinates[0]][e.endCoordinates[1]];return t.isEmpty()||t.isDead()?[]:[[...e.endCoordinates]]}getCastlingPieceEndCoordinates(e,t){return[(0,o.sC)(t)?[e[0],this.fenOptions.getKingsideCastlingTandemPiece(t)]:[this.fenOptions.getKingsideCastlingTandemPiece(t),e[1]],(0,o.sC)(t)?[e[0],this.fenOptions.getQueensideCastlingTandemPiece(t)]:[this.fenOptions.getQueensideCastlingTandemPiece(t),e[1]]]}processStandardMove(e){const{startCoordinates:[t,i],endCoordinates:[r,n],promotion:l}=e,d=this.board.board[r][n],p=l?.[0]??this.board.board[t][i],h=this.getCapturedPieces(e);this.board.board[r][n]=p,this.board.board[t][i]=c.v2;for(const t of h)(0,u.ef)(t,e.startCoordinates)?this.board.board[r][n]=c.v2:(0,u.ef)(t,e.endCoordinates)||(this.board.board[t[0]][t[1]]=c.v2);const[f,g]=this.getCastlingPieceEndCoordinates(e.startCoordinates,this.sideToMove);if("specialType"in e){const r=e.specialType;switch(r){case s.uj.CastlingKingside:{const e=(0,o.sC)(this.sideToMove)?this.board.board[t][this.fenOptions.getKingsideCastlingTandemPiece(this.sideToMove)]:this.board.board[this.fenOptions.getKingsideCastlingTandemPiece(this.sideToMove)][i],[r,s]=this.fenOptions.getKingsideCastlingPieceEndCoordinate(this.sideToMove);this.board.board[r][s]=e,this.board.board[f[0]][f[1]]=c.v2;break}case s.uj.CastlingQueenside:{const e=(0,o.sC)(this.sideToMove)?this.board.board[t][this.fenOptions.getQueensideCastlingTandemPiece(this.sideToMove)]:this.board.board[this.fenOptions.getQueensideCastlingTandemPiece(this.sideToMove)][i],[r,s]=this.fenOptions.getQueensideCastlingPieceEndCoordinate(this.sideToMove);this.board.board[r][s]=e,this.board.board[g[0]][g[1]]=c.v2;break}default:void 0!==r&&r in s.uj||console.error(`Unknown special move constant: ${String(r)}`)}}const m=this.fenOptions.tag("castleKingside"),v=this.fenOptions.tag("castleQueenside"),y=this.fenOptions.tag("royal");this.fenOptions.setTag("royal",this.fenOptions.tag("royal").map(((e,o)=>e?e[0]===t&&e[1]===i?(m[o]=!1,v[o]=!1,[r,n]):[...e]:null)));for(const t of a.O9){const i=y[t];if(i){if((0,u.ef)(i,e.startCoordinates)){m[t]=!1,v[t]=!1;break}if((0,u.ef)(f,e.startCoordinates)){m[t]=!1;break}if((0,u.ef)(g,e.startCoordinates)){v[t]=!1;break}}}return{endPiece:d.isEmpty()?[]:[d]}}spreadPointsBetweenPlayersEvenly(){const e=this.fenOptions.tag("resigned"),t=this.fenOptions.tag("dead"),i=e.reduce(((e,i,o)=>e+Number(i||t[o])),0),o=Math.ceil(this.obtainPointsForMate()/i);for(const e of a.O9)t[e]||this.assignPoints(e,o)}branchBetweenResignationMoves(e,t){const i=(0,a.oh)(t).toUpperCase();switch(e){case s.Fi.Resign:this.gameOver=`${i} RESIGNED!`;break;case s.Fi.Timeout:this.gameOver=`${i} FORFEITS ON TIME!`;break;case s.Fi.ClaimWin:this.gameOver=`${i} CLAIMED THE WIN!`;break;default:(0,n.h0)(e)}}processInternalMove(e){const t=this.fenOptions.tag("resigned"),i=this.fenOptions.tag("dead"),o=(0,n.VS)(!1,a.q3),c=this.board.insufficientMaterialChecker?.checkCurrentState(this.board).every(((e,t)=>t===this.sideToMove?e:e||i[t]));switch(e.type){case s.Fi.Stalemate:i[this.sideToMove]=!0,o[this.sideToMove]=!0;break;case s.Fi.Resign:case s.Fi.Timeout:c&&this.assignGeneralTermination("Timeout vs Insufficient Material");case s.Fi.ClaimWin:{t[this.sideToMove]=!0,this.turnPiecesDead(this.sideToMove,{...(0,r.P8)(),excludeRoyals:!0,doNotSetDead:!0});const o=i.map(((e,i)=>e||t[i])).filter(Boolean);let s=o.length===a.q3-1;if(c)this.spreadPointsBetweenPlayersEvenly();else if(o.length===a.q3-1){const e=o.findIndex((e=>!e));(0,d.O3)(e)&&(this.assignPoints(e,this.countTotalPointsOnBoard().reduce(((t,i,o)=>t+(o===e?i:0)),0)),s=!0)}else this.board.gameType.isFFA()||(s=!0);s&&this.branchBetweenResignationMoves(e.type,this.sideToMove);break}case s.Fi.DrawByAgreement:this.gameOver="½-½ AGREED.";break;case s.Fi.Pass:break;case s.Fi.TeamsCheckmate:this.gameOver=`CHECKMATE • ${this.getCurrentResult()}`,this.turnPiecesDead(this.sideToMove),this.turnPiecesDead(this.board.gameType.getTeammateColor(this.sideToMove));break;default:(0,n.h0)(e.type)}return{stalemates:o}}processDroppingMove(e){const t=this.fenOptions.tag("bank"),i=this.fenOptions.tag("areBanksEnabled"),o=this.fenOptions.tag("setupComplete");if(!this.board.variantData.duckChess&&!i[this.sideToMove])return;const r=t[this.sideToMove],s=[...r.keys()].find((t=>t.piece===e.piece.piece));if(!s&&!this.board.variantData.duckChess&&e.piece.piece!==d.KR.duck)return;const n=s??e.piece;if(this.board.board[e.endCoordinates[0]][e.endCoordinates[1]]=e.piece,!o[this.sideToMove])return;const a=r.get(n);1==a?r.delete(n):a&&r.set(n,a-1)}turnPiecesDead(e,t=(0,r.P8)()){const i=this.fenOptions.tag("royal"),o=this.fenOptions.tag("dead"),s=i[e];t.doNotSetDead||(o[e]=!0,i[e]=null);for(const i of this.board.getPlayerPieces()[e]){if(t.excludeRoyals&&s&&(0,u.ef)(i,s))continue;const e=this.board.board[i[0]][i[1]].piece;t.onlyPawns&&!l.Gf[e].moveGenerationSettings.isPawn||(this.board.board[i[0]][i[1]]=(0,c.HC)(c.Ir,this.board.board[i[0]][i[1]].piece))}}getKingCaptures(){const e=(0,n.VS)(!1,a.q3);for(const t of a.O9){const i=this.fenOptions.tag("royal")[t];if(!i)continue;const o=this.board.board[i[0]][i[1]];(o.isEmpty()||o.color!==t)&&(e[t]=!0)}return e}processPointsForChecks(e){const t=this.sideToMove,i=this.board.getCurrentChecks(),o=(0,n.VS)(!1,a.q3);for(const t of a.O9)for(const r of i[t])if(!e[t].has(r)){o[t]=!0;break}const r=o.filter(Boolean).length;2===r?this.assignPoints(t,1):3===r&&this.assignPoints(t,5)}affectOptions(e,t=(0,r.Yx)()){let i,o;const c=this.board.getCurrentChecks().map((e=>new Set(e)));(0,s.LR)(e)?i=this.processInternalMove(e).stalemates:(0,s.$j)(e)?o=this.processStandardMove(e).endPiece:(0,s.x7)(e)&&this.processDroppingMove(e),t.ignoreCheckmateChecks||this.board.pregenerateAttacks();const{checkmates:l,stalemates:u,checks:d}=t.ignoreCheckmateChecks?{checkmates:(0,n.VS)(!1,a.q3),checks:(0,n.VS)(!1,a.q3),stalemates:(0,n.VS)(!1,a.q3)}:this.board.getCheckmatesAndStalemates();if(i)for(let e=0;e<a.q3;e++)i[e]&&(u[e]=!0);const p=l.reduce(((e,t)=>t?e+this.obtainPointsForMate():e),0),h={pointDistribution:{checkmatePoints:l.map(((e,t)=>t===this.sideToMove?p:0)),pieceCapturingPoints:(0,n.VS)(0,a.q3)}};if(o)for(const e of o)h.pointDistribution.pieceCapturingPoints[this.sideToMove]=this.getPointsForPiece(e);const f=this.getKingCaptures(),g=this.fenOptions.tag("dead"),m=this.fenOptions.tag("resigned");if(this.board.gameType.isFFA())for(const e of a.O9)g[e]||m[e]||(l[e]||e===this.sideToMove&&u[e]?this.turnPiecesDead(e):this.assignPoints(e,h.pointDistribution.checkmatePoints[e]+h.pointDistribution.pieceCapturingPoints[e]));else for(const e of a.O9)f[e]&&(this.turnPiecesDead(e),this.assignGeneralTermination("King Captured"));const v=this.getRealPlayers(),y=this.board.gameType.isFFA()?1===v:v!==a.q3;if(y&&this.assignGeneralTermination("Checkmate"),!t.ignoreNextTurn&&!y){this.processPointsForChecks(c);const e=this.board.insufficientMaterialChecker?.checkCurrentState(this.board);!this.gameOver&&e?.every(((e,t)=>g[t]||e))&&(this.gameOver=`INSUFFICIENT MATERIAL • ${this.getCurrentResult()}`,this.spreadPointsBetweenPlayersEvenly()),this.getRealPlayers()>1&&(this.sideToMove=this.nextTurn())}return{checkmates:l,stalemates:u,checks:d}}getRealPlayers(){const e=this.fenOptions.tag("dead"),t=this.fenOptions.tag("resigned");let i=0;for(const o of a.O9)t[o]||e[o]||i++;return i}nextTurn(e=this.sideToMove){if(this.getRealPlayers()<=1)throw new Error("Next turn called while the game is terminated");return(0,r.cq)(e,this.fenOptions.tag("dead"))}previousTurn(e=this.sideToMove){const t=this.fenOptions.tag("dead");if(this.getRealPlayers()<=1)throw new Error("Previous turn called while the game is terminated");let i=e;do{i=0===i?a.q3-1:i-1}while(t[i]);if((0,d.O3)(i))return i;throw new Error(`Unexpected numeric color: ${i}`)}isComplexEvaluation(){return!1}obtainPointsForMate(){return 20}assignPoints(e,t){t>0&&(this.points[e]+=t)}getPointsForPiece(e){return e.isPiece()&&this.board.gameType.isFFA()?l.Gf[e.piece].points.singlesPoints:0}countTotalPointsOnBoard(){const e=this.fenOptions.tag("royal"),t=this.fenOptions.tag("resigned"),i=this.fenOptions.tag("zombieImmune"),o=[0,0,0,0];return this.board.getPlayerPieces().forEach(((r,s)=>{if(i[s])return;const n=e[s];for(const e of r)if(n&&(0,u.ef)(e,n))o[s]+=this.obtainPointsForMate();else if(t[s]){const t=this.board.board[e[0]][e[1]].piece;o[s]+=l.Gf[t].points.singlesPoints}})),o}getCurrentResult(){if(this.board.gameType.isFFA()){const e=this.fenOptions.tag("dead"),t=this.fenOptions.tag("resigned");if(!this.board.isTwoPlayer)throw new Error("Result can only get called for 2P and teams");const i=Math.max(...this.points);let o,r;for(const s of a.O9)if(!e[s]&&!t[s]){if(this.points[s]===i){if(void 0!==r)return"½-½";r=s}void 0===o&&(o=s)}return o===r?"1-0":"0-1"}{let e="½-½";for(const t of a.O9)if(this.points[t]>0){e=this.board.gameType.teamSettings.firstTeamColors[t]?"1-0":"0-1";break}return e}}assignGeneralTermination(e,t){if(this.board.gameType.isFFA()&&!this.board.isTwoPlayer){if(void 0!==t&&"Stalemate"===e)return void(this.gameOver=`${(0,a.oh)(t).toUpperCase()} STALEMATED!`);(0,a.Ce)(e)?this.gameOver=`${e.toUpperCase()}!`:(0,a.WF)(e)?this.gameOver=`${e.toUpperCase()}`:(0,n.h0)(e)}else this.gameOver=`${e.toUpperCase()} • ${this.getCurrentResult()}`}}},15140:function(e,t,i){"use strict";i.d(t,{P8:function(){return n},Yx:function(){return s},cq:function(){return a}});var o=i(14230),r=i(5593);const s=()=>({ignoreCheckmateChecks:!1,ignoreNextTurn:!1}),n=()=>({excludeRoyals:!1,onlyPawns:!1,doNotSetDead:!1});function a(e,t){let i=e;do{i=i===r.q3-1?0:i+1}while(t[i]);if((0,o.O3)(i))return i;throw new Error(`Unexpected numeric color: ${i}`)}},61495:function(e,t,i){"use strict";i.d(t,{fL:function(){return B},rE:function(){return N},bv:function(){return A}});var o=i(72714),r=i(5593),s=i(8971),n=i(30211),a=i(14230),c=i(12850),l=i(88706),u=i(95488),d=i(71403),p=i(20831),h=i(67037);const f=(e,t)=>Array.isArray(e)&&(0,o.CG)(e,r.q3)&&e.every((e=>typeof e===t));function g(e){const{defaultValue:t,key:i,isStatic:o}=e,r={value:[...t],parse(e){return f(e,"boolean")?e:this.createSnapshot()},serialize(){if("castleKingside"!==i&&"castleQueenside"!==i&&"dead"!==i&&"areBanksEnabled"!==i)return(0,s.Rt)(this.value,t)?void 0:`'${i}':(${this.value.join(",")})`},createSnapshot(){return[...this.value]},loadSnapshot(e){const t=[...e];this.value=t}};return o&&delete r.loadSnapshot,r}const m=()=>({value:2,parse(e){return"number"==typeof e&&e>0&&e<=r.iJ?e:this.value},serialize(){return 2===this.value?void 0:`'pawnBaseRank':${this.value}`},createSnapshot(){return this.value}}),v=()=>({value:(0,o.VS)(null,r.q3),parse(e){return f(e,"string")?e.map((e=>(0,p.Lx)(e)??null)):this.createSnapshot()},serialize(){return this.value.some((e=>!e))?`'enPassant':(${this.value.map((e=>e?`'${(0,r.kZ)(e[0])}:${(0,r.kZ)(e[1])}'`:"''")).join(",")})`:void 0},createSnapshot(){return this.value.map((e=>e?[[...e[0]],[...e[1]]]:e))},loadSnapshot(e){this.value=e.map((e=>e?[[...e[0]],[...e[1]]]:e))}}),y=()=>({value:"R",parse(e){return"string"==typeof e?e:this.value},serialize(){return"R"===this.value?void 0:`'castleWith':${this.value}`},createSnapshot(){return this.value}}),b=()=>({value:0,parse(e){return"number"==typeof e&&(0,a.O3)(e)?e:this.value},serialize(){return 0===this.value?void 0:`'boxOffset':${this.value}`},createSnapshot(){return this.value}});function P(e){const{defaultValue:t,key:i,isStatic:o}=e,r={value:t,parse(e){return"boolean"==typeof e?e:this.createSnapshot()},serialize(){return this.value===t?void 0:`'${i}':${String(this.value)}`},createSnapshot(){return this.value},loadSnapshot(e){this.value=e}};return o&&delete r.loadSnapshot,r}const C=[14,14],k=()=>({value:[...C],parse(e){if("string"!=typeof e)return this.createSnapshot();const t=e.split("x");return Array.isArray(t)&&(0,o.CG)(t,2)&&t.every((e=>{const t=Number(e);return!isNaN(t)&&t>=2&&t<=14&&t%2==0}))?t.map((e=>Number(e))).reverse():this.createSnapshot()},serialize(){if(!(0,s.Rt)(this.value,C))return`'dim':'${this.value.join("x")}'`},createSnapshot(){return[...this.value]}}),T=(0,o.VS)(u.ZombieType.Rando,r.q3),M=()=>({value:[...T],parse(e){if(Array.isArray(e)&&(0,o.CG)(e,r.q3)&&e.every((e=>"string"==typeof e))){const t=this.createSnapshot();for(const i of r.O9){const o=e[i];(0,u.verifyZombieType)(o)&&(t[i]=o)}return t}return this.createSnapshot()},serialize(){if(!(0,s.Rt)(this.value,T))return`'zombieType':(${this.value.map(((e,t)=>e===T[t]?"''":`'${e}'`)).join(",")})`},createSnapshot(){return[...this.value]}}),S=()=>({value:(0,o.VS)(null,r.q3),parse(e){return f(e,"string")?e.map((e=>(0,p._q)(e)??null)):this.createSnapshot()},serialize(){return`'royal':(${this.value.map((e=>e?`'${(0,r.kZ)(e)}'`:"''")).join(",")})`},createSnapshot(){return this.value.map((e=>e?[...e]:e))},loadSnapshot(e){this.value=e.map((e=>e?[...e]:e))}}),w=()=>({value:(0,o.VS)(null,r.q3),parse(e){return f(e,"number")?e:this.createSnapshot()},serialize(){return this.value.some((e=>null!==e))?`'lives':(${this.value.map((e=>e?String(e):"1")).join(",")})`:void 0},createSnapshot(){return[...this.value]},loadSnapshot(e){this.value=[...e]}}),D=()=>({value:(0,o.fi)((()=>new Map),r.q3),parse(e){const t=(0,o.fi)((()=>new Map),r.q3);if(f(e,"string"))for(const i of r.O9)for(const o of e[i].split(",")){const[e,r=1]=o.split("x").map(((e,t)=>1===t?Number(e):e));if("string"!=typeof e||"number"!=typeof r)continue;if(!/^(?:r|b|y|g).$/.test(e))continue;const s=e.charAt(1);(0,l.IM)(s)&&t[i].set((0,c.m9)(e),r)}return t},serialize(){return this.value.some((e=>0!==e.size))?`'bank':(${this.value.map((e=>{const t=[];for(const[i,o]of e)1===o?t.push(i.value):t.push(`${i.value}x${o}`);return`'${t.join(",")}'`})).join(",")})`:void 0},createSnapshot(){return this.value.map((e=>[...e.entries()].map((([e,t])=>[e.toObject(),t]))))},loadSnapshot(e){this.value=e.map((e=>new Map(e.map((([e,t])=>[c.Ff.fromObjectToClass(e),t])))))}}),x=()=>({value:new Map,parse(e){const t=new Map;if(!(0,h.T9)(e))return t;for(const i in e){if(!Object.prototype.hasOwnProperty.call(t,i))continue;const o=(0,p._q)(i),r=e[i];o&&"string"==typeof r&&(0,l.IM)(r)&&t.set(o,r)}return t},serialize(){if(0===this.value.size)return;const e=[];for(const[t,i]of this.value)e.push(`'${(0,r.kZ)(t)}':'${i}'`);return`'promotedFrom':{${e.join(",")}}`},createSnapshot(){const e=[];for(const[t,i]of this.value.entries())e.push([[...t],i]);return e},loadSnapshot(e){this.value.clear();for(const[t,i]of e)this.value.set([...t],i)}}),R=()=>({value:null,parse(e){return f(e,"number")?e:this.createSnapshot()},serialize(){return this.value?`'setupPoints':(${this.value.join(",")})`:void 0},createSnapshot(){return this.value?[...this.value]:this.value},loadSnapshot(e){this.value=e?[...e]:e}}),O=()=>({value:(0,o.fi)((()=>new Set),r.q3),parse(e){const t=(0,o.fi)((()=>new Set),r.q3);if(Array.isArray(e)&&((0,o.CG)(e,r.q3)||(0,o.CG)(e,r.q3+1))&&e.every((e=>Array.isArray(e))))for(const i of r.O9){const o=e[i];if(o.every((e=>"string"==typeof e)))for(const e of o){if(!d.T.COORDINATE_REGEX.test(e))continue;const o=(0,p._q)(e);o&&t[i].add((0,n.Kv)(o))}}return t},serialize(){if(!this.value.every((e=>0===e.size)))return`'seirawanDrops':(${this.value.map((e=>`(${[...e].map((e=>`'${(0,r.kZ)((0,n.Xm)(e))}'`)).join(",")})`)).join(",")})`},createSnapshot(){return this.value.map((e=>[...e.values()]))},loadSnapshot(e){this.value=e.map((e=>new Set(e)))}}),A=(e,t)=>"loadSnapshot"in e,F=e=>"loadSnapshot"in e;function B(){return{dead:g({key:"dead",defaultValue:(0,o.VS)(!1,r.q3),isStatic:!1}),resigned:g({key:"resigned",defaultValue:(0,o.VS)(!1,r.q3),isStatic:!1}),pawnBaseRank:m(),enPassant:v(),boxOffset:b(),wb:P({key:"wb",defaultValue:!1,isStatic:!0}),dim:k(),noCorners:P({key:"noCorners",defaultValue:!1,isStatic:!0}),castleKingside:g({key:"castleKingside",defaultValue:(0,o.VS)(!0,r.q3),isStatic:!1}),castleQueenside:g({key:"castleQueenside",defaultValue:(0,o.VS)(!0,r.q3),isStatic:!1}),castleWith:y(),zombieType:M(),zombieImmune:g({key:"zombieImmune",defaultValue:(0,o.VS)(!1,r.q3),isStatic:!1}),royal:S(),lives:w(),bank:D(),promotedFrom:x(),setupPoints:R(),setupComplete:g({key:"setupComplete",defaultValue:(0,o.VS)(!0,r.q3),isStatic:!1}),seirawanDrops:O(),areBanksEnabled:g({key:"areBanksEnabled",defaultValue:(0,o.VS)(!1,r.q3),isStatic:!1})}}function N(e){const t={};let i;for(i in e){if(!Object.prototype.hasOwnProperty.call(e,i))continue;const o=e[i];A(o,i)&&F(o)&&(t[i]=o.createSnapshot())}return t}},5593:function(e,t,i){"use strict";i.d(t,{By:function(){return f},Ce:function(){return a},Jy:function(){return y},O9:function(){return C},Q3:function(){return r},R4:function(){return g},WF:function(){return l},iJ:function(){return P},kZ:function(){return h},oh:function(){return m},q3:function(){return b},wH:function(){return p}});var o=i(72714);const r=["Red","Blue","Yellow","Green","White","Black"],s=["Won the Race","Checkmated","Stalemated","Forfeits on Time","Claimed the Win","Resigned"],n=["Checkmate","King Captured","King of the Hill","Stalemate"],a=e=>n.includes(e),c=["50-move Rule","Insufficient Material","Threefold Repetition","Timeout vs Insufficient Material"],l=e=>c.includes(e),u=[...n,...c],d=["0-1","1-0","½-½"],p=e=>{const t=e.toUpperCase();return!(!r.some((e=>t.startsWith(e.toUpperCase())))||!s.some((e=>t.endsWith(e.toUpperCase()+"!"))))||!!(/.*?\s•\s.*/.test(t)&&u.some((e=>t.startsWith(e.toUpperCase())))&&d.some((e=>t.endsWith(e.toUpperCase()))))||"½-½ AGREED."===t},h=(e,t=P)=>{if(t===P)return`${String.fromCharCode(e[1]+97)}${P-e[0]}`;{const i=(P-t)/2;return`${String.fromCharCode(e[1]-i+97)}${P-e[0]-i}`}},f=(e,t=P)=>{if(t===P)return[String.fromCharCode(e[1]+97),P-e[0]];{const i=(P-t)/2;return[String.fromCharCode(e[1]-i+97),P-e[0]-i]}},g=e=>{switch(e){case 0:return 2;case 1:return 3;case 2:return 0;case 3:return 1;default:return(0,o.h0)(e)}},m=(e,t=!1)=>{switch(e){case 0:return t?"White":"Red";case 1:return"Blue";case 2:return t?"Black":"Yellow";case 3:return"Green";default:return(0,o.h0)(e)}};var v,y;!function(e){e.Hyperbullet="Hyperbullet",e.Bullet="Bullet",e.Blitz="Blitz",e.Rapid="Rapid"}(v||(v={})),function(e){e.FFA="FFA",e.Teams="Teams",e.Solo="Solo"}(y||(y={}));const b=4,P=14,C=[0,1,2,3]},14230:function(e,t,i){"use strict";i.d(t,{JF:function(){return s},KR:function(){return r},O3:function(){return o},OT:function(){return n},Od:function(){return a}});const o=e=>e>=0&&e<4,r={wall:"X",transparentWall:"x",duck:"Θ"},s={r:0,b:1,y:2,g:3},n=e=>e in s,a={0:"r",1:"b",2:"y",3:"g",4:"d"}},12850:function(e,t,i){"use strict";i.d(t,{Fb:function(){return f},Ff:function(){return n},HC:function(){return a},Ir:function(){return s},St:function(){return g},cG:function(){return p},m9:function(){return c},v2:function(){return u}});var o=i(88706),r=i(14230);const s=4;class n{_color;_piece;static comparePieceStrings(e,t){return e._piece===t._piece&&e._color===t._color}static comparePieceStringObjects(e,t){return e._piece===t._piece&&e._color===t._color}static fromObjectToClass(e){return new n(e._color,e._piece)}value;constructor(e,t){this._color=e,this._piece=t,this.value=t.length?/[xXΘ]/.test(t)?t:r.Od[e]+t:""}isDead(){return this._color===s&&!this.isWall()}isEmpty(){return 0===this._piece.length}isWall(){return 1===this.value.length}isPiece(){return 2===this.value.length&&this._color!==s}get piece(){if(this.isEmpty())throw new TypeError("Accessing a piece string piece value while the piece string is empty.");return this._piece}get color(){if(this.isEmpty())throw new TypeError("Accessing a piece string color value while the piece string is empty.");return this._color}getStringifiedColor(){return this.value.charAt(0)}toObject(){return{_piece:this._piece,_color:this._color,value:this.value}}}const a=(e,t)=>{if((0,o.IM)(t))return new n(e,t);throw new Error("Wrong color signature for the piece provided")},c=e=>{if(1===e.length&&(0,o.IM)(e))return new n(s,e);{const t=e.charAt(0),i=e.charAt(1);if(!(0,o.IM)(i))throw new Error("Wrong signature for the piece provided");if("d"===t)return new n(s,i);if(t in r.JF)return new n(r.JF[t],i);throw new Error("Wrong color signature for the piece provided")}},l=new n(0,o.md);if(!l.isEmpty())throw new Error("Empty piece string is not isEmpty");const u=l,d=new n(s,o.W2);if(!d.isWall())throw new Error("Wall piece string is not isWall");const p=d,h=new n(0,o.lH);if(!h.isPiece())throw new Error("Active piece string is not isActive");const f=h;if(!new n(s,o.KN).isWall())throw new Error("Wall piece string is not isWall");const g=h},80171:function(e,t,i){"use strict";i.d(t,{RR:function(){return y},g7:function(){return b},xn:function(){return v}});var o=i(17744),r=i(72714),s=i(8971),n=i(92052),a=i(30211),c=i(5593),l=i(12850);function u(e){switch(e.specialType){case o.uj.CastlingKingside:return"O-O";case o.uj.CastlingQueenside:return"O-O-O";default:return""}}function d(e){return e.movingPiece.piece!==l.Fb.piece?e.movingPiece.piece:""}function p(e){const{moveMetadata:t,move:i,snapshot:{boardSnapshot:{board:o},pregeneratedAttacks:{pieceMovements:r}},isCapture:c}=e,{piece:u,color:d}=t.movingPiece,p=u===l.Fb.piece,h=[];for(const[e,t]of r){const r=(0,a.Xm)(e),n=o[r[0]][r[1]];n.isEmpty()||n.color!==d||n.piece!==e||void 0!==t.find((e=>(0,s.Rt)(i.endCoordinates,e.move)))&&h.push(r)}return d===l.Ir?[!1,!1]:[c&&p&&(0,n.sC)(d)||h.some(((e,t)=>h.some(((i,o)=>t!==o&&e[0]===i[0])))),c&&p&&!(0,n.sC)(d)||h.some(((e,t)=>h.some(((i,o)=>t!==o&&e[1]===i[1]))))]}function h(e){return e.promotion?`=${e.promotion[0].piece}`:""}function f(e){return"+".repeat(e.checks)+"#".repeat(e.checkmates)}const g={fullMoveNotation:e=>{let t="",i=!1;for(const s of e.moveData)if((0,o.$j)(s)){if(t+=u(s))continue;t+=d(e.metadata),t+=(0,c.kZ)(s.startCoordinates),!i&&e.metadata.isCapture?(t+="x",i=!0):t+="-",t+=(0,c.kZ)(s.endCoordinates),t+=h(s)}else(0,o.x7)(s)?(t+=`@${s.piece.piece}`,t+=`-${(0,c.kZ)(s.endCoordinates)}`):(0,o.LR)(s)?t+=s.type:(0,r.h0)(s);return t+=f(e.metadata),t},shortenedMoveNotation:(e,t,i)=>{let s="",n=!1;for(const a of e.moveData)if((0,o.$j)(a)){if(s+=u(a))continue;s+=d(e.metadata);const o=!n&&e.metadata.isCapture,[r,l]=p({isCapture:o,move:a,snapshot:t,moveMetadata:e.metadata});l&&!r?s+=(0,c.By)(a.startCoordinates,i)[1]:!l&&r?s+=(0,c.By)(a.startCoordinates,i)[0]:l&&r&&(s+=(0,c.kZ)(a.startCoordinates,i)),o&&(s+="x",n=!0),s+=(0,c.kZ)(a.endCoordinates,i),s+=h(a)}else(0,o.x7)(a)?(s+=`@${a.piece.piece}`,s+=`${(0,c.kZ)(a.endCoordinates,i)}`):(0,o.LR)(a)?s+=a.type:(0,r.h0)(a);return s+=f(e.metadata),s+=e.metadata.annotation??"",s}};var m=i(61495);function v(e){return void 0!==e&&!Array.isArray(e)}function y(e){if(!e||Array.isArray(e))throw new Error("The selected move is not a valid move")}const b=e=>{const t=new WeakMap,i=new Map,r=[],n={boardSnapshot:e,get hash(){throw new Error("Should not access hash on base move")},get pregeneratedAttacks(){throw new Error("Should not access pregenerated attacks on base move")}};function a(e=r){for(const t of e)for(let e=0;e<t.alternativeLines.length;e++)0===t.alternativeLines[e].length?t.alternativeLines.splice(e,1):a(t.alternativeLines[e])}function u(e,o){for(const r of e){const e=t.get(r);if(!e)continue;const{hash:n}=e,a=i.get(n);if(a)if(1===a.length)i.delete(n);else{const e=a.findIndex((e=>(0,s.Rt)(e,o)));-1===e?console.error("Current line for move wrapper not found in board hashes"):a.splice(e,1)}for(const e of r.alternativeLines)u(e,o)}}function d(e,o){const{move:r,snapshot:n,fenDataString:a}=e;t.set(r,{boardSnapshot:n.boardSnapshot,pregeneratedAttacks:n.pregeneratedAttacks,hash:a});const c=i.get(a);if(c){const e=c.find((e=>(0,s.Rt)(e,o)));i.set(a,e?c:[...c,o.slice()])}else i.set(a,[o.slice()])}const p=(e,t,i)=>{e[t]=i};return{moves:r,currentMove:[-1],getMove(e){return(0,o.Yr)(r,e)},setNewMove(e){const{move:t}=e,i=this.getMove(t.path.slice(0,-1));let r=t.path.slice();if(!i)return r;if(Array.isArray(i))if(i.length>t.path[t.path.length-1]){const i=this.getMove(t.path);if(Array.isArray(i))this.setNewMove({...e,move:{...t,path:[...t.path,i.length]}});else if(i){const s=function(e,t){for(const[i]of e.alternativeLines)if(i.moveData.length===t.moveData.length&&i.moveData.every(((e,i)=>(0,o.JG)(e,t.moveData[i]))))return i.path;return!1}(i,t);if(s)return s;{i.alternativeLines.push([]);const o={...t,path:[...t.path,i.alternativeLines.length-1,0]};return r=o.path.slice(),this.setNewMove({...e,move:o})}}}else i.push(t),d(e,this.currentMove);else{let o;for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&p(i,o,t[o]);d(e,this.currentMove)}return r},getBoardSnapshot(e){return-1===e?n:t.get(e)},deleteMove(e){let t=[];const i=this.getMove(e.slice(0,-1));if(!i)return;const o=e[e.length-1];Array.isArray(i)?t=[...i.splice(o,i.length-o)]:i.alternativeLines.length>0&&(t=i.alternativeLines.splice(e[e.length-1],1)[0]),u(t,this.currentMove),a();const r=function(e,t){let i=[...e];for(let e=0;e<i.length&&!(t[e]>i[e]);e++){if(t[e]!==i[e]){i=i.slice(0,e+1),i[e]=t[e]-1;break}if(e===t.length-1){i=i.slice(0,e+1),i[e]--;break}}const o=i.indexOf(-1);if(-1!==o){i=i.slice(0,o);let e=0;do{const t=i.pop();if(void 0===t){e=-1;break}e=t}while(e<=0);-1!==e&&i.push(e)}return i}(this.currentMove,e);this.currentMove=0===r.length?[-1]:r},getHash(e){const t=i.get(e);if(void 0===t)return 0;let o=0;for(const e of t)for(let t=0;t<e.length;t++)if(t+1!==0&&t===e.length-1)o++;else if(e[t]!==this.currentMove[t])break;return o},stringifyMove(e,t){const i=this.getBoardSnapshot(e);if(!i)return console.error("No snapshot assigned when moveWrapper is called"),"";let o;for(o in g)Object.prototype.hasOwnProperty.call(g,o)&&(e.cachedNames[o]=g[o](e,i,t))},augmentMoveWithMetadata(e){const{move:t,board:i,makeMoveFunction:r}=e,n=t.find((e=>(0,o.$j)(e))),a=n?i.board[n.startCoordinates[0]][n.startCoordinates[1]]:l.Fb,u=!!n&&0!==i.data.getCapturedPieces(n).length,d=r(),p=[...i.data.fenOptions.tag("dead")],h=i.data.sideToMove,f=i.moves.getMove(i.moves.currentMove);if(y(f),0===i.moves.currentMove[i.moves.currentMove.length-1]||(0,s.qr)(p,(e=>!e))===h){const e=i.moves.getMove(i.moves.currentMove.slice(0,-1));if(!Array.isArray(e))throw new Error("The selected move is not within an array");for(let t=e.length-1;t>=0;t--){const o=e[t].metadata.currentFullMove;if(o){f.metadata.currentFullMove=o+1;break}if(0===t)if(1===f.path.length)f.metadata.currentFullMove=1;else{const e=i.moves.getMove(i.moves.currentMove.slice(0,-3));if(!Array.isArray(e))throw new Error("The selected move is not within an array");f.metadata.currentFullMove=e[(0,s.qr)(e,(e=>Boolean(e.metadata.currentFullMove)))].metadata.currentFullMove}}}f.metadata.currentSideToMove=h,f.metadata.isCapture=u,f.metadata.movingPiece=a;for(const e of c.O9)d.checkmates[e]?f.metadata.checkmates++:d.checks[e]&&f.metadata.checks++;this.stringifyMove(f,Math.max(...i.data.fenOptions.tag("dim")))},constructPreliminaryHashString(e){const{board:t,data:i}=e;let o,r="";for(o in r+=i.sideToMove,i.fenOptions.tags){const e=i.fenOptions.tags[o];if(!(0,m.bv)(e,o))continue;const t=e.serialize();t&&(r+=t)}return r=t.reduce(((e,t)=>e+t.map((e=>e.value||"-")).join("")),r),r}}}},17744:function(e,t,i){"use strict";i.d(t,{$j:function(){return f},Fi:function(){return r},JG:function(){return l},LR:function(){return p},Qc:function(){return c},SK:function(){return u},Yr:function(){return g},Zp:function(){return d},iw:function(){return m},nc:function(){return a},uj:function(){return o},x7:function(){return h}});var o,r,s=i(30211),n=i(12850);!function(e){e[e.CastlingKingside=0]="CastlingKingside",e[e.CastlingQueenside=1]="CastlingQueenside",e[e.EnPassant=2]="EnPassant"}(o||(o={})),function(e){e.Resign="R",e.Timeout="T",e.ClaimWin="C",e.DrawByAgreement="D",e.Stalemate="S",e.Pass="P",e.TeamsCheckmate="#"}(r||(r={}));const a=e=>e.length>0;function c(e){return Boolean(e.alternativeLines&&void 0!==e.comment&&e.path&&e.metadata&&e.moveData)}function l(e,t){if(f(e))return!!f(t)&&(0,s.ef)(e.startCoordinates,t.startCoordinates)&&(0,s.ef)(e.endCoordinates,t.endCoordinates)&&(e.specialType===t.specialType||e.specialType===o.EnPassant||t.specialType===o.EnPassant);if(h(e))return!!h(t)&&(0,s.ef)(e.endCoordinates,t.endCoordinates)&&n.Ff.comparePieceStrings(e.piece,t.piece);if(p(e))return!!p(t)&&e.type===t.type;throw new Error(`Unexpected move signature of first move ${JSON.stringify(e)}`)}function u(){return{isCapture:!1,movingPiece:n.Fb,checks:0,checkmates:0,currentSideToMove:0,highlightedArrows:[],highlightedSquares:[]}}const d=(e,t={})=>({path:e.path,moveData:e.moveData,comment:"",alternativeLines:[],metadata:u(),cachedNames:{fullMoveNotation:"",shortenedMoveNotation:""},...t}),p=e=>"type"in e,h=e=>"piece"in e,f=e=>"startCoordinates"in e,g=(e,t)=>{if(0===t.length)return e;const i=t.slice();if(i[0]>=e.length)return;let o=e[i.shift()??0];for(;i.length>0;){const e=i.shift();if(void 0!==e){if(e>=o.alternativeLines.length)return;const t=o.alternativeLines[e],r=i.shift();if(void 0===r)return t;if(r>=t.length)return;o=t[r]}}return o},m=e=>e.length>0&&e[0].nextChainedMoves?m(e[0].nextChainedMoves):e},19659:function(e,t,i){"use strict";i.d(t,{V:function(){return n}});var o=i(5593),r=i(12850),s=i(88706);class n{color;sliding;jumping;hooks;moves;rayGenCache;baseRankActive;immunePieces;fenData;board;i;j;__baseClass;initDecoratorSettings(){}constructor(){this.moves=[],this.color=0,this.sliding=[],this.jumping=[],this.rayGenCache=[],this.hooks={useTrajectory:void 0,usePerspective:void 0,usePawnLogic:void 0,useHopping:!1},this.baseRankActive=!1,this.immunePieces=[!1,!1,!1,!1],this.__baseClass=this}configure(e){this.color=e.color,this.immunePieces=e.immunePieces,[this.i,this.j]=e.coordinates;const t=[13-this.i,this.j,this.i,13-this.j][this.color]-this.fenData.fenOptions.tag("pawnBaseRank");this.baseRankActive=e.baseRank??(-1===t||-2===t),this.board=e.board}setFENData(e){this.fenData=e}isRayTrace(e){return e===s.hK.RayTrace||e===s.hK.RayTraceLimited}modifyDisplacements(e,t){return[[e,t],[t,-e],[-e,-t],[-t,e]][this.color]}pushMove(e){!e.isRayGen&&this.hooks.usePawnLogic&&this.hooks.usePawnLogic.promotionRanks&&this.hooks.usePawnLogic.promotionRanks[this.color]===(this.color%2==0?e.i:e.j)&&this.hooks.usePawnLogic.promotionPieces?this.moves.push({move:[e.i,e.j,this.hooks.usePawnLogic.promotionPieces.join("")],irreversible:e.irreversible??!1}):this.moves.push({move:[e.i,e.j],irreversible:e.irreversible??!1})}generateSlidingAttack(e){let[t,i]=e.displacement,o=e.limit??1/0;const r=e.rayGenCache,n=e.special??s.hK.Normal;let a=0;this.hooks.usePerspective?.[this.color]&&([t,i]=this.modifyDisplacements(t,i));let c=this.i+t,l=this.j+i;const u=this.board[0].length,d=this.board.length,p=r??this.isRayTrace(n);for(;o>0&&c>=0&&c<u&&l>=0&&l<d&&(this.getMovePossibility({displacement:[c,l],special:n,rayGenCache:r})&&this.pushMove({i:c,j:l,isRayGen:Boolean(p),irreversible:e.irreversible}),n!==s.hK.RayTraceLimited||this.board[c][l].isEmpty()||(a++,2!==a))&&(this.isRayTrace(n)||this.board[c][l].isEmpty());)c+=t,l+=i,o--}generateJumpAttack(e){let[t,i]=e.displacement;const o=e.rayGenCache,r=e.squareBlockingIndex,n=e.special??s.hK.Normal;this.hooks.usePerspective?.[this.color]&&([t,i]=this.modifyDisplacements(t,i));const a=this.i+t,c=this.j+i,l=o??this.isRayTrace(n);let u=!0;if(this.hooks.useTrajectory&&void 0!==r){const e=this.hooks.useTrajectory[r];let t,i;this.hooks.usePerspective?.[this.color]?[t,i]=this.modifyDisplacements(e[0],e[1]):(t=e[0],i=e[1]),this.getMovePossibility({displacement:[this.i+t,this.j+i],special:n,rayGenCache:o})||(u=!1)}u&&this.getMovePossibility({displacement:[a,c],special:n,rayGenCache:o})&&this.pushMove({i:a,j:c,isRayGen:Boolean(l),irreversible:e.irreversible})}getMovePossibility(e){const{displacement:[t,i],rayGenCache:n,special:a}=e;if(t<0||t>=o.iJ||i<0||i>=o.iJ)return!1;const c=this.board[t][i];if(!c.isEmpty()&&c.color!==r.Ir&&!n&&!this.isRayTrace(a??s.hK.Normal)&&(this.immunePieces[c.color]||this.fenData.fenOptions.tag("zombieImmune")[c.color]))return!1;const l=()=>(n&&this.rayGenCache.push(n),!0);if(void 0===a||a===s.hK.Normal){if(!c.isWall())return l()}else if(a===s.hK.RayGen){if(!c.isEmpty())return l()}else if(a===s.hK.AttackOnly){if(!c.isEmpty()&&!c.isWall())return l()}else if(a===s.hK.MoveOnly){if(c.isEmpty())return l()}else if(this.isRayTrace(a))return l();return!1}getPossibleCells(){if(this.hooks.useHopping){this.sliding.forEach((e=>this.generateSlidingAttack({displacement:e,special:s.hK.RayGen,rayGenCache:[...e]})));const e=this.moves.slice();this.moves=[],e.forEach(((e,t)=>{const i=e.move[0]+this.rayGenCache[t][0],o=e.move[1]+this.rayGenCache[t][1];this.getMovePossibility({displacement:[i,o]})&&this.pushMove({i:i,j:o})})),this.rayGenCache=[]}else this.sliding.forEach((e=>this.generateSlidingAttack({displacement:e}))),this.jumping.forEach((e=>this.generateJumpAttack({displacement:e})))}rayGenJumpingAttacks(){return this.jumping.forEach((e=>this.generateJumpAttack({displacement:e,special:s.hK.RayTrace}))),this.moves.splice(0)}rayGenSlidingAttacks(e){const t=[];return this.sliding.forEach((i=>{this.generateSlidingAttack({displacement:i,special:e}),0!==this.moves.length&&t.push(this.moves.splice(0))})),t}getPseudoLegalMoves(){return this.getPossibleCells(),this.moves.splice(0)}}},49727:function(e,t,i){"use strict";i.d(t,{D:function(){return p}});var o=i(19659),r=i(88706);const s=[[-1,0],[1,0],[0,1],[0,-1]],n=[[-1,-1],[1,1],[-1,1],[1,-1]],a=[...s,...n],c=[[-1,-2],[-2,-1],[-1,2],[2,-1],[-2,1],[1,-2],[1,2],[2,1]],l=[[-1,-3],[-3,-1],[-1,3],[3,-1],[-3,1],[1,-3],[1,3],[3,1]],u=[[-2,0],[2,0],[0,2],[0,-2]],d=[[-2,-2],[2,2],[-2,2],[2,-2]],p=()=>{(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.sliding=s}},configuration:{points:{singlesPoints:5,teamsPoints:5,botFFAValue:7,botTeamsValue:7},piece:r.bB.rook,moveGenerationSettings:{isComplex:!1,isJumping:!1,isSliding:!0,isPawn:!1,isColorBound:!1},naming:{name:"Rook",shortName:r.bB.rook.toLowerCase()}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.sliding=n}},configuration:{points:{singlesPoints:5,teamsPoints:4,botFFAValue:6,botTeamsValue:6},piece:r.bB.bishop,moveGenerationSettings:{isComplex:!1,isJumping:!1,isSliding:!0,isPawn:!1,isColorBound:!0},naming:{name:"Bishop",shortName:r.bB.bishop.toLowerCase()}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.jumping=a}},configuration:{points:{singlesPoints:3,teamsPoints:0,botFFAValue:3,botTeamsValue:3},piece:r.bB.king,moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!1,isPawn:!1,isColorBound:!1},naming:{name:"King",shortName:r.bB.king.toLowerCase()}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.sliding=a}},configuration:{points:{singlesPoints:9,teamsPoints:10,botFFAValue:14,botTeamsValue:15},piece:r.bB.queen,moveGenerationSettings:{isComplex:!1,isJumping:!1,isSliding:!0,isPawn:!1,isColorBound:!1},naming:{name:"Queen",shortName:r.bB.queen.toLowerCase()}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.sliding=a}},configuration:{points:{singlesPoints:9,teamsPoints:10,botFFAValue:13,botTeamsValue:13},piece:"D",moveGenerationSettings:{isComplex:!1,isJumping:!1,isSliding:!0,isPawn:!1,isColorBound:!1},naming:{name:"1-point queen",shortName:"d"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.jumping=c}},configuration:{points:{singlesPoints:3,teamsPoints:3,botFFAValue:4,botTeamsValue:4},piece:r.bB.knight,moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!1,isPawn:!1,isColorBound:!1},naming:{name:"Knight",shortName:r.bB.knight.toLowerCase()}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.jumping=[...c,...a]}},configuration:{points:{singlesPoints:5,teamsPoints:5,botFFAValue:7,botTeamsValue:7},piece:"M",moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!1,isPawn:!1,isColorBound:!1},naming:{name:"General",shortName:"m",description:"combines king and knight"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.jumping=n}},configuration:{points:{singlesPoints:1,teamsPoints:1,botFFAValue:.6,botTeamsValue:.6},piece:"F",moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!1,isPawn:!1,isColorBound:!0},naming:{name:"Ferz",shortName:"f",description:"moves one square diagonally"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.jumping=s}},configuration:{points:{singlesPoints:1,teamsPoints:1,botFFAValue:.4,botTeamsValue:.4},piece:"W",moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!1,isPawn:!1,isColorBound:!1},naming:{name:"Wazir",shortName:"w",description:"moves one square horizontally or vertically"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.jumping=s}},configuration:{points:{singlesPoints:1,teamsPoints:1,botFFAValue:.4,botTeamsValue:.4},piece:"W",moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!1,isPawn:!1,isColorBound:!1},naming:{name:"Wazir",shortName:"w",description:"moves one square horizontally or vertically"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.jumping=u}},configuration:{points:{singlesPoints:1,teamsPoints:1,botFFAValue:1.6,botTeamsValue:1.6},piece:"S",moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!1,isPawn:!1,isColorBound:!0},naming:{name:"Dabbaba",shortName:"s",description:"jumps two squares horizontally or vertically"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.sliding=u}},configuration:{points:{singlesPoints:4,teamsPoints:4,botFFAValue:5.4,botTeamsValue:5.4},piece:"T",moveGenerationSettings:{isComplex:!1,isJumping:!1,isSliding:!0,isPawn:!1,isColorBound:!0},naming:{name:"Dabbaba-rider",shortName:"t"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.jumping=d}},configuration:{points:{singlesPoints:1,teamsPoints:1,botFFAValue:.5,botTeamsValue:.5},piece:"I",moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!1,isPawn:!1,isColorBound:!0},naming:{name:"Alfil",shortName:"i",description:"jumps two squares diagonally"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.sliding=d}},configuration:{points:{singlesPoints:3,teamsPoints:3,botFFAValue:4.5,botTeamsValue:4.5},piece:"J",moveGenerationSettings:{isComplex:!1,isJumping:!1,isSliding:!0,isPawn:!1,isColorBound:!0},naming:{name:"Alfil-rider",shortName:"j"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.jumping=[...d,...u]}},configuration:{points:{singlesPoints:3,teamsPoints:3,botFFAValue:3,botTeamsValue:3},piece:"Y",moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!1,isPawn:!1,isColorBound:!0},naming:{name:"Alibaba",shortName:"y",description:"combines alfil and dabbaba"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.sliding=[...d,...u]}},configuration:{points:{singlesPoints:6,teamsPoints:6,botFFAValue:6.2,botTeamsValue:6.2},piece:"Z",moveGenerationSettings:{isComplex:!1,isJumping:!1,isSliding:!0,isPawn:!1,isColorBound:!0},naming:{name:"Alibaba-rider",shortName:"z"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.jumping=c,this.sliding=a}},configuration:{points:{singlesPoints:12,teamsPoints:12,botFFAValue:17,botTeamsValue:17},piece:"A",moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!0,isPawn:!1,isColorBound:!1},naming:{name:"Amazon",shortName:"a",description:"combines queen and knight"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.jumping=l}},configuration:{points:{singlesPoints:3,teamsPoints:3,botFFAValue:4.2,botTeamsValue:4.2},piece:"C",moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!1,isPawn:!1,isColorBound:!0},naming:{name:"Camel",shortName:"c",description:"an elongated 3-1 knight"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.jumping=c,this.sliding=s}},configuration:{points:{singlesPoints:7,teamsPoints:7,botFFAValue:10,botTeamsValue:10},piece:"E",moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!0,isPawn:!1,isColorBound:!1},naming:{name:"Chancellor",shortName:"a",description:"combines rook and knight"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.jumping=c,this.sliding=n}},configuration:{points:{singlesPoints:7,teamsPoints:7,botFFAValue:9,botTeamsValue:9},piece:"H",moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!0,isPawn:!1,isColorBound:!1},naming:{name:"Archbishop",shortName:"h",description:"combines bishop and knight"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.sliding=c}},configuration:{points:{singlesPoints:7,teamsPoints:7,botFFAValue:10,botTeamsValue:10},piece:"O",moveGenerationSettings:{isComplex:!1,isJumping:!1,isSliding:!0,isPawn:!1,isColorBound:!1},naming:{name:"Knight-rider",shortName:"o"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.sliding=l}},configuration:{points:{singlesPoints:7,teamsPoints:7,botFFAValue:8,botTeamsValue:8},piece:"L",moveGenerationSettings:{isComplex:!1,isJumping:!1,isSliding:!0,isPawn:!1,isColorBound:!0},naming:{name:"Camel-rider",shortName:"l"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.jumping=[...l,...c]}},configuration:{points:{singlesPoints:5,teamsPoints:5,botFFAValue:8,botTeamsValue:8},piece:"V",moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!1,isPawn:!1,isColorBound:!1},naming:{name:"Wildebeest",shortName:"v",description:"combines camel and knight"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.hooks.usePerspective=[!0,!0,!0,!0],this.hooks.usePawnLogic={}}getPossibleCells(){return this.generateJumpAttack({displacement:[-1,-1],special:r.hK.AttackOnly}),this.generateJumpAttack({displacement:[-1,1],special:r.hK.AttackOnly}),this.generateSlidingAttack({displacement:[-1,0],special:r.hK.MoveOnly,limit:this.baseRankActive?2:1,irreversible:!0}),this.moves}rayGenJumpingAttacks(){this.generateJumpAttack({displacement:[-1,-1],special:r.hK.RayTrace}),this.generateJumpAttack({displacement:[-1,1],special:r.hK.RayTrace});const e=this.moves.slice();return this.moves=[],e}},configuration:{points:{singlesPoints:1,teamsPoints:1,botFFAValue:1,botTeamsValue:.4},piece:r.lH,moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!1,isPawn:!0,isColorBound:!1},naming:{name:"Pawn",shortName:r.lH.toLowerCase()}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.hooks.usePerspective=[!0,!0,!0,!0],this.hooks.usePawnLogic={}}getPossibleCells(){return this.generateSlidingAttack({displacement:[-1,-1],special:r.hK.MoveOnly,limit:this.baseRankActive?2:1,irreversible:!0}),this.generateSlidingAttack({displacement:[-1,1],special:r.hK.MoveOnly,limit:this.baseRankActive?2:1,irreversible:!0}),this.generateJumpAttack({displacement:[-1,-1],special:r.hK.AttackOnly}),this.moves}rayGenJumpingAttacks(){this.generateJumpAttack({displacement:[-1,-1],special:r.hK.RayTrace});const e=this.moves.slice();return this.moves=[],e}},configuration:{points:{singlesPoints:1,teamsPoints:1,botFFAValue:1,botTeamsValue:.4},piece:"α",moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!1,isPawn:!0,isColorBound:!1},naming:{name:"Berolina",shortName:"alpha",description:"a pawn that moves diagonally and captures forwards"}}});const e=(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.hooks.usePerspective=[!0,!0,!0,!0],this.hooks.usePawnLogic={}}getPossibleCells(){return this.generateSlidingAttack({displacement:[-1,-1],special:r.hK.MoveOnly,limit:this.baseRankActive?2:0,irreversible:!0}),this.generateSlidingAttack({displacement:[-1,1],special:r.hK.MoveOnly,limit:this.baseRankActive?2:0,irreversible:!0}),this.generateJumpAttack({displacement:[-1,-1],irreversible:!0}),this.generateJumpAttack({displacement:[-1,1],irreversible:!0}),this.moves}rayGenJumpingAttacks(){this.generateJumpAttack({displacement:[-1,-1],special:r.hK.RayTrace}),this.generateJumpAttack({displacement:[-1,1],special:r.hK.RayTrace});const e=this.moves.slice();return this.moves=[],e}},configuration:{points:{singlesPoints:1,teamsPoints:1,botFFAValue:1,botTeamsValue:.4},piece:"γ",moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!1,isPawn:!0,isColorBound:!1},naming:{name:"Stone General",shortName:"gamma",description:"a pawn that moves and captures diagonally"}}}),t=(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.hooks.usePerspective=[!0,!0,!0,!0],this.hooks.usePawnLogic={}}getPossibleCells(){return this.generateSlidingAttack({displacement:[-1,0],special:r.hK.MoveOnly,limit:this.baseRankActive?2:0,irreversible:!0}),this.generateJumpAttack({displacement:[-1,0],irreversible:!0}),this.moves}rayGenJumpingAttacks(){this.generateJumpAttack({displacement:[-1,0],special:r.hK.RayTrace});const e=this.moves.slice();return this.moves=[],e}},configuration:{points:{singlesPoints:1,teamsPoints:1,botFFAValue:1,botTeamsValue:.4},piece:"β",moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!1,isPawn:!0,isColorBound:!1},naming:{name:"Soldier",shortName:"beta",description:"a pawn that moves and captures forwards only"}}});(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.hooks.usePerspective=[!0,!0,!0,!0],this.hooks.usePawnLogic={}}getPossibleCells(){return e.getPossibleCells.call(this),t.getPossibleCells.call(this),this.moves}rayGenJumpingAttacks(){e.rayGenJumpingAttacks.call(this),t.rayGenJumpingAttacks.call(this);const i=this.moves.slice();return this.moves=[],i}},configuration:{points:{singlesPoints:1,teamsPoints:1,botFFAValue:1,botTeamsValue:.4},piece:"δ",moveGenerationSettings:{isComplex:!1,isJumping:!0,isSliding:!1,isPawn:!0,isColorBound:!1},naming:{name:"Sergeant",shortName:"delta",description:"a pawn that moves and captures forwards and diagonally"}}});const i=(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.hooks.useTrajectory=[[-1,0],[1,0],[0,1],[0,-1]]}getPossibleCells(){return this.generateJumpAttack({displacement:[-1,-2],special:r.hK.Normal,squareBlockingIndex:3}),this.generateJumpAttack({displacement:[1,-2],special:r.hK.Normal,squareBlockingIndex:3}),this.generateJumpAttack({displacement:[-1,2],special:r.hK.Normal,squareBlockingIndex:2}),this.generateJumpAttack({displacement:[1,2],special:r.hK.Normal,squareBlockingIndex:2}),this.generateJumpAttack({displacement:[2,-1],special:r.hK.Normal,squareBlockingIndex:1}),this.generateJumpAttack({displacement:[2,1],special:r.hK.Normal,squareBlockingIndex:1}),this.generateJumpAttack({displacement:[-2,-1],special:r.hK.Normal,squareBlockingIndex:0}),this.generateJumpAttack({displacement:[-2,1],special:r.hK.Normal,squareBlockingIndex:0}),this.moves}},configuration:{points:{singlesPoints:2,teamsPoints:2,botFFAValue:2.1,botTeamsValue:2.1},piece:"U",moveGenerationSettings:{isComplex:!0,isJumping:!0,isSliding:!1,isPawn:!1,isColorBound:!1},naming:{name:"Xiangqi horse",shortName:"u",description:"moves one square orthogonally and then one diagonally"}}});(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.hooks.useTrajectory=[[-1,0],[1,0],[0,1],[0,-1]]}getPossibleCells(){return i.getPossibleCells.call(this),this.sliding.forEach((e=>{this.generateSlidingAttack({displacement:e})})),this.moves}},configuration:{points:{singlesPoints:6,teamsPoints:6,botFFAValue:7.5,botTeamsValue:7.5},piece:"Δ",moveGenerationSettings:{isComplex:!0,isJumping:!0,isSliding:!0,isPawn:!1,isColorBound:!1},naming:{name:"Dragon bishop",shortName:"deltaUpper",description:"combines bishop and xiangqi horse"}}}),(0,r.pN)({baseClassRef:class extends o.V{constructor(){super(),this.hooks.useHopping=!0,this.sliding=a}},configuration:{points:{singlesPoints:3,teamsPoints:3,botFFAValue:5.8,botTeamsValue:5.8},piece:r.OB,moveGenerationSettings:{isComplex:!0,isJumping:!0,isSliding:!1,isPawn:!1,isColorBound:!1},naming:{name:"Grasshopper",shortName:r.OB.toLowerCase(),description:"jumps in any direction hopping over the first piece, landing immediately behind it"}}})}},88706:function(e,t,i){"use strict";i.d(t,{Gf:function(){return a},IM:function(){return n},KN:function(){return f},OB:function(){return d},W2:function(){return u},bB:function(){return p},hK:function(){return o},lH:function(){return l},md:function(){return h},pN:function(){return c}});var o,r=i(14230);!function(e){e[e.Normal=0]="Normal",e[e.MoveOnly=1]="MoveOnly",e[e.AttackOnly=2]="AttackOnly",e[e.RayGen=3]="RayGen",e[e.RayTrace=4]="RayTrace",e[e.RayTraceLimited=5]="RayTraceLimited"}(o||(o={}));const s=Object.values(r.KR),n=e=>e in a||s.includes(e),a=s.reduce(((e,t)=>({...e,[t]:{points:{singlesPoints:1,teamsPoints:1,botFFAValue:1,botTeamsValue:1},piece:t,moveGenerationSettings:{isComplex:!1,isJumping:!1,isSliding:!1,isPawn:!1},naming:{name:"Wall",shortName:t}}})),{}),c=e=>(a[e.configuration.piece]={...e.configuration,construct:e.baseClassRef},new e.baseClassRef),l="P",u=r.KR.wall,d="G",p={queen:"Q",rook:"R",bishop:"B",knight:"N",king:"K"},h="",f=r.KR.duck},14381:function(e,t,i){"use strict";i.d(t,{$:function(){return s},I:function(){return a}});var o=i(67037),r=i(72714);class s{dependencies=new Map;static variantRuleList=[];static initVariantRule(e){s.variantRuleList.push(e)}decorator;wrappingDecorators=[];initializeBaseHandler(e){this.decorator=e}initializeWrappingHandler(e){this.wrappingDecorators.push(e)}injectIntoBaseClass(e){return e.bind(this.decorator)}callHandler(e,t){for(const i of this.wrappingDecorators){if(!(e in i))continue;const o=i[e];if((0,r.fJ)(o))return o.call(i,...t)}const i=this.getDecoratorType();if(!(e in i.prototype))throw new Error("Method called to callHandler is not a part of prototype");const o=i.prototype[e];if(!(0,r.fJ)(o))throw new Error("Method called to callHandler is not a part of prototype");return o.call(this.decorator,...t)}getInsufficientMaterialData(){return{isPartiallyDisabled:!1,isDisabled:!1}}}const n=new Set(Reflect.ownKeys(Reflect.getPrototypeOf({})??[]));function a(e,t,i){if(0===i.length)return e;const s=(0,o.lJ)(e,t,!0),a=new Set;s.initDecoratorSettings=()=>{},a.add("initDecoratorSettings");const c=new Set;let l=null;const u=e=>"number"!=typeof e&&e in s&&!n.has(e)&&!c.has(e);for(;l=Reflect.getPrototypeOf(l??e);)Reflect.ownKeys(l).forEach((t=>{u(t)&&(s[t]=e[t],a.add(t),c.add(t))}));for(const t of Object.getOwnPropertyNames(e)){if(!(t in e))throw new Error("Expected prototype to not be overridden");const i=t;Object.defineProperty(s,t,{get:function(){return e[i]},set:function(t){e[i]=t},enumerable:!0,configurable:!1})}s.__baseClass=e;for(const e of a){const t=i.filter((t=>e in t));if(0===t.length)continue;t[0].initializeBaseHandler(s);const o=t.reduce(((e,t)=>(t.initializeBaseHandler(s),t.initializeWrappingHandler(e),t)));if(e in s){const t=Reflect.get(o,e);if("function"==typeof t){const i=t;(0,r.fJ)(s[e])&&Object.defineProperty(s,e,{value:(...e)=>i.bind(o)(...e),enumerable:!1,writable:!1,configurable:!1})}}}return s.initDecoratorSettings(),s}(0,r.s8)(i(73949))},19851:function(e,t,i){"use strict";i.r(t),i.d(t,{AllowPassing:function(){return c}});var o=i(53975),r=i(17744),s=i(14381),n=i(68463),a=i(17015);class c extends s.${static{s.$.initVariantRule(c)}getDecoratorType(){return o.$}getPublicProperties(){return{parameterValue:!0,information:{name:"Allow Passing",description:"Players can pass instead of making a move",tag:"allowPassing",color:n.p.minor,displayIcon:a.w.pause}}}matchesPGNDeclaration(e){return/^AllowPassing$/i.test(e)}serializeToParsingForm(){return"AllowPassing"}isDisabled({variantDataRules:e}){return e.giveaway}getAllowedInternalMoves(e=this.decorator.data.sideToMove){const t=this.decorator.isKingInCheck(e)?[]:[{type:r.Fi.Pass}];for(const i of this.wrappingDecorators)if(i.getAllowedInternalMoves)return[...t,...i.getAllowedInternalMoves(e)];return[...t,...o.$.prototype.getAllowedInternalMoves.call(this.decorator,e)]}}},85038:function(e,t,i){"use strict";i.r(t),i.d(t,{AlternativeTeams:function(){return a}});var o=i(5593),r=i(53975),s=i(14381),n=i(68463);class a extends s.${static{s.$.initVariantRule(a)}teammate;constructor(e){super(),this.teammate="number"==typeof e?e:2}getDecoratorType(){return r.$}getPublicProperties(){const e=1===this.teammate,t=e?"Red & Blue":"Red & Green",i=e?"Yellow & Green":"Blue & Yellow";return{parameterValue:this.teammate,information:{name:`${t} vs. ${i}`,description:`Alternative Teams: ${t} form a team against ${i}`,tag:"alternativeTeams",color:n.p.autogenous,displayIcon:"Đ"}}}matchesPGNDeclaration(e){const t=e.match(/^Teammate=(1|3)$/);return!!t&&(this.teammate=Number(t[1]),!0)}serializeToParsingForm(){return`Teammate=${this.teammate}`}isDisabled({gameType:e}){return e!==o.Jy.Teams}initDecoratorSettings(){const e=this.decorator.gameType.teamSettings;1===this.teammate?(e.firstTeamColors=[!0,!0,!1,!1],e.secondTeamColors=[!1,!1,!0,!0]):3===this.teammate&&(e.firstTeamColors=[!0,!1,!1,!0],e.secondTeamColors=[!1,!0,!0,!1]);for(const e of this.wrappingDecorators)e.initDecoratorSettings?.()}}},51226:function(e,t,i){"use strict";i.r(t),i.d(t,{BarePieceRule:function(){return l}});var o=i(17015),r=i(53975),s=i(30211),n=i(17744),a=i(14381),c=i(68463);class l extends a.${static{a.$.initVariantRule(l)}getDecoratorType(){return r.$}getPublicProperties(){return{parameterValue:!0,information:{name:"Bare piece rule",description:"Players with only one remaining piece are forfeit",tag:"barePieceRule",color:c.p.minor,displayIcon:o.w.filter}}}matchesPGNDeclaration(e){return/^BarePieceLoses$/i.test(e)}isDisabled(){return!1}getInsufficientMaterialData(){return{isPartiallyDisabled:!0,isDisabled:!1}}serializeToParsingForm(){return"BarePieceLoses"}makeMove(){const{data:{sideToMove:e},board:t,preGeneratedAttacks:i}=this.decorator,o=this.callHandler("makeMove",arguments),r=this.decorator.getPlayerPieces()[e];if(1===r.length){const a=i[e].pieceMovements.get((0,s.Kv)(r[0]));if(a){for(const{move:e}of a)if(t[e[0]][e[1]].isPiece())return o;return this.decorator.makeMove([{type:n.Fi.Resign}])}}return o}}},37869:function(e,t,i){"use strict";i.r(t),i.d(t,{Blindfold:function(){return c}});var o=i(53975),r=i(30211),s=i(14381),n=i(68463),a=i(17015);class c extends s.${static{s.$.initVariantRule(c)}getDecoratorType(){return o.$}getPublicProperties(){return{parameterValue:!0,information:{name:"Blindfold",description:"Pieces are invisible",tag:"blindfold",color:n.p.visual,displayIcon:a.w.blindfold}}}matchesPGNDeclaration(e){return/^Blindfold$/i.test(e)}serializeToParsingForm(){return"Blindfold"}isDisabled({variantDataRules:e}){return e.fogOfWar}getSquareVisibility(){return this.callHandler("getSquareVisibility",arguments).map(((e,t)=>e.map(((e,i)=>this.decorator.board[t][i].isWall()?e:[...e,r.Ft.Blindfolded]))))}}},22667:function(e,t,i){"use strict";i.r(t),i.d(t,{CaptureTheKing:function(){return a}});var o=i(17015),r=i(53975),s=i(14381),n=i(68463);class a extends s.${static{s.$.initVariantRule(a)}getDecoratorType(){return r.$}getPublicProperties(){return{parameterValue:!0,information:{name:"Capture the King",description:"To checkmate, kings must be captured",tag:"captureTheKing",color:n.p.minor,displayIcon:o.w.king}}}matchesPGNDeclaration(e){return/^CaptureTheKing$/i.test(e)}serializeToParsingForm(){return"CaptureTheKing"}isDisabled({variantDataRules:e}){return e.giveaway||e.taboo}getInsufficientMaterialData(){return{isPartiallyDisabled:!0,isDisabled:!1}}isKingInCheck(){return!1}isTheMoveLegal(){return!0}}},95291:function(e,t,i){"use strict";i.r(t),i.d(t,{Chess960:function(){return l}});var o=i(92052),r=i(53975),s=i(5593),n=i(14381),a=i(68463),c=i(17015);class l extends n.${static{n.$.initVariantRule(l)}static chess960ranges=[...Array.from({length:9},((e,t)=>[960*(t+1)+1,960+960*(t+1)])),...Array.from({length:5},((e,t)=>[1e4+960*(t+1)+1,10960+960*(t+1)]))];static minorPieceCache=function(){const e=[];for(let t=0;t<4;t++)for(let i=t+1;i<5;i++)e.push([t,i]);return e}();static pieceMasks=[[404,405,406,407,408,409,410,411,412,413,414,415,420,421,422,423,424,425,426,427,428,429,430,431,436,437,438,439,440,441,442,443,444,445,446,447,452,453,454,455,456,457,458,459,460,461,462,463,468,469,470,471,472,473,474,475,476,477,478,479,500,501,502,503,504,505,506,507,508,509,510,511,516,517,518,519,520,521,522,523,524,525,526,527,532,533,534,535,536,537,538,539,540,541,542,543,548,549,550,551,552,553,554,555,556,557,558,559,564,565,566,567,568,569,570,571,572,573,574,575,596,597,598,599,600,601,602,603,604,605,606,607,612,613,614,615,616,617,618,619,620,621,622,623,628,629,630,631,632,633,634,635,636,637,638,639,644,645,646,647,648,649,650,651,652,653,654,655,660,661,662,663,664,665,666,667,668,669,670,671,692,693,694,695,696,697,698,699,700,701,702,703,708,709,710,711,712,713,714,715,716,717,718,719,724,725,726,727,728,729,730,731,732,733,734,735,740,741,742,743,744,745,746,747,748,749,750,751,756,757,758,759,760,761,762,763,764,765,766,767,788,789,790,791,792,793,794,795,796,797,798,799,804,805,806,807,808,809,810,811,812,813,814,815,820,821,822,823,824,825,826,827,828,829,830,831,836,837,838,839,840,841,842,843,844,845,846,847,852,853,854,855,856,857,858,859,860,861,862,863,884,885,886,887,888,889,890,891,892,893,894,895,900,901,902,903,904,905,906,907,908,909,910,911,916,917,918,919,920,921,922,923,924,925,926,927,932,933,934,935,936,937,938,939,940,941,942,943,948,949,950,951,952,953,954,955,956,957,958,959],[5,6,7,9,10,11,13,14,15,17,18,19,33,34,35,37,38,39,41,42,43,45,46,47,49,50,51,53,54,55,57,58,59,61,62,63,65,66,67,69,70,71,73,74,75,77,78,79,81,82,83,85,86,87,89,90,91,93,94,95,101,102,103,105,106,107,109,110,111,113,114,115,129,130,131,145,146,147,161,162,163,177,178,179,197,198,199,201,202,203,205,206,207,209,210,211,225,226,227,241,242,243,257,258,259,273,274,275,293,294,295,297,298,299,301,302,303,305,306,307,321,322,323,337,338,339,353,354,355,369,370,371,421,422,423,425,426,427,429,430,431,437,438,439,441,442,443,445,446,447,453,454,455,457,458,459,461,462,463,469,470,471,473,474,475,477,478,479,517,518,519,521,522,523,525,526,527,533,534,535,537,538,539,541,542,543,549,550,551,553,554,555,557,558,559,565,566,567,569,570,571,573,574,575,613,614,615,617,618,619,621,622,623,629,630,631,633,634,635,637,638,639,645,646,647,649,650,651,653,654,655,661,662,663,665,666,667,669,670,671],[4,5,6,7,20,21,22,23,36,37,38,39,52,53,54,55,68,69,70,71,84,85,86,87,100,101,102,103,116,117,118,119,132,133,134,135,148,149,150,151,164,165,166,167,180,181,182,183,196,197,198,199,212,213,214,215,228,229,230,231,244,245,246,247,260,261,262,263,276,277,278,279,292,293,294,295,308,309,310,311,324,325,326,327,340,341,342,343,356,357,358,359,372,373,374,375,388,389,390,391,404,405,406,407,420,421,422,423,436,437,438,439,452,453,454,455,468,469,470,471,484,485,486,487,500,501,502,503,516,517,518,519,532,533,534,535,548,549,550,551,564,565,566,567,580,581,582,583,596,597,598,599,612,613,614,615,628,629,630,631,644,645,646,647,660,661,662,663,676,677,678,679,692,693,694,695,708,709,710,711,724,725,726,727,740,741,742,743,756,757,758,759,772,773,774,775,788,789,790,791,804,805,806,807,820,821,822,823,836,837,838,839,852,853,854,855,868,869,870,871,884,885,886,887,900,901,902,903,916,917,918,919,932,933,934,935,948,949,950,951],[16,20,34,35,38,39,40,44,58,59,62,63,112,116,130,131,134,135,136,140,154,155,158,159,208,212,226,227,230,231,232,236,250,251,254,255,304,308,322,323,326,327,328,332,346,347,350,351,400,404,418,419,422,423,424,428,442,443,446,447,496,500,514,515,518,519,520,524,538,539,542,543,592,596,610,611,614,615,616,620,634,635,638,639,688,692,706,707,710,711,712,716,730,731,734,735,784,788,802,803,806,807,808,812,826,827,830,831,880,884,898,899,902,903,904,908,922,923,926,927],[14,15,30,31,46,47,62,63,66,67,70,71,76,77,82,83,86,87,92,93,110,111,126,127,142,143,158,159,162,163,166,167,172,173,178,179,182,183,188,189,194,195,198,199,204,205,210,211,214,215,220,221,226,227,230,231,236,237,240,241,244,245,256,257,260,261,272,273,276,277,290,291,294,295,300,301,306,307,310,311,316,317,322,323,326,327,332,333,336,337,340,341,352,353,356,357,368,369,372,373,398,399,414,415,430,431,446,447,450,451,454,455,460,461,466,467,470,471,476,477,482,483,486,487,492,493,498,499,502,503,508,509,514,515,518,519,524,525,528,529,532,533,544,545,548,549,560,561,564,565,578,579,582,583,588,589,594,595,598,599,604,605,610,611,614,615,620,621,624,625,628,629,640,641,644,645,656,657,660,661,672,673,676,677,688,689,692,693,768,769,772,773,784,785,788,789,864,865,868,869,880,881,884,885],[2,6,10,14,18,22,26,30,34,38,42,46,50,54,58,62,66,70,74,78,82,86,90,94,98,102,106,110,114,118,122,126,130,134,138,142,146,150,154,158,162,166,170,174,178,182,186,190,194,198,202,206,210,214,218,222,226,230,234,238,242,246,250,254,258,262,266,270,274,278,282,286,290,294,298,302,306,310,314,318,322,326,330,334,338,342,346,350,354,358,362,366,370,374,378,382,386,390,394,398,402,406,410,414,418,422,426,430,434,438,442,446,450,454,458,462,466,470,474,478,482,486,490,494,498,502,506,510,514,518,522,526,530,534,538,542,546,550,554,558,562,566,570,574,578,582,586,590,594,598,602,606,610,614,618,622,626,630,634,638,642,646,650,654,658,662,666,670,674,678,682,686,690,694,698,702,706,710,714,718,722,726,730,734,738,742,746,750,754,758,762,766,770,774,778,782,786,790,794,798,802,806,810,814,818,822,826,830,834,838,842,846,850,854,858,862,866,870,874,878,882,886,890,894,898,902,906,910,914,918,922,926,930,934,938,942,946,950,954,958],[192,193,194,196,197,198,200,201,202,208,209,210,212,213,214,216,217,218,224,225,226,228,229,230,232,233,234,240,241,242,244,245,246,248,249,250,291,295,299,307,311,315,323,327,331,339,343,347,355,359,363,368,369,370,372,373,374,376,377,378,480,481,482,484,485,486,488,489,490,496,497,498,500,501,502,504,505,506,512,513,514,516,517,518,520,521,522,528,529,530,532,533,534,536,537,538,579,583,587,595,599,603,611,615,619,627,631,635,643,647,651,656,657,658,660,661,662,664,665,666,672,673,674,676,677,678,680,681,682,688,689,690,692,693,694,696,697,698,704,705,706,708,709,710,712,713,714,720,721,722,724,725,726,728,729,730,771,775,779,787,791,795,803,807,811,819,823,827,835,839,843,848,849,850,852,853,854,856,857,858,864,865,866,867,868,869,870,871,872,873,874,875,880,881,882,883,884,885,886,887,888,889,890,891,896,897,898,899,900,901,902,903,904,905,906,907,912,913,914,915,916,917,918,919,920,921,922,923,931,935,939,944,945,946,948,949,950,952,953,954],[1,2,4,5,6,8,9,10,12,13,14,16,17,18,20,21,22,24,25,26,28,29,30,32,33,34,36,37,38,40,41,42,44,45,46,48,49,50,52,53,54,56,57,58,60,61,62,64,65,66,68,69,70,72,73,74,76,77,78,96,97,98,100,101,102,104,105,106,108,109,110,112,113,114,116,117,118,120,121,122,124,125,126,128,129,130,132,133,134,136,137,138,140,141,142,144,145,146,148,149,150,152,153,154,156,157,158,160,161,162,164,165,166,168,169,170,172,173,174,192,193,194,196,197,198,200,201,202,204,205,206,208,209,210,212,213,214,216,217,218,220,221,222,224,225,226,228,229,230,232,233,234,236,237,238,240,241,242,244,245,246,248,249,250,252,253,254,256,257,258,260,261,262,264,265,266,268,269,270,384,385,386,388,389,390,392,393,394,396,397,398,400,401,402,404,405,406,408,409,410,412,413,414,416,417,418,420,421,422,424,425,426,428,429,430,432,433,434,436,437,438,440,441,442,444,445,446,448,449,450,452,453,454,456,457,458,460,461,462,480,481,482,484,485,486,488,489,490,492,493,494,496,497,498,500,501,502,504,505,506,508,509,510,512,513,514,516,517,518,520,521,522,524,525,526,528,529,530,532,533,534,536,537,538,540,541,542,544,545,546,548,549,550,552,553,554,556,557,558,672,673,674,676,677,678,680,681,682,684,685,686,688,689,690,692,693,694,696,697,698,700,701,702,704,705,706,708,709,710,712,713,714,716,717,718,720,721,722,724,725,726,728,729,730,732,733,734,736,737,738,740,741,742,744,745,746,748,749,750]];static c960range=function(){const e=[...Array(961).keys()];return e.shift(),e}();static twins=[959,955,951,947,958,954,950,946,957,953,949,945,956,952,948,944,943,939,935,931,942,938,934,930,941,937,933,929,940,936,932,928,927,923,919,915,926,922,918,914,925,921,917,913,924,920,916,912,911,907,903,899,910,906,902,898,909,905,901,897,908,904,900,896,895,891,887,883,894,890,886,882,893,889,885,881,892,888,884,880,879,875,871,867,878,874,870,866,877,873,869,865,876,872,868,864,863,859,855,851,862,858,854,850,861,857,853,849,860,856,852,848,847,843,839,835,846,842,838,834,845,841,837,833,844,840,836,832,831,827,823,819,830,826,822,818,829,825,821,817,828,824,820,816,815,811,807,803,814,810,806,802,813,809,805,801,812,808,804,800,799,795,791,787,798,794,790,786,797,793,789,785,796,792,788,784,783,779,775,771,782,778,774,770,781,777,773,769,780,776,772,768,671,667,663,659,670,666,662,658,669,665,661,657,668,664,660,656,655,651,647,643,654,650,646,642,653,649,645,641,652,648,644,640,639,635,631,627,638,634,630,626,637,633,629,625,636,632,628,624,623,619,615,611,622,618,614,610,621,617,613,609,620,616,612,608,607,603,599,595,606,602,598,594,605,601,597,593,604,600,596,592,591,587,583,579,590,586,582,578,589,585,581,577,588,584,580,576,383,379,375,371,382,378,374,370,381,377,373,369,380,376,372,368,367,363,359,355,366,362,358,354,365,361,357,353,364,360,356,352,351,347,343,339,350,346,342,338,349,345,341,337,348,344,340,336,335,331,327,323,334,330,326,322,333,329,325,321,332,328,324,320,319,315,311,307,318,314,310,306,317,313,309,305,316,312,308,304,303,299,295,291,302,298,294,290,301,297,293,289,300,296,292,288,767,763,759,755,766,762,758,754,765,761,757,753,764,760,756,752,751,747,743,739,750,746,742,738,749,745,741,737,748,744,740,736,735,731,727,723,734,730,726,722,733,729,725,721,732,728,724,720,719,715,711,707,718,714,710,706,717,713,709,705,716,712,708,704,703,699,695,691,702,698,694,690,701,697,693,689,700,696,692,688,687,683,679,675,686,682,678,674,685,681,677,673,684,680,676,672,575,571,567,563,574,570,566,562,573,569,565,561,572,568,564,560,559,555,551,547,558,554,550,546,557,553,549,545,556,552,548,544,543,539,535,531,542,538,534,530,541,537,533,529,540,536,532,528,527,523,519,515,526,522,518,514,525,521,517,513,524,520,516,512,511,507,503,499,510,506,502,498,509,505,501,497,508,504,500,496,495,491,487,483,494,490,486,482,493,489,485,481,492,488,484,480,287,283,279,275,286,282,278,274,285,281,277,273,284,280,276,272,271,267,263,259,270,266,262,258,269,265,261,257,268,264,260,256,255,251,247,243,254,250,246,242,253,249,245,241,252,248,244,240,239,235,231,227,238,234,230,226,237,233,229,225,236,232,228,224,223,219,215,211,222,218,214,210,221,217,213,209,220,216,212,208,207,203,199,195,206,202,198,194,205,201,197,193,204,200,196,192,479,475,471,467,478,474,470,466,477,473,469,465,476,472,468,464,463,459,455,451,462,458,454,450,461,457,453,449,460,456,452,448,447,443,439,435,446,442,438,434,445,441,437,433,444,440,436,432,431,427,423,419,430,426,422,418,429,425,421,417,428,424,420,416,415,411,407,403,414,410,406,402,413,409,405,401,412,408,404,400,399,395,391,387,398,394,390,386,397,393,389,385,396,392,388,384,191,187,183,179,190,186,182,178,189,185,181,177,188,184,180,176,175,171,167,163,174,170,166,162,173,169,165,161,172,168,164,160,159,155,151,147,158,154,150,146,157,153,149,145,156,152,148,144,143,139,135,131,142,138,134,130,141,137,133,129,140,136,132,128,127,123,119,115,126,122,118,114,125,121,117,113,124,120,116,112,111,107,103,99,110,106,102,98,109,105,101,97,108,104,100,96,95,91,87,83,94,90,86,82,93,89,85,81,92,88,84,80,79,75,71,67,78,74,70,66,77,73,69,65,76,72,68,64,63,59,55,51,62,58,54,50,61,57,53,49,60,56,52,48,47,43,39,35,46,42,38,34,45,41,37,33,44,40,36,32,31,27,23,19,30,26,22,18,29,25,21,17,28,24,20,16,15,11,7,3,14,10,6,2,13,9,5,1,12,8,4,0];static legacy={legacy2PThreshold:1e3,legacy2PRank:3,legacy4Prank:0,legacy2PTakeaway:6160};static displacement=[3,11];static createBaseChess960mappings(){return{colorBoundPieces:[2,5],supermajorPieces:[3],minorPieces:[1,6],royalPiece:[4],edgePieces:[0,7]}}static regExp=/Chess960=(\d{1,5})/i;positionID;constructor(e){super(),this.positionID="number"==typeof e?e:-1}getDecoratorType(){return r.$}getPublicProperties(){return{parameterValue:this.positionID,information:{name:"Chess960",description:"Initial position with randomly shuffled pieces on home ranks",tag:"chess960",color:a.p.startingPosition,displayIcon:c.w.chess960}}}matchesPGNDeclaration(e){const t=e.match(l.regExp);if(t){const e=Number(t[1]);return!(e<0||e>15760||(this.positionID=e,0))}return!1}serializeToParsingForm(){return`Chess960=${this.positionID}`}isDisabled(){return!1}initDecoratorSettings(){if(-1===this.positionID)throw new Error("Position ID for Chess960 is not defined");let e=this.positionID;const t=this.decorator.board;let i=l.chess960ranges.findIndex((t=>e>=t[0]&&e<=t[1]));-1===i&&(e>l.legacy.legacy2PThreshold?(i=l.legacy.legacy2PRank,e-=l.legacy.legacy2PTakeaway):i=l.legacy.legacy4Prank);const r=[[],[],[],[]],n=[13-i,i,i,13-i];r[0]=t[n[0]].slice(l.displacement[0],l.displacement[1]),r[1]=t.map((e=>e[n[1]])).slice(l.displacement[0],l.displacement[1]),r[2]=t[n[2]].slice(l.displacement[0],l.displacement[1]),r[3]=t.map((e=>e[n[3]])).slice(l.displacement[0],l.displacement[1]);const a=r.map((e=>e.map((e=>!!e.isWall())))),c=[];for(const e of a)c.push(e.reduce(((e,t,i)=>t?e.filter((e=>l.pieceMasks[i].includes(e))):e),l.c960range));const u=e-l.chess960ranges[i][0],d=[],p=e=>{const t=[2*Math.floor(e%16/4),1+e%16%4*2].sort(),i=Math.floor(e/16)%6,o=l.minorPieceCache[Math.floor(e/96)%10],r={colorBoundPieces:Array(8).fill(!1),supermajorPieces:Array(8).fill(!1),minorPieces:Array(8).fill(!1),royalPiece:Array(8).fill(!1),edgePieces:Array(8).fill(!1)};let n=!1,a=!1,c=0,u=0;for(let e=0;e<s.iJ-2*l.displacement[0];e++)e===t[0]||e===t[1]?(r.colorBoundPieces[e]=!0,c++):e===i+c?(r.supermajorPieces[e]=!0,u++):e===o[0]+c+u||e===o[1]+c+u?r.minorPieces[e]=!0:(r[n?a?"edgePieces":"royalPiece":"edgePieces"][e]=!0,a=n,n=!0);return r};for(const e of c){if(0===e.length)return null;let t=u,i=0;for(;i<2;){if(e.includes(t)){d.push(p(t));break}if(e.includes(l.twins[t-1])){d.push(p(l.twins[t-1]));break}t++,960===t&&(t=0,i++)}2===i&&c.push([])}const h=this.decorator.data.fenOptions.tag("royal"),f=h.map(((e,t)=>null!==e&&e[(0,o.ft)(t)]===n[t]?e[(0,o.ft)(t)]:-1)),g=e=>{const i=l.createBaseChess960mappings(),a=h[e];if(!a)return;const u=a[(0,o.ft)(e)],p=!!f[e]&&u<=6;for(let h=l.displacement[0];h<l.displacement[1];h++){let l;for(l in i){if(!Object.prototype.hasOwnProperty.call(i,l)||!d[e][l][h-3])continue;-1!==f[e]&&"royalPiece"===l&&u!==h&&(a[(0,o.ft)(e)]=h);const g=p&&960===c[e].length?s.iJ-1-h:h,m=i[l].shift();if(void 0!==m){t[(0,o.sC)(e)?n[e]:g][(0,o.sC)(e)?g:n[e]]=r[e][m];break}}}};for(const e of s.O9)g(e);for(const e of this.wrappingDecorators)e.initDecoratorSettings?.()}}},91617:function(e,t,i){"use strict";i.r(t),i.d(t,{Crazyhouse:function(){return d}});var o=i(53975),r=i(5593),s=i(14381),n=i(68463),a=i(88706),c=i(39567),l=i(92052),u=i(17015);class d extends s.${static{s.$.initVariantRule(d)}dependencies=new Map([[c.FiftyMoveRule,[1/0]]]);getDecoratorType(){return o.$}getPublicProperties(){return{parameterValue:!0,information:{name:"Crazyhouse",description:"You can drop pieces from banks",tag:"crazyhouse",color:n.p.extending,displayIcon:u.w.crazyhouse}}}matchesPGNDeclaration(e){return/^Crazyhouse$/i.test(e)}serializeToParsingForm(){return"Crazyhouse"}isDisabled(){return!1}getInsufficientMaterialData(){return{isPartiallyDisabled:!1,isDisabled:!0}}initDecoratorSettings(){this.decorator.data.fenOptions.setTag("areBanksEnabled",[!0,!0,!0,!0]);for(const e of this.wrappingDecorators)e.initDecoratorSettings?.()}getDroppingMoves(e,t=this.decorator.data.sideToMove){if(e.color!==t)return[];const i=this.decorator.data.fenOptions.tag("royal")[t];if(i&&this.decorator.preGeneratedAttacks[t].hoppingPieces[i[0]][i[1]])return[];const o=a.Gf[e.piece].moveGenerationSettings.isPawn,s=[],n=(0,l.sC)(t),c=!1===this.decorator.variantData.promotionRank?-1:this.decorator.variantData.promotionRank,u=this.decorator.data.fenOptions.tag("pawnBaseRank");for(let t=0;t<r.iJ;t++)if(!o||!n||c!==t&&u!==t)for(let i=0;i<r.iJ;i++)(!o||n||c!==i&&u!==i)&&this.decorator.board[t][i].isEmpty()&&s.push({piece:e,endCoordinates:[t,i]});return this.decorator.isKingInCheck(t)?s.filter((e=>{const{checks:i,checkmates:o}=this.decorator.makeMove([e],!0);return!i[t]||o[t]||this.decorator.isKingInCheck(t)})):s}}},34819:function(e,t,i){"use strict";i.r(t),i.d(t,{DuckChess:function(){return p}});var o=i(53975),r=i(17744),s=i(14381),n=i(68463),a=i(22667),c=i(12850),l=i(5593),u=i(14230),d=i(17015);class p extends s.${static{s.$.initVariantRule(p)}dependencies=new Map([[a.CaptureTheKing,[]]]);getDecoratorType(){return o.$}getPublicProperties(){return{parameterValue:!0,information:{name:"Duck Chess",description:"The duck must be moved to an empty square after every move",tag:"duckChess",color:n.p.extending,displayIcon:d.w.duck}}}matchesPGNDeclaration(e){return/^DuckChess$/i.test(e)}serializeToParsingForm(){return"DuckChess"}isDisabled({variantDataRules:e}){return e.taboo}getLegalMoves(e,t){const i=this.callHandler("getLegalMoves",arguments),o=(0,r.iw)(i),s=[],n=[];for(let e=0;e<l.iJ;e++)for(let t=0;t<l.iJ;t++){const i=this.decorator.board[e][t];i.isWall()&&i.piece===u.KR.duck?s.push([e,t]):i.isEmpty()&&n.push([e,t])}const a=[],d=[];if(0===s.length){for(const e of n)a.push({piece:c.St,endCoordinates:e});a.push({piece:c.St,endCoordinates:[e,t]})}else for(const i of s){for(const e of n)d.push({startCoordinates:i,endCoordinates:e});d.push({startCoordinates:i,endCoordinates:[e,t]})}for(const e of o)e.nextChainedMoves=a.length>0?a:d;return i}}},5443:function(e,t,i){"use strict";i.r(t),i.d(t,{FogOfWar:function(){return u}});var o=i(17015),r=i(92052),s=i(53975),n=i(30211),a=i(14381),c=i(68463),l=i(22667);class u extends a.${static{a.$.initVariantRule(u)}dependencies=new Map([[l.CaptureTheKing,[]]]);getDecoratorType(){return s.$}getPublicProperties(){return{parameterValue:!0,information:{name:"Fog of War",description:"Players can only see their pieces and the squares they can legally move to",tag:"fogOfWar",color:c.p.widespread,displayIcon:o.w.fogOfWar}}}matchesPGNDeclaration(e){return/^FogOfWar$/i.test(e)}serializeToParsingForm(){return"FogOfWar"}isDisabled({variantDataRules:e}){return e.taboo}getSquareVisibility(){const e=(0,r.BD)((()=>!1)),t=this.decorator.preGeneratedAttacks[this.decorator.data.sideToMove];for(const[i,o]of t.pieceMovements){const t=(0,n.Xm)(i);e[t[0]][t[1]]=!0;for(const{move:t}of o)e[t[0]][t[1]]=!0}for(const i of[...t.pieceDrops.pawn,...t.pieceDrops.piece])e[i.endCoordinates[0]][i.endCoordinates[1]]=!0;return this.callHandler("getSquareVisibility",arguments).map(((t,i)=>t.map(((t,o)=>this.decorator.board[i][o].isWall()||e[i][o]?t:[...t,n.Ft.Fogged]))))}}},82243:function(e,t,i){"use strict";i.r(t),i.d(t,{ForcedCapture:function(){return c}});var o=i(53975),r=i(30211),s=i(14381),n=i(68463),a=i(17015);class c extends s.${static{s.$.initVariantRule(c)}getDecoratorType(){return o.$}getPublicProperties(){return{parameterValue:!0,information:{name:"Forced Capture",description:"Capturing is always compulsory",tag:"forcedCapture",color:n.p.widespread,displayIcon:a.w.target}}}matchesPGNDeclaration(e){return/^ForcedCapture$/i.test(e)}serializeToParsingForm(){return"ForcedCapture"}isDisabled(){return!1}getInsufficientMaterialData(){return{isPartiallyDisabled:!0,isDisabled:!1}}pregenerateAttacks(){const{data:{sideToMove:e},board:t,preGeneratedAttacks:i}=this.decorator;this.callHandler("pregenerateAttacks",arguments);for(const o of this.decorator.getPlayerPieces()[e]){const s=i[e].pieceMovements.get((0,r.Kv)(o));if(s)for(const{move:o}of s)if(t[o[0]][o[1]].isPiece())return void(i[e].variantRuleCache.hasCaptures=!0)}i[e].variantRuleCache.hasCaptures=!1}isTheMoveLegal(e,t){return!(!(this.decorator.data.getCapturedPieces(t).length>0)&&this.decorator.preGeneratedAttacks[this.decorator.data.sideToMove].variantRuleCache.hasCaptures)&&this.callHandler("isTheMoveLegal",arguments)}}},53821:function(e,t,i){"use strict";i.r(t),i.d(t,{Anonymous:function(){return u},SelfPartner:function(){return p},SemiAnonymous:function(){return d}});var o=i(17015),r=i(8971),s=i(53975),n=i(5593),a=i(14230),c=i(14381),l=i(68463);class u extends c.${static{c.$.initVariantRule(u)}getDecoratorType(){return s.$}getPublicProperties(){return{parameterValue:!0,information:{name:"Anonymous",description:"Players' names and ratings are hidden",tag:"anonymous",color:l.p.metadata,displayIcon:o.w.userInformation}}}matchesPGNDeclaration(e){return/^Anonymous$/i.test(e)}serializeToParsingForm(){return"Anonymous"}isDisabled(){return!1}initDecoratorSettings(){for(let e=0;e<n.q3;e++)this.decorator.gameData.players[e].name="Anonymous",this.decorator.gameData.players[e].elo=void 0;for(const e of this.wrappingDecorators)e.initDecoratorSettings?.()}}class d extends c.${static{c.$.initVariantRule(u)}getDecoratorType(){return s.$}getPublicProperties(){return{parameterValue:!0,information:{name:"Semi-Anonymous",description:"Players's colors are hidden",tag:"semiAnonymous",color:l.p.metadata,displayIcon:o.w.userExtraInformation}}}matchesPGNDeclaration(e){return/^Semi-Anonymous$/i.test(e)}serializeToParsingForm(){return"Semi-Anonymous"}isDisabled(){return!1}initDecoratorSettings(){(0,r.Sy)(this.decorator.gameData.players);for(const e of this.wrappingDecorators)e.initDecoratorSettings?.()}}class p extends c.${static{c.$.initVariantRule(p)}getDecoratorType(){return s.$}getPublicProperties(){return{parameterValue:!0,information:{name:"Self-Partner",description:"Both sides of the team were played by one player",tag:"selfPartner",color:l.p.metadata,displayIcon:o.w.selfPartner}}}matchesPGNDeclaration(e){return/^SelfPartner$/i.test(e)}serializeToParsingForm(){return"SelfPartner"}isDisabled({gameType:e,fenTags:t}){return e!==n.Jy.Teams||0!==t.resigned.value.filter(Boolean).length}initDecoratorSettings(){for(const e of this.wrappingDecorators)e.initDecoratorSettings?.();const e=this.decorator.gameType,t=e.teamSettings.firstTeamColors.indexOf(!0),i=e.teamSettings.secondTeamColors.indexOf(!0);(0,a.O3)(t)&&(this.decorator.gameData.players[e.getTeammateColor(t)].name=this.decorator.gameData.players[t].name),(0,a.O3)(i)&&(this.decorator.gameData.players[e.getTeammateColor(i)].name=this.decorator.gameData.players[i].name)}}},74914:function(e,t,i){"use strict";i.r(t),i.d(t,{Ghostboard:function(){return c}});var o=i(17015),r=i(53975),s=i(30211),n=i(14381),a=i(68463);class c extends n.${static{n.$.initVariantRule(c)}getDecoratorType(){return r.$}getPublicProperties(){return{parameterValue:!0,information:{name:"Ghostboard",description:"Board, clocks and players are invisible",tag:"ghostboard",color:a.p.visual,displayIcon:o.w.crossedBinoculars}}}matchesPGNDeclaration(e){return/^Ghostboard$/i.test(e)}serializeToParsingForm(){return"Ghostboard"}isDisabled(){return!1}getSquareVisibility(){return this.callHandler("getSquareVisibility",arguments).map((e=>e.map((e=>[...e,s.Ft.Ghosted]))))}}},47992:function(e,t,i){"use strict";i.r(t),i.d(t,{ParadigmChess30:function(){return c}});var o=i(17015),r=i(53975),s=i(14381),n=i(68463);const a="paradigmChess30";class c extends s.${static{s.$.initVariantRule(c)}static paradigmRanges=[...Array.from({length:14},((e,t)=>[30*(t+1)+1,30+30*(t+1)]))];static permutations=[[0,0,1,1,2],[0,0,1,2,1],[0,0,2,1,1],[0,1,0,1,2],[0,1,0,2,1],[0,1,1,0,2],[0,1,1,2,0],[0,1,2,0,1],[0,1,2,1,0],[0,2,0,1,1],[0,2,1,0,1],[0,2,1,1,0],[1,0,0,1,2],[1,0,0,2,1],[1,0,1,0,2],[1,0,1,2,0],[1,0,2,0,1],[1,0,2,1,0],[1,1,0,0,2],[1,1,0,2,0],[1,1,2,0,0],[1,2,0,0,1],[1,2,0,1,0],[1,2,1,0,0],[2,0,0,1,1],[2,0,1,0,1],[2,0,1,1,0],[2,1,0,0,1],[2,1,0,1,0],[2,1,1,0,0]];static legacy={twoPlayerRank:3,twoPlayerAdjustment:120};preMethodExecution=!1;positionId;constructor(e){super(),this.positionId="number"==typeof e?e:-1}getPublicProperties(){return{parameterValue:this.positionId,information:{name:"Paradigm Chess30",description:"Paradigm Chess30: Dragon bishops combine the movement of bishop and xiangqi horse. 30 semi-random starting positions",tag:a,color:n.p.startingPosition,displayIcon:o.w.bishop}}}getDecoratorType(){return r.$}matchesPGNDeclaration(e){const t=e.match(/^ParadigmChess30=((\d{1,3}))$/i);if(t){const e=Number(t[1]);return!(e<0||e>450||(this.positionId=e,0))}return!1}serializeToParsingForm(){return`ParadigmChess30=${this.positionId}`}isDisabled(){return!1}getInformation(){return{name:"Paradigm Chess30",description:"Paradigm Chess30: Dragon bishops combine the movement of bishop and xiangqi horse. 30 semi-random starting positions",tag:a}}initDecoratorSettings(){if(-1===this.positionId)throw new Error("Position ID for Paradigm Chess30 is not defined");let e=this.positionId;const t=this.decorator.board,i=this.decorator.data;let o=c.paradigmRanges.findIndex((t=>e>=t[0]&&e<=t[1]));-1===o&&(o=c.legacy.twoPlayerRank,e+=c.legacy.twoPlayerAdjustment);const r=e-c.paradigmRanges[o][0],s=[13-o,o,o,13-o],n=[[],[],[],[]];n[0]=t[s[0]].slice(4,10),n[1]=t.map((e=>e[s[1]])).slice(4,10),n[2]=t[s[2]].slice(4,10),n[3]=t.map((e=>e[s[3]])).slice(4,10);const a=i.fenOptions.tag("royal"),l=i.fenOptions.tag("dead"),u=e=>{const i=a[e]?.[e%2==0?1:0],o=[[5,8],[4,9],[void 0===i||i>=7?6:7]],u=(i,r)=>{if(l[e])return;const c=e%2==0?s[e]:r,u=e%2==0?r:s[e];n[e][o[i][0]-4].isWall()||t[c][u].isWall()||(a.some((e=>!(!e||e[0]!==c||e[1]!==u||(e[0]=u,e[1]=c,0)))),t[c][u]=n[e][(o[i].shift()??4)-4])};let d=0;const p=void 0===i||i>=7?7:6,h=6===p?c.permutations[r].slice().reverse():c.permutations[r];for(let e=4;e<10;e++)e!==p&&u(h[d++],e)};for(let e=0;e<4;e++)u(e);for(const e of this.wrappingDecorators)e.initDecoratorSettings?.()}}},50704:function(e,t,i){"use strict";i.r(t),i.d(t,{PiecesFaceCenter:function(){return c}});var o=i(53975),r=i(30211),s=i(14381),n=i(68463),a=i(17015);class c extends s.${static{s.$.initVariantRule(c)}getDecoratorType(){return o.$}getPublicProperties(){return{parameterValue:!0,information:{name:"Pieces Face Center",description:"Pieces are rotated to face center",tag:"piecesFaceCenter",color:n.p.visual,displayIcon:a.w.pawn3dLarge}}}matchesPGNDeclaration(e){return/^PiecesFaceCenter$/i.test(e)}serializeToParsingForm(){return"PiecesFaceCenter"}isDisabled(){return!1}getSquareVisibility(){return this.callHandler("getSquareVisibility",arguments).map(((e,t)=>e.map(((e,i)=>this.decorator.board[t][i].isPiece()?[...e,r.Ft.PieceFacesCenter]:e))))}}},11792:function(e,t,i){"use strict";i.r(t),i.d(t,{SeirawanSetup:function(){return u}});var o=i(53975),r=i(30211),s=i(5593),n=i(17744),a=i(14381),c=i(68463),l=i(17015);class u extends a.${static{a.$.initVariantRule(u)}getDecoratorType(){return o.$}getPublicProperties(){return{parameterValue:!0,information:{name:"Seirawan Setup",description:"When moving a piece for the first time, a piece from the bank can be placed on the vacated square, as part of the move",tag:"seirawanSetup",color:c.p.extending,displayIcon:l.w.pieceMeal}}}matchesPGNDeclaration(e){return/^SeirawanSetup$/i.test(e)}serializeToParsingForm(){return"SeirawanSetup"}isDisabled({variantDataRules:e}){return e.crazyhouse||!1!==e.setupChess}initDecoratorSettings(){const e=this.decorator.data.fenOptions,t=e.tag("areBanksEnabled"),i=e.tag("dead"),o=e.tag("seirawanDrops"),r=e.tag("bank");for(const e of s.O9)!i[e]&&o[e].size>0&&r[e].size>0&&(t[e]=!0);for(const e of this.wrappingDecorators)e.initDecoratorSettings?.()}makeMove(e){const{fenOptions:t,sideToMove:i}=this.decorator.data,o=t.tag("areBanksEnabled"),s=t.tag("seirawanDrops"),a=t.tag("bank");let c=!1;(0,n.$j)(e[0])&&(s[i].delete((0,r.Kv)(e[0].startCoordinates)),0!==s[i].size&&0!==a[i].size||(c=!0));const l=this.callHandler("makeMove",arguments);return c&&(s[i].clear(),a[i].clear(),o[i]=!1),l}getLegalMoves(e,t){const{fenOptions:i,sideToMove:o}=this.decorator.data,s=i.tag("seirawanDrops"),a=i.tag("bank"),c=[e,t],l=(0,r.Kv)(c),u=[...s[o]].find((e=>e===l)),d=0!==a[o].size&&void 0!==u,p=this.callHandler("getLegalMoves",arguments),h=[];for(const e of a[o].keys())h.push({piece:e,endCoordinates:c});if(d&&(0,n.nc)(h))for(const e of p)e.nextChainedMoves=h;return p}}},20246:function(e,t,i){"use strict";i.r(t),i.d(t,{SelfCheck:function(){return c}});var o=i(53975),r=i(30211),s=i(14381),n=i(68463),a=i(17015);class c extends s.${static{s.$.initVariantRule(c)}getDecoratorType(){return o.$}getPublicProperties(){return{parameterValue:!0,information:{name:"Self-checks cost lives",description:"Self-checks cost lives. Checkmate yourself to earn points",tag:"selfCheck",color:n.p.minor,displayIcon:a.w.donut}}}matchesPGNDeclaration(e){return/^SelfCheck$/i.test(e)}serializeToParsingForm(){return"SelfCheck"}isDisabled({variantDataRules:e}){return!e.nCheck||!e.captureTheKing}getCurrentChecks(e=this.decorator.data.sideToMove){const{data:{fenOptions:t,sideToMove:i},preGeneratedAttacks:o}=this.decorator,s=this.callHandler("getCurrentChecks",arguments),n=t.tag("royal")[e],a=[];if(n){for(const[e,t]of o[i].hoppingPieceLines)(0,r.ef)(t,n)&&a.push((0,r.Kv)(e));for(const[e,t]of o[i].slidingPiecesLines)for(const i of t)if((0,r.ef)(i,n)){a.push((0,r.Kv)(e));break}}return s[e]=a,s}}},3936:function(e,t,i){"use strict";i.r(t),i.d(t,{SetupChess:function(){return d}});var o=i(88706),r=i(72714),s=i(53975),n=i(5593),a=i(17744),c=i(14381),l=i(68463),u=i(17015);class d extends c.${static{c.$.initVariantRule(d)}disabled=!1;setupPoints;wereBanksEnabled=[!1,!1,!1,!1];permutationCoordinates=[[],[],[],[]];pawnPermutationCoordinates=[[],[],[],[]];constructor(e){super(),this.setupPoints="number"==typeof e?e:39}getDecoratorType(){return s.$}getPublicProperties(){return{parameterValue:this.setupPoints,information:{name:`Setup ${this.setupPoints}`,description:`Set up ${this.setupPoints} points before the game starts`,tag:"setupChess",color:l.p.phased,displayIcon:u.w.movePawn}}}matchesPGNDeclaration(e){const t=e.match(/^Setup=(\d+)$/);return!!t&&(this.setupPoints=Number(t[1]),!0)}serializeToParsingForm(){return`Setup=${this.setupPoints}`}isDisabled(){return!1}getInsufficientMaterialData(){return{isPartiallyDisabled:!1,isDisabled:!0}}initDecoratorSettings(){const e=this.decorator.data.fenOptions,t=e.tag("areBanksEnabled"),i=e.tag("dead"),o=e.tag("setupComplete"),s=e.tag("setupPoints"),a=e.tag("pawnBaseRank"),c=e.tag("royal"),l=e.tag("castleKingside"),u=e.tag("castleQueenside"),d=null===s,p=(e,t,i)=>[[13-e,t],[t,e],[e,t],[13-t,e]][i];for(const e of n.O9){let h=!1;if(t[e]?(this.wereBanksEnabled[e]=!0,h=!0):o[e]||(t[e]=!0,h=!0),h){const t=(0,r.fi)(((e,t)=>t),n.iJ),i=[a,a+1].filter((e=>e>=0&&e<=13)),o=[a-1,...i];this.permutationCoordinates[e]=t.flatMap((t=>o.map((i=>p(i,t,e))))),this.pawnPermutationCoordinates[e]=t.flatMap((t=>i.map((i=>p(i,t,e)))))}d||i[e]||(s[e]=this.setupPoints),c[e]||(l[e]=!1,u[e]=!1)}for(const e of this.wrappingDecorators)e.initDecoratorSettings?.()}getLegalMoves(){return this.disabled?this.callHandler("getLegalMoves",arguments):[]}getCoordinateList(e){return o.Gf[e.piece].moveGenerationSettings.isPawn?this.pawnPermutationCoordinates:this.permutationCoordinates}getDroppingMoves(e,t=this.decorator.data.sideToMove){if(e.color!==t)return[];if(this.disabled||this.decorator.data.fenOptions.tag("setupComplete")[t])return this.callHandler("getDroppingMoves",arguments);{const i=this.getCoordinateList(e),o=[];for(const r of i[t])this.decorator.board[r[0]][r[1]].isEmpty()&&o.push({piece:e,endCoordinates:r});return o}}makeMove(e,t=!1){const i=this.decorator.data.fenOptions,r=i.tag("areBanksEnabled"),c=i.tag("dead"),l=i.tag("setupComplete"),u=i.tag("setupPoints"),d=i.tag("bank"),p=i.tag("royal"),h=this.decorator.data.sideToMove,f=e[0],g=this.callHandler("makeMove",arguments);if(!this.disabled&&!l[h]&&(0,a.x7)(f)&&u){const e=o.Gf[f.piece.piece].points.singlesPoints;"K"===f.piece.piece?(d[h].delete(f.piece),p[h]=f.endCoordinates):u[h]-=e;const t=u[h];for(const[i]of d[h])"K"!==i.piece&&e>t&&d[h].delete(i);if(0===d[h].size)l[h]=!0;else{const e=this.getCoordinateList(f.piece);let t=!1;for(const i of e[h])if(this.decorator.board[i[0]][i[1]].isEmpty()){t=!0;break}t||(l[h]=!0)}}if(l.every(((e,t)=>e||c[t]))){this.disabled=!0;for(const e of n.O9)this.wereBanksEnabled[e]||(r[e]=!1,d[e].clear())}return this.disabled||t||!l[this.decorator.data.sideToMove]||s.$.prototype.makeMove.call(this.decorator,[{type:a.Fi.Pass}]),g}}},55630:function(e,t,i){"use strict";i.r(t),i.d(t,{Taboo:function(){return c}});var o=i(53975),r=i(5593),s=i(14381),n=i(68463),a=i(17015);class c extends s.${static{s.$.initVariantRule(c)}getDecoratorType(){return o.$}getPublicProperties(){return{parameterValue:!0,information:{name:"Taboo",description:"Giving check is forbidden",tag:"taboo",color:n.p.widespread,displayIcon:a.w.equal}}}matchesPGNDeclaration(e){return/^Taboo$/i.test(e)}serializeToParsingForm(){return"Taboo"}isDisabled(){return!1}isSetupComplex(){return!0}isTheMoveLegal(e,t){const i=this.decorator.data.fenOptions.tag("dead").slice(),o=this.decorator.createSnapshot();try{this.decorator.makeMove([t],!0);const e=this.decorator.data.fenOptions.tag("dead").slice();for(const t of r.O9)if(!i[t]&&e[t]||this.decorator.isKingInCheck(t))return!1;return!0}finally{this.decorator.loadSnapshot(o)}}}},61271:function(e,t,i){"use strict";i.r(t),i.d(t,{comfuterAlgorithm:function(){return g}});var o=i(72714),r=i(92052),s=i(30211),n=i(5593),a=i(12850),c=i(17744),l=i(88706),u=i(95488),d=i(15901);const p=(e,t,i)=>i.indexOf(e)===t,h=(e,t,i)=>`${e},${t}/${i??""}`;function f(e,t,i){switch(i){case 0:return[e-1,t];case 1:return[e,t+1];case 2:return[e+1,t];case 3:return[e,t-1]}}const g=(0,u.createBotAlgorithm)(function(){let e;function t(e){return{board:e,boardSquares:e.board,data:e.data,remainingReal:e.data.getRealPlayers(),remaining:e.data.fenOptions.tag("dead").map(((e,t)=>!e&&t)).filter((e=>!1===e)),coverage:(0,r.BD)((()=>[])),pieces:e.getPlayerPieces(),controls:e.controls,royal:e.data.fenOptions.tag("royal"),hangingCache:new Map,coverageCache:new Map,pieceValueCache:new Map}}function i(t,i,o){if(-1===t)return 999;const r=e.royal[o];if(!r)return 999;const s=Math.abs(t-r[0]),n=Math.abs(i-r[1]);return 0===s&&0===n?999:Math.max(s,n)}function g(t,i,o){const{coverageCache:r,coverage:s,boardSquares:n,data:a,board:c,zombieType:l,defaultSideToMove:d}=e,p=a.fenOptions.tag("resigned"),f=h(t,i,o);if(r.has(f))return r.get(f);const g=[],m=[],v=s[t][i];if(v.length)for(const e of v){const t=n[e[0]][e[1]];if(!t.isPiece())continue;const i=t.color;p[i]&&l[i]===u.ZombieType.Rando||(c.gameType.isSameTeam(i,d)?m.push(e):g.push(e))}const y=o===d?{attackers:g,defenders:m}:{defenders:g,attackers:m};return r.set(f,y),y}function m(t,o){const{boardSquares:r,pieceValueCache:s,isFFA:c,isTeams:u,remainingReal:d,royal:p,board:h}=e,m=[t,o],v=r[t][o];if(!v.isPiece())return 0;const y=v.piece,b=`${m[0]},${m[1]}/${v.color}`;if(s.has(b))return s.get(b);let P=0;const C=l.Gf[y];if(C.moveGenerationSettings.isPawn){P=c?1:.4;const t=function(t,i,o){return-1===i?99:Math.abs(e.promotionRank[t]-(1&t?i:o))||99}(v.color,...m);if(P+=2/(3*i(...m,v.color))*(d/4),P+=3/(3*t),t<2){const e=f(...m,v.color),{attackers:i,defenders:o}=g(...e,v.color);o.length||(P+=3/t),i.length<o.length&&(P+=2/t)}}else P=u?C.points.botTeamsValue:C.points.botFFAValue;let k=!1;for(const e of p)if(e&&e[0]===m[0]&&e[1]===m[1]){k=!0;break}if(!k&&y!==a.Fb.piece)for(const e of n.O9)if(!h.gameType.isSameTeam(e,v.color)){let t=i(...m,e);t<3&&(t=2),P+=(5-d)/t}return s.set(b,P),P}function v(t){const{pieces:i,remainingReal:o}=e;let r=0;for(const e of i[t]){const{defenders:i}=g(e[0],e[1],t);for(const e of i)r+=30/(2*m(e[0],e[1]))}return 2===o?r*=.4:3===o&&(r*=.7),r/55}function y(t,i){const{data:o,defaultSideToMove:r}=e;let s=o.nextTurn();do{if(t===s)return!0;if(i===s)return!1;s=o.nextTurn(s)}while(s!==r);return!0}function b(t,i,o=m(t,i)){const{hangingCache:r,boardSquares:s,remaining:n,data:c}=e,l=h(t,i);if(r.has(l))return r.get(l);const u=s[t][i];if(!u.isPiece())return 0;const{attackers:d,defenders:f}=g(t,i,u.color);let v=999;for(const e of d)v=Math.min(v,m(e[0],e[1]));let b=!1;const P=c.nextTurn(u.color);if(n.length>2)for(const e of d)if(s[e[0]][e[1]].color===P){b=!0;break}const C=o-v;let k;for(const e of f)if(s[e[0]][e[1]].piece===a.Fb.piece){k=e;break}let T=0;const M=d.length-f.length>0;return M&&(T=o),M&&k&&(T=0),k&&d.length-f.length>1&&(T=m(k[0],k[1])),!T&&C>0&&(T=C),!T&&b&&C>=-2&&(T=-C),T&&function(t,i){const{boardSquares:o}=e;let r=[];for(const e of i){const t=o[e[0]][e[1]];t.isPiece()&&r.push(t.color)}r=r.filter(p);for(const e of r)if(y(t,e))return!1;return!0}(u.color,d)&&(T/=6),r.set(l,T),T}function P(t){const{board:i,royal:o,boardSquares:s,remainingReal:c,data:l,variantData:u,defaultSideToMove:d}=e;let p=0,f=0,v=0;if(u.giveaway)return{kingEval:p,checkableEval:f,exposedEval:v};const y=(0,r.BD)((()=>[]));for(const[e,o]of i.preGeneratedAttacks[t].hoppingPieceLines)y[o[0]][o[1]].push([e[0],e[1]]);for(const[e,o]of i.preGeneratedAttacks[t].slidingPiecesLines)for(const t of o)y[t[0]][t[1]].push([e[0],e[1]]);const b=o[t],P=new Set;if(b){const e=Boolean(i.preGeneratedAttacks[t].slidingPieces[b[0]][b[1]]||i.preGeneratedAttacks[t].hoppingPieces[b[0]][b[1]]);for(let i=0;i<n.iJ;i++)for(let o=0;o<n.iJ;o++)if(e){let e=0;if(2===c)e-=.8;else{const r=y[i][o].map((e=>{const i=s[e[0]][e[1]];return i.isPiece()?i.color:t})),n=l.nextTurn(t),a=l.previousTurn(t);for(const t of r)3===c?e-=t===a?3:2:4===c&&(e-=t===a?5:t===n?2:3)}const{defenders:r}=g(i,o,t);r.length&&(e+=2.5),e>0&&(e=0);const n=h(i,o);P.has(n)||(v-=.123,P.add(n)),f+=e}const o=b[0],r=b[1];for(let e=1;e<3;e++){const n=[o,o+e,o-e],c=[r,r+e,r-e];for(const e of n)for(const n of c){if(!s[e]?.[n])continue;if(e===o&&n===r)continue;const c=s[e][n];c.isPiece()&&(i.gameType.isSameTeam(c.color,t)?p+=c.piece===a.Fb.piece?2:1:p-=m(e,n))}}for(let e=-1;e<2;e++)for(let i=-1;i<2;i++){const n=o+e,a=r+i;if(!s[n]?.[a])continue;const{attackers:c,defenders:l}=g(n,a,t);p-=2*c.length,p+=1*l.length}p/=10}if(u.nCheck&&!i.gameType.isSameTeam(i.data.sideToMove,d))switch(l.fenOptions.tag("lives")[i.data.sideToMove]){case null:break;case 2:f*=1.5;break;case 1:f*=3;break;default:f*=1.3}return{kingEval:p,checkableEval:f,exposedEval:v}}function C(i){let o=0;const{board:r,data:l,defaultSideToMove:u,variantData:d,royal:p,isTeams:h}=e,y=r.createSnapshot(),C=l.fenOptions.isKingsideCastlingAvailable(l.sideToMove,r),k=l.fenOptions.isQueensideCastlingAvailable(l.sideToMove,r);r.makeMove([i],!0),r.pregenerateAttacks(),e={...e,...t(r)},function(){const{board:t,boardSquares:i,pieces:o,coverage:r}=e;for(const e of n.O9)for(const n of o[e]){if(!i[n[0]][n[1]].isPiece())continue;const o=t.preGeneratedAttacks[e].pieceMovements.get((0,s.Kv)(n));if(o)for(const e of o)r[e.move[0]][e.move[1]].push(n)}}();const{myMaterial:T,oppMaterial:M}=function(){const{board:t,pieces:i,isTeams:o,remainingReal:r,defaultSideToMove:s,variantData:a}=e;let c=0,l=0;for(const e of n.O9)if(t.gameType.isSameTeam(e,s))for(const t of i[e]){let e=m(t[0],t[1]);e-=b(t[0],t[1]),c+=e}else for(const c of i[e]){let i=m(c[0],c[1]);o||4!==r||2!==Math.abs(e-s)||a.giveaway||(i/=t.gameType.type===n.Jy.Solo?2:3),i-=b(c[0],c[1],i),l-=i}return o||4!==r||(l/=1.4,c*=1.2),o||3!==r||(l/=1.25,c*=1.1),c*=2,l*=2,{myMaterial:c,oppMaterial:l}}(),S=d.kingOfTheHill?416/(3*function(t){const i=e.royal[t];if(!i)return 999;const o=Math.abs(6.5-i[0]),r=Math.abs(6.5-i[1]);return(o+r)/2+Math.max(o,r)/2||999}(u)):0;if(d.giveaway)o=-3*T-M-10*v(u)+S;else{o+=function(){const{board:t,variantData:i,data:o,pieces:r,remainingReal:s}=e;t.data.sideToMove=t.data.previousTurn();const{checkmates:a,stalemates:c,checks:l}=t.getCheckmatesAndStalemates();t.data.sideToMove=t.data.nextTurn();let u=0;for(const e of n.O9)a[e]?u+=500:c[e]&&(u-=300);const d=l.filter(Boolean).length;if(3===d)u+=10;else if(2===d)u+=1;else if(1===d){const e=o.previousTurn();s>2&&l[e]?u+=1.2:u+=2===s?.1:.4}if(d&&i.nCheck){for(const e of n.O9){const t=o.fenOptions.tag("lives")[e];t&&l[e]&&(u+=4/(t+1))}u+=.3}if(i.barePieceRule)for(const e of n.O9)r[e].length<=1&&(u+=300);return u}();const t=p[u];if(t){const{attackers:e}=g(t[0],t[1],u);e.length&&(o-=700)}if(o+=function(t){const{pieces:i,boardSquares:o,isTeams:r,royal:c,defaultSideToMove:l,board:u}=e;let d=0;for(const e of i[t]){if(b(e[0],e[1])>2)continue;const i=o[e[0]][e[1]];if(!i.isPiece())continue;let p=u.preGeneratedAttacks[t].pieceMovements.get((0,s.Kv)(e))?.length??0;/[QDAEHΔ]/.test(i.piece)&&(p/=r?2:3),/[RBV]]/.test(i.piece)&&(p/=r?1.5:2),d+=p/(r?10:u.gameType.type===n.Jy.Solo?21:16);let h=!1;for(const t of c)if(t&&t[0]===e[0]&&t[1]===e[1]){h=!0;break}if(!h&&!r&&i.piece===a.Fb.piece){const i=f(e[0],e[1],t),r=o[i[0]][i[1]];if(r.isEmpty())continue;r.isPiece()?u.gameType.isSameTeam(r.color,l)?d-=.5:r.piece===a.Fb.piece?d-=1.8:t===r.color&&(d-=.5):d-=2}}return d}(u),o+=v(u),h){const e=n.O9.find((e=>e!==u&&r.gameType.isSameTeam(u,e)));e&&Object.values(P(e)).forEach((e=>o+=e))}Object.values(function(){const{board:t,royal:i,pieces:o,defaultSideToMove:r,remainingReal:s}=e;let a=0,c=0;for(const e of n.O9){const s=[],n=[];for(const r of o[e]){const o=i[e];if(!o)break;if(o[0]===r[0]&&o[1]===r[1])continue;const[a,c]=o,l=r[0],u=r[1];for(const[i,o]of t.preGeneratedAttacks[e].slidingPiecesRayTracing){let e=!1,t=!1;for(const[d,p]of o)e||d!==l||p!==u||(e=!0),t||d!==a||p!==c||(t=!0),e&&t?n.push(r):t&&!e&&s.push([i[0],i[1]])}}for(const i of n){if(b(i[0],i[1])>2)continue;const o=Math.sqrt(m(i[0],i[1]));t.gameType.isSameTeam(e,r)?a-=o:a+=o/2}for(const i of s){if(b(i[0],i[1])>2)continue;const o=Math.sqrt(m(i[0],i[1]));t.gameType.isSameTeam(e,r)?c+=o/2:c-=o}}return a*=s/6,c*=s/6,c<0&&(c/=10),{pinnedEval:a,discovsEval:c}}()).forEach((e=>o+=e)),Object.values(P(u)).forEach((e=>o+=e)),o+=T+M+S}switch("specialType"in i&&(i.specialType===c.uj.CastlingKingside||i.specialType===c.uj.CastlingQueenside)||!C&&!k||(o-=.5),function(t){if(!(0,c.$j)(t))return!1;const{data:i,defaultSideToMove:o,boardSquares:r,variantData:s}=e;if(s.giveaway)return!1;const n=i.fenOptions.tag("resigned");if(!n[o])return!1;const a=r[t.endCoordinates[0]][t.endCoordinates[1]];return!!a.isPiece()&&!!n[a.color]}(i)&&(o-=1e4),r.moves.getHash(r.moves.constructPreliminaryHashString(r))){case 1:o-=1e4;break;case 2:o-=2e4}return d.fiftyMoveRule&&d.fiftyMoveRule-r.data.plyCount<8&&(o-=15e4),r.loadSnapshot(y),o}return{stringifiedType:u.ZombieType.Futer,evaluate(i,r){!function(i){const r=!1!==i.variantData.promotionRank?[n.iJ-i.variantData.promotionRank,i.variantData.promotionRank-1,i.variantData.promotionRank-1,n.iJ-i.variantData.promotionRank]:(0,o.VS)(99,n.q3);e={...t(i),variantData:i.variantData,promotionRank:r,isFFA:i.gameType.isFFA(),isTeams:!i.gameType.isFFA(),zombieType:i.data.fenOptions.tag("zombieType"),defaultSideToMove:i.data.sideToMove}}(r.createClone());const s=new Map;for(const e of i)if((0,c.LR)(e))switch(e.type){case c.Fi.Resign:case c.Fi.Timeout:s.set(e,-1/0);break;case c.Fi.ClaimWin:s.set(e,1/0)}else s.set(e,C(e));return s},pickPreferredMove(e){const t=[...e.entries()].sort(((e,t)=>t[1]-e[1])),i=[];for(const[e,o]of t){if(t[0][1]-o>.5)break;i.push(e)}i.length>5&&(i.length=5);let o=Math.floor(Math.random()*i.length);return o>0&&Math.random()>.8&&(o=0),o>1&&Math.random()>.8&&(o=1),o>2&&Math.random()>.8&&(o=2),(0,d.randomlyPickNextChainedMoves)(i[o])}}}())},41138:function(e,t,i){"use strict";i.r(t),i.d(t,{comfuterCheckerAlgorithm:function(){return c},comfuterMuncherAlgorithm:function(){return l},comfuterPusherAlgorithm:function(){return u},createComfuterBasedAlgorithm:function(){return a},patzerAlgorithm:function(){return d}});var o=i(17744),r=i(88706),s=i(95488),n=i(61271);const a=e=>({...e,pickPreferredMove(...e){return n.comfuterAlgorithm.pickPreferredMove.apply(this,e)}}),c=(0,s.createBotAlgorithm)(a({stringifiedType:s.ZombieType.F_Checker,evaluate(e,t){const i=n.comfuterAlgorithm.evaluate.call(this,e,t);for(const[e,r]of i){if((0,o.LR)(e))continue;const s=t.createSnapshot(),{checks:n,checkmates:a}=t.makeMove([e]),c=n.filter(Boolean).length;i.set(e,r+(a.includes(!0)?500*c:1500*c)),t.moves.deleteMove(t.moves.currentMove),t.loadSnapshot(s)}return i}})),l=(0,s.createBotAlgorithm)(a({stringifiedType:s.ZombieType.F_Muncher,evaluate(e,t){const i=n.comfuterAlgorithm.evaluate.call(this,e,t);for(const[e,r]of i)(0,o.$j)(e)&&(e.specialType===o.uj.EnPassant||t.board[e.endCoordinates[0]][e.endCoordinates[1]].isEmpty()||i.set(e,r+5e3));return i}})),u=(0,s.createBotAlgorithm)(a({stringifiedType:s.ZombieType.F_Pusher,evaluate(e,t){const i=n.comfuterAlgorithm.evaluate.call(this,e,t);for(const[e,s]of i){if(!(0,o.$j)(e))continue;const n=t.board[e.startCoordinates[0]][e.startCoordinates[1]];n.isPiece()&&!r.Gf[n.piece].moveGenerationSettings.isPawn&&i.set(e,s+5e3)}return i}})),d=(0,s.createBotAlgorithm)(a({stringifiedType:s.ZombieType.Patzer,evaluate(e,t){const i=n.comfuterAlgorithm.evaluate.call(this,e,t);for(const[e,t]of i)i.set(e,-t);return i}}))},22655:function(e,t,i){"use strict";i.r(t),i.d(t,{RanterAlgorithm:function(){return a}});var o=i(95488),r=i(61271),s=i(41138),n=i(15901);const a=(0,o.createBotAlgorithm)((0,s.createComfuterBasedAlgorithm)({stringifiedType:o.ZombieType.Ranter,evaluate(...e){return Math.random()<.5?n.randoBotAlgorithm.evaluate.apply(this,e):r.comfuterAlgorithm.evaluate.apply(this,e)}}))},15901:function(e,t,i){"use strict";i.r(t),i.d(t,{randoBotAlgorithm:function(){return n},randomlyPickNextChainedMoves:function(){return s}});var o=i(17744),r=i(95488);function s(e,t=[]){const i=[...t,e];if(e.nextChainedMoves&&!e.isForcedContinuation&&Math.random()>.5)return s(e.nextChainedMoves[Math.floor(Math.random()*e.nextChainedMoves.length)],i);if(!(0,o.nc)(i))throw new Error("Required move length is 0");return i}const n=(0,r.createBotAlgorithm)({stringifiedType:r.ZombieType.Rando,evaluate(e,t){const i=e.slice();for(let t=e.length-1;t>0;t--){const o=Math.floor(Math.random()*(t+1));[i[t],i[o]]=[e[o],e[t]]}const r=t.data,s=t.board,n=[],a=[];for(const e of i){if((0,o.$j)(e)){const t=s[e.endCoordinates[1]][e.endCoordinates[0]];if(t.isPiece()&&r.fenOptions.tag("resigned")[t.color]){n.push(e);continue}}a.push(e)}let c=0;return new Map([...a.reduce(((e,t)=>(e.push([t,--c]),e)),[]),...n.reduce(((e,t)=>(e.push([t,--c/2]),e)),[])])},pickPreferredMove(e){return s([...e.entries()].reduce(((e,t)=>t[1]>e[1]?t:e))[0])}})},77832:function(e,t,i){"use strict";i.r(t),i.d(t,{checkerAlgorithm:function(){return c},createRandomBasedAlgorithm:function(){return a},muncherAlgorithm:function(){return l},pusherAlgorithm:function(){return u}});var o=i(17744),r=i(88706),s=i(95488),n=i(15901);const a=e=>({...e,pickPreferredMove(...e){return n.randoBotAlgorithm.pickPreferredMove.apply(this,e)}}),c=(0,s.createBotAlgorithm)(a({stringifiedType:s.ZombieType.Checker,evaluate(e,t){const i=n.randoBotAlgorithm.evaluate.call(this,e,t);for(const[e,o]of i){const r=t.createSnapshot(),{checks:s,checkmates:n}=t.makeMove([e]);0===s.filter(((e,t)=>e&&!n[t]===e)).length&&i.set(e,o/(o/2)),t.loadSnapshot(r)}return i}})),l=(0,s.createBotAlgorithm)(a({stringifiedType:s.ZombieType.Muncher,evaluate(e,t){const i=n.randoBotAlgorithm.evaluate.call(this,e,t);for(const[e,r]of i)(0,o.$j)(e)&&(e.specialType===o.uj.EnPassant||t.board[e.endCoordinates[0]][e.endCoordinates[1]].isEmpty()||i.set(e,r/(r/2)));return i}})),u=(0,s.createBotAlgorithm)(a({stringifiedType:s.ZombieType.Pusher,evaluate(e,t){const i=n.randoBotAlgorithm.evaluate.call(this,e,t);for(const[e,s]of i){if(!(0,o.$j)(e))continue;const n=t.board[e.startCoordinates[0]][e.startCoordinates[1]];n.isPiece()&&!r.Gf[n.piece].moveGenerationSettings.isPawn&&i.set(e,s/(s/2))}return i}}))},95488:function(e,t,i){"use strict";var o;i.r(t),i.d(t,{ZombieType:function(){return o},botAlgorithms:function(){return s},createBotAlgorithm:function(){return n},verifyZombieType:function(){return r}}),function(e){e.Rando="rando",e.Futer="comfuter",e.Ranter="ranter",e.Patzer="patzer",e.Pusher="pusher",e.Checker="checker",e.Muncher="muncher",e.F_Pusher="pusher_comfuter",e.F_Checker="checker_comfuter",e.F_Muncher="muncher_comfuter"}(o||(o={}));const r=e=>e in o,s=new Map;function n(e){return s.set(e.stringifiedType,e),e}},43341:function(e,t,i){"use strict";i.r(t),i.d(t,{InsufficientMaterialChecker:function(){return u}});var o=i(11390),r=i(72714),s=i(5593),n=i(77396),a=i(88706),c=i(55491),l=i(30211);class u{state;noRoyalsToMate=!1;isDisabled=!1;promotionPieces;hasPromotion;constructor(e,t){this.state=e;for(const e of t.variantRules){const{isDisabled:t,isPartiallyDisabled:i}=e.getInsufficientMaterialData();if(t){this.isDisabled=!0;break}i&&(this.noRoyalsToMate=!0)}this.hasPromotion=t.variantData.promotionRank!==c.disabledRank,this.promotionPieces=t.variantData.promotionPieces||[]}getRoyalPieceMedians(e){const{walls:t,royalMoveMedians:i}=this.state,o=e.data.fenOptions.tag("royal"),r=e.variantData,s=e.board.reduce(((e,i,o)=>e+i.reduce(((e,i,r)=>i.isWall()&&!t[o][r]?e+1:e),0)),0);return i.map(((e,t)=>{if(!o[t])return;let i;return r.stalemateOptions===n.stalemateOptionsValues.stalemateLoses?(i=1,e--):(e++,i=2),(e-=s)<i&&(e=i),e}))}obtainPieceSymbolFromCoordinate(e,t){const{optimizedPieces:i,pieceSquareMedians:s,backwardsPieceRegistry:n}=this.state,c=e.board[t[0]][t[1]];if(a.Gf[c.piece].moveGenerationSettings.isPawn&&this.hasPromotion){const e=[...i].filter((e=>(0,a.IM)(e)&&!a.Gf[e].moveGenerationSettings.isPawn)).map((e=>s[e]));if(0===e.length)return{selectedSymbol:o.InsufficientMaterialConstructor.NON_INDEXED_PIECE_SYMBOL,piece:c};{const t=e.map((e=>e[Object.getOwnPropertySymbols(e)[0]].reduce(((e,t)=>e+(t??0)),0))),i=t.indexOf(Math.max(...t));return{selectedSymbol:Object.getOwnPropertySymbols(e[i])[0],piece:c}}}{const e=Object.getOwnPropertySymbols(s[c.piece]),i=1===e.length?e[0]:n[c.piece][t[0]][t[1]];return(0,r.lM)(i),{selectedSymbol:i,piece:c}}}getPartialIntersection(e){const{pieceSquareMedians:t}=this.state,{board:i,army:o,pieces:r,royalColor:s}=e;for(const e of o){const{piece:o,selectedSymbol:n}=this.obtainPieceSymbolFromCoordinate(i,e);if(!(Object.getOwnPropertySymbols(t[o.piece]).length>1||a.Gf[o.piece].moveGenerationSettings.isColorBound))return 1/0;for(const e of r[s]){const{selectedSymbol:t}=this.obtainPieceSymbolFromCoordinate(i,e);if(n===t)return 1/0}}return-1}checkCurrentState(e){const t=e.data.fenOptions,i=t.tag("dead"),o=t.tag("royal"),n=e.getPlayerPieces(),c=(0,r.VS)(!1,s.q3);if(this.isDisabled)return c;const u=this.getRoyalPieceMedians(e),{oppositionMedians:d,pieceSquareMedians:p}=this.state,h=(0,r.fi)((()=>(0,r.VS)(0,s.q3)),s.q3);for(const t of s.O9){const r=n[t];if(!i[t])for(const c of s.O9)if(t!==c&&!i[c])if(!o[c]||this.noRoyalsToMate)h[c][t]=this.getPartialIntersection({board:e,army:r,pieces:n,royalColor:c});else{if(void 0===u[c])continue;const i=o[t],s=[];for(const o of r)if(i&&(0,l.ef)(o,i))e.variantData.royalsCannotCapture?h[t][c]++:h[t][c]+=d[t][c];else{const{piece:i,selectedSymbol:r}=this.obtainPieceSymbolFromCoordinate(e,o);if(this.hasPromotion&&a.Gf[i.piece].moveGenerationSettings.isPawn){const e=this.promotionPieces.map((e=>{const t=Object.getOwnPropertySymbols(p[e])[0];return p[e][t][c]??0}));h[t][c]+=Math.max(...e)}else{if(a.Gf[i.piece].moveGenerationSettings.isColorBound){if(s.includes(r))continue;s.push(r)}h[t][c]+=p[i.piece][r][c]??0}}h[t][c]+=n[c].length-1}}for(const e of s.O9){if(i[e])continue;let t=0;for(let i=0;i<s.q3;i++)i!==e&&(t+=h[i][e]);const o=u[e];(void 0!==o&&t<=o||t<0)&&(c[e]=!0)}return c}}},11390:function(e,t,i){"use strict";i.r(t),i.d(t,{InsufficientMaterialConstructor:function(){return h}});var o=i(72714),r=i(92052),s=i(53975),n=i(5593),a=i(12850),c=i(88706),l=i(42478),u=i(55491),d=i(30211),p=i(50336);class h{callback;static NON_INDEXED_PIECE_SYMBOL=Symbol();board;emptyBoard;pieceMoveRegistry={};possibleRoyals=(0,o.fi)((()=>[]),n.q3);boardDestinations=new Map;royalPieceSets=(0,o.fi)((()=>new Set),n.q3);state;constructor(e,t){this.callback=t,this.board=e.createClone(),this.emptyBoard=this.board.board.map((e=>e.map((e=>e.isWall()?e:a.v2)))),this.state={walls:this.emptyBoard.map((e=>e.map((e=>e.isWall())))),backwardsPieceRegistry:{},royalMoveMedians:(0,o.VS)(0,n.q3),pieceSquareMedians:{[c.OB]:{[h.NON_INDEXED_PIECE_SYMBOL]:[2,2,2,2]}},optimizedPieces:(0,l.optimizePieceSet)(this.board.variantData.promotionPieces||[],!0),oppositionMedians:(0,o.fi)((()=>(0,o.VS)(0,n.q3)),n.q3)}}initializeRoyals(){const e=this.board.board,t=this.board.variantData.promotionPieces||[];this.board.data.fenOptions.tag("royal").forEach(((i,o)=>{if(i){const r=e[i[0]][i[1]].piece;c.Gf[r].moveGenerationSettings.isPawn?this.possibleRoyals[o]=[r,...t]:this.possibleRoyals[o]=[r]}else t.includes(c.bB.king)&&(this.possibleRoyals[o]=[c.bB.king])}));for(const e of n.O9)this.possibleRoyals[e].length>1?this.royalPieceSets[e]=(0,l.optimizePieceSet)(this.possibleRoyals[e],!1):1===this.possibleRoyals[e].length&&this.royalPieceSets[e].add(this.possibleRoyals[e][0])}recurseThroughSquares(e,t,i){const{emptyBoard:o,board:{controls:a},pieceMoveRegistry:c}=this,u=new Set,p=new Set;if(!i.isPiece())throw new TypeError(`Wrong piece signature detected at ${i.value}`);const h=a[i.piece]().setColor(i.color).setBoard(o).setBaseImmunePieces(s.i),f=(0,r.BD)((()=>new Uint16Array(n.iJ).fill(l.oneBitMask)));!function e(t,i){const o=h.setCoordinates(t,i).constructPieceControl().getPseudoLegalMoves(),r=o.length;if(0!==r){for(let e=0;e<r;e++){const r=o[e].move,s=(0,d.Kv)(r);f[t][i][r[0]]|=l.binaryMasks[r[1]],u.has(s)||p.add(s)}for(const t of p){const[i,o]=t.split(":");u.has(t)||(u.add(t),e(parseInt(i,10),parseInt(o,10)))}}}(e,t),i.piece in c||(c[i.piece]={}),c[i.piece][Symbol()]=f;const g=new Uint16Array(14).fill(l.oneBitMask);return u.forEach((e=>{const t=e.split(":");g[parseInt(t[0],10)]|=l.binaryMasks[parseInt(t[1],10)]})),p.forEach((e=>{const t=e.split(":");g[parseInt(t[0],10)]|=l.binaryMasks[parseInt(t[1],10)]})),g}addToBoardDestinations(e,t,i){const o=this.recurseThroughSquares(e,t,i),r=this.boardDestinations.get(i.piece);r?this.boardDestinations.set(i.piece,r.concat(o)):this.boardDestinations.set(i.piece,[o])}getBoardDestinations(){const e=this.board.board,t=this.board.variantData.promotionRank||u.disabledRank,i=this.board.variantData.promotionPieces||[];for(let t=0;t<n.iJ;t++)for(let i=0;i<n.iJ;i++)e[t][i].isPiece()&&this.addToBoardDestinations(t,i,e[t][i]);const o=t!==u.disabledRank&&i.some((e=>(0,c.IM)(e))),r=[n.iJ-t,t-1,t-1,n.iJ-t],s=(0,l.optimizePieceSet)(i,!0);if(o)for(let e of n.O9){e&=1;for(let t=0;t<n.iJ;t++){const[i,o]=[e?r[e]:t,e?t:r[e]];if(!this.state.walls[i][o])for(const e of s)this.addToBoardDestinations(i,o,(0,a.HC)(0,e))}}}initializeBackwardsPieceRegistry(){const e=this.boardDestinations.entries(),{state:{backwardsPieceRegistry:t},pieceMoveRegistry:i}=this;for(const[o,s]of e){if(c.Gf[o].moveGenerationSettings.isPawn||o===c.OB||!(0,c.IM)(o))continue;let e=!0;const a=[];for(const t of s)if(0===a.length)a.push(t);else{const i=a.findIndex((e=>"number"!=typeof e&&e.every(((e,i)=>e===t[i]))));~i?a.push(i):(a.push(t),e=!1)}if(e)i[o]={[Symbol()]:i[o][Object.getOwnPropertySymbols(i[o])[0]]};else{o in t||(t[o]=(0,r.BD)((()=>null)));const e=[];for(const t of a){let i;if("number"!=typeof t)for(let r=0;r<n.iJ;r++)for(let s=0;s<n.iJ;s++)t[r]&l.binaryMasks[s]^l.oneBitMask&&(i||(i=Symbol(),e.push(i)),this.state.backwardsPieceRegistry[o][r][s]??=i);else e.push(t)}const s=Object.getOwnPropertySymbols(i[o]).map((e=>i[o][e]));i[o]={};for(let t=0;t<s.length;t++){const r=e[t];if("number"!=typeof r){if(void 0===r)break;i[o][r]=s[t]}}}}}generateOppositionSquares(){const e=this.board.board,t=this.board.controls,{emptyBoard:i}=this,a=(0,o.VS)((0,r.BD)((()=>new Uint16Array(n.iJ).fill(l.oneBitMask))),n.q3),c=(0,o.VS)(void 0,n.q3);this.board.data.fenOptions.tag("royal").forEach(((o,u)=>{if(!o)return;const d=e[o[0]][o[1]],p=(0,t[d.piece])().setColor(0).setBaseImmunePieces(s.i).setBoard(i),h=(0,r.BD)((()=>new Uint16Array(14).fill(l.oneBitMask)));for(let t=0;t<e.length;t++)for(let o=0;o<e[0].length;o++){if(i[t][o].isWall())continue;const e=p.setCoordinates(t,o).constructPieceControl().getPseudoLegalMoves(),r=new Uint16Array(n.iJ).fill(l.oneBitMask);for(const{move:t}of e)r[t[0]]|=l.binaryMasks[t[1]];h[t][o]=r,a[u][t][o]=r}c[u]=h}));for(const e of n.O9)this.state.royalMoveMedians[e]=(0,l.findMinimumOnBoardSquares)(a[e]);return{oppositionRowEchelon:c,royalMoves:a}}generateOppositeMedians(e){const{emptyBoard:t,state:{oppositionMedians:i}}=this,o=this.board.data.fenOptions.tag("royal");for(let r=0;r<n.q3;r++)for(let s=0;s<n.q3;s++){if(r===s||void 0===e[r])continue;const a=o[r],c=o[s];if(!a||!c)continue;const u=Array.from({length:14},(()=>Array.from({length:14},(()=>0))));for(let i=0;i<n.iJ;i++)for(let o=0;o<n.iJ;o++){if(t[i][o].isWall())continue;const d=e[s],h=e[r];if(!d||!h)throw new Error(`Central opposition matrix indexes are undefined: ${d?.toString()??"undefined"}  ${h?.toString()??"undefined"}`);if(d[i][o][a[1]]&l.binaryMasks[a[0]]^l.oneBitMask&&h[i][o][c[1]]&l.binaryMasks[c[0]]^l.oneBitMask)continue;const f=d[i][o].map(((e,t)=>e&h[i][o][t]));let g=0;for(let e=0;e<n.iJ;e++)g+=(0,p.y)(f[e])-1;u[i][o]=g}let d=1/0;for(let e=0;e<n.iJ;e++)for(let t=0;t<n.iJ;t++)0!==u[e][t]&&u[e][t]<d&&(d=u[e][t]);i[r][s]=d-1}}generatePieceMoveMedians(e){const{pieceMoveRegistry:t,state:{pieceSquareMedians:o,walls:r},royalPieceSets:s}=this;let n=0,a=0;for(const l in t){if(!(0,c.IM)(l)||!Object.prototype.hasOwnProperty.call(t,l))continue;if(l in o)continue;o[l]={};const u=Object.getOwnPropertySymbols(t[l]);for(const c of u){const u=new Worker(new URL(i.p+i.u(513),i.b));u.postMessage({walls:r,moveRegistryArray:t[l][c].map((e=>e.map((e=>e.buffer)))),royalMoves:e.map((e=>e.map((e=>e.map((e=>e.buffer)))))),royalPieceSet:s.map((e=>[...e]))}),a++,u.onmessage=e=>{o[l][c]=e.data,u.terminate(),a===++n&&this.callback(this.state)}}}}generateInsufficientMaterialState(){this.initializeRoyals(),this.getBoardDestinations(),this.initializeBackwardsPieceRegistry();const{royalMoves:e,oppositionRowEchelon:t}=this.generateOppositionSquares();this.generateOppositeMedians(t),this.generatePieceMoveMedians(e)}}},92513:function(e,t,i){"use strict";i.r(t);var o=i(72714),r=i(92052),s=i(5593),n=i(8971),a=i(42478);self.onmessage=e=>{const{walls:t,royalPieceSet:i,royalMoves:c,moveRegistryArray:l}=e.data,u=(0,o.fi)((()=>(0,r.BD)((()=>0))),s.q3);for(let e=0;e<s.iJ;e++)for(let o=0;o<s.iJ;o++){if(t[e][o])continue;const r=new Uint16Array(l[e][o]);for(const t of s.O9)if(0!==i[t].length){let i=0;for(let e=0;e<s.iJ;e++)for(let o=0;o<s.iJ;o++){const s=new Uint16Array(c[t][e][o]),n=r.map(((e,t)=>e&s[t])),l=(0,a.countBitsOnBoard)(n);l>i&&(i=l)}const n=u[t];n&&(n[e][o]=i)}else u[t]=void 0}postMessage(u.map((e=>{if(e){const t=(0,n.Bx)(e);return t===1/0?0:t}return e})))}},22953:function(e,t,i){"use strict";function o(e){const t={},i={};let o,r=0;for(o in e.backwardsPieceRegistry)Object.prototype.hasOwnProperty.call(e.backwardsPieceRegistry,o)&&(t[o]=e.backwardsPieceRegistry[o].map((e=>e.map((e=>null!==e?(e in i||(i[e]=r++),i[e]):e)))));const s={};for(o in e.pieceSquareMedians){if(!Object.prototype.hasOwnProperty.call(e.pieceSquareMedians,o))continue;const t={};for(const s of Object.getOwnPropertySymbols(e.pieceSquareMedians[o]))s in i?t[i[s]]=e.pieceSquareMedians[o][s]:t[r--]=e.pieceSquareMedians[o][s];s[o]=t}return{...e,backwardsPieceRegistry:t,pieceSquareMedians:s,optimizedPieces:[...e.optimizedPieces]}}function r(e){const t={},i={};let o;for(o in e.backwardsPieceRegistry)Object.prototype.hasOwnProperty.call(e.backwardsPieceRegistry,o)&&(i[o]={},t[o]=e.backwardsPieceRegistry[o].map((e=>e.map((e=>null!==e?(e in i[o]||(i[o][e]=Symbol()),i[o][e]):e)))));const r={};for(o in e.pieceSquareMedians){if(!Object.prototype.hasOwnProperty.call(e.pieceSquareMedians,o))continue;const t={};for(const r in e.pieceSquareMedians[o]){if(!Object.prototype.hasOwnProperty.call(e.pieceSquareMedians[o],r))continue;const s=Number(r);o in i&&s in i[o]?t[i[o][s]]=e.pieceSquareMedians[o][s]:t[Symbol()]=e.pieceSquareMedians[o][s]}r[o]=t}return{...e,backwardsPieceRegistry:t,pieceSquareMedians:r,optimizedPieces:new Set(e.optimizedPieces)}}i.r(t),i.d(t,{deserializeInsufficientMaterialState:function(){return r},serializeInsufficientMaterialState:function(){return o}})},42478:function(e,t,i){"use strict";i.r(t),i.d(t,{binaryMasks:function(){return n},countBitsOnBoard:function(){return c},findMinimumOnBoardSquares:function(){return l},oneBitMask:function(){return a},optimizePieceSet:function(){return u}});var o=i(5593),r=i(88706),s=i(50336);const n=Array(o.iJ).fill(1).map(((e,t)=>e<<o.iJ|e<<o.iJ-1-t)),a=1<<o.iJ;function c(e){let t=0;for(let i=0;i<o.iJ;i++)t+=(0,s.y)(e[i]^a);return t}function l(e){let t=1/0;for(let i=0;i<o.iJ;i++)for(let r=0;r<o.iJ;r++){const o=c(e[i][r]);0!==o&&o<t&&(t=o)}return t}function u(e,t){const i=[["β","W","R","E","M","Q","D","A"],["γ","F","B","H","M","Q","D","A","Δ"],["Y","Z"],["I","J"],["S","T"],["S","Y"],["I","Y"],["U","N","O"],["H","A"],["E","A"],["Δ","H"],["C","L"],["C","V"]],o=new Set;for(const s of i){const i=t?s.slice().reverse():s;for(const t of e)if(i.includes(t)){i.slice(0,-i.indexOf(t)).forEach((t=>{e.includes(t)&&(0,r.IM)(t)&&o.add(t)}));break}}return 0===o.size&&e.forEach((e=>{(0,r.IM)(e)&&o.add(e)})),o}},78965:function(e,t,i){"use strict";i.r(t),i.d(t,{Atomic:function(){return u}});var o=i(5593),r=i(88706),s=i(77028),n=i(14381),a=i(68463),c=i(83460),l=i(17015);class u extends n.${static{n.$.initVariantRule(u)}dependencies=new Map([[c.RoyalsCannotCapture,[]]]);static atomicCoordinates=[[-1,-1],[-1,0],[0,-1],[-1,1],[1,-1],[1,0],[0,1],[1,1]];getDecoratorType(){return s.c}getPublicProperties(){return{parameterValue:!0,information:{name:"Atomic",description:"Captures cause all surrounding pieces except pawns to explode",tag:"atomic",color:a.p.extending,displayIcon:l.w.atomic}}}matchesPGNDeclaration(e){return/^Atomic$/i.test(e)}serializeToParsingForm(){return"Atomic"}isDisabled(){return!1}isComplexEvaluation(){return!0}getCapturedPieces(e){const t=this.callHandler("getCapturedPieces",arguments),i=(i,s)=>{const n=e.endCoordinates[0]+i,a=e.endCoordinates[1]+s;if(n>=0&&n<=o.iJ&&a>=0&&a<=o.iJ){const e=this.decorator.board.board[n][a];!e.isPiece()&&!e.isDead()||r.Gf[e.piece].moveGenerationSettings.isPawn||t.push([n,a])}};if(0!==t.length){for(const[e,t]of u.atomicCoordinates)i(e,t);t.push([...e.startCoordinates])}return t}}},65564:function(e,t,i){"use strict";i.r(t),i.d(t,{DeadKingWalking:function(){return d}});var o=i(77028),r=i(5593),s=i(14230),n=i(12850),a=i(17744),c=i(88706),l=i(14381),u=i(68463);class d extends l.${static{l.$.initVariantRule(d)}getDecoratorType(){return o.c}getPublicProperties(){return{parameterValue:!0,information:{name:"Dead King Walking",description:"Resigned players are controlled by a bot",tag:"deadKingWalking",color:u.p.autogenous,displayIcon:""}}}matchesPGNDeclaration(e){return/^DeadKingWalking$/i.test(e)}serializeToParsingForm(){return"DeadKingWalking"}isDisabled({variantDataRules:e,gameType:t,fenTags:i}){return t===r.Jy.Teams||i.dead.value.reduce(((e,t,o)=>e+Number(t||i.resigned.value[o])),0)<=r.q3-1||!1!==e.pointsForMate&&e.pointsForMate<6}processInternalMove(e){if(e.type===a.Fi.Resign||e.type===a.Fi.ClaimWin||e.type===a.Fi.Timeout){const{sideToMove:e,fenOptions:t,board:i}=this.decorator,o=t.tag("dead"),a=t.tag("resigned");a[e]=!0,o[e]=!0;for(const t of i.getPlayerPieces()[e]){const e=i.board[t[0]][t[1]].piece;c.Gf[e].moveGenerationSettings.isPawn&&(i.board[t[0]][t[1]]=(0,n.HC)(n.Ir,e))}const l=o.map(((e,t)=>e||a[t])).filter(Boolean);if(l.length===r.q3-1){const e=l.findIndex((e=>!e));(0,s.O3)(e)&&this.decorator.assignPoints(e,this.decorator.countTotalPointsOnBoard().reduce(((t,i,o)=>t+(o===e?i:0)),0))}return{stalemates:[!1,!1,!1,!1]}}return this.callHandler("processInternalMove",arguments)}}},50175:function(e,t,i){"use strict";i.r(t),i.d(t,{EnPassant:function(){return h}});var o=i(17744),r=i(77028),s=i(12850),n=i(14381),a=i(68463),c=i(88706),l=i(14230),u=i(72714),d=i(92052),p=i(17015);class h extends n.${static{n.$.initVariantRule(h)}getDecoratorType(){return r.c}getPublicProperties(){return{parameterValue:!0,information:{name:"En Passant",description:"Pawns can capture en passant",tag:"enPassant",color:a.p.minor,displayIcon:p.w.pawnConnection}}}matchesPGNDeclaration(e){return/^EnPassant$/i.test(e)}serializeToParsingForm(){return"EnPassant"}isDisabled(){return!1}processStandardMove(e){const t=this.decorator.fenOptions.tag("enPassant"),{startCoordinates:[i,r],endCoordinates:[n,a]}=e;if(e.specialType===o.uj.EnPassant){const e=[];t.forEach(((t,i)=>{t&&t[0][0]===n&&t[0][1]===a&&e.push(i)}));for(const i of e){const e=t[i];(0,u.lM)(e),this.decorator.board.board[e[1][0]][e[1][1]]=s.v2,t[i]=null}}else{const e=this.decorator.board.board[i][r];if(!e.isEmpty()&&e.piece!==l.KR.duck&&(t[this.decorator.sideToMove]=null,c.Gf[e.piece].moveGenerationSettings.isPawn&&2===Math.abs((0,d.sC)(this.decorator.sideToMove)?i-n:r-a))){const e=[[Math.ceil((i+n)/2),Math.ceil((r+a)/2)],[n,a]];t[this.decorator.sideToMove]=e}}return this.callHandler("processStandardMove",arguments)}}},89577:function(e,t,i){"use strict";i.r(t),i.d(t,{FatalCapture:function(){return h}});var o=i(72714),r=i(77028),s=i(5593),n=i(12850),a=i(14381),c=i(68463),l=i(83460),u=i(88706),d=i(17744),p=i(17015);class h extends a.${static{a.$.initVariantRule(h)}dependencies=new Map([[l.RoyalsCannotCapture,[]]]);getDecoratorType(){return r.c}getPublicProperties(){return{parameterValue:!0,information:{name:"Fatal Capture",description:"Pieces (but not pawns) die when they capture",tag:"fatalCapture",color:c.p.extending,displayIcon:p.w.trashBin}}}matchesPGNDeclaration(e){return/^FatalCapture$/i.test(e)}serializeToParsingForm(){return"FatalCapture"}isDisabled(){return!1}affectOptions(e){let t;if((0,d.$j)(e)){const{startCoordinates:[i,r],endCoordinates:[n,a]}=e,c=this.decorator.board.board[n][a].isPiece(),l=this.decorator.fenOptions.tag("royal")[this.decorator.sideToMove];if(l&&i===l[0]&&r===l[1]&&c)return{checkmates:this.decorator.board.gameType.getBaseColors(this.decorator.sideToMove),checks:(0,o.VS)(!1,s.q3),stalemates:(0,o.VS)(!1,s.q3)};t=c?e.endCoordinates:void 0}const i=this.callHandler("affectOptions",arguments);if(t){const e=this.decorator.board.board[t[0]][t[1]];u.Gf[e.piece].moveGenerationSettings.isPawn||(this.decorator.board.board[t[0]][t[1]]=(0,n.HC)(n.Ir,this.decorator.board.board[t[0]][t[1]].piece))}return i}}},39567:function(e,t,i){"use strict";i.r(t),i.d(t,{FiftyMoveRule:function(){return n}});var o=i(77028),r=i(5593),s=i(14381);class n extends s.${static{s.$.initVariantRule(n)}totalFullMoves;constructor(e){super(),this.totalFullMoves="number"==typeof e&&e>0?e:50}getDecoratorType(){return o.c}getPublicProperties(){const e=this.totalFullMoves===1/0;return{parameterValue:this.totalFullMoves,information:{name:e?"50 move rule disabled":`${this.totalFullMoves} move rule`,textualForm:"",description:e?"50 move rule disabled":`After ${this.totalFullMoves} full moves without captures or pawn pushes game is over`,tag:"fiftyMoveRule"}}}matchesPGNDeclaration(e){const t=e.match(/^FiftyMoveRule=((?:\d+)|(?:Infinity))$/i);return!!t&&(this.totalFullMoves=Number(t[1]),!0)}serializeToParsingForm(){return`FiftyMoveRule=${this.totalFullMoves}`}isDisabled(){return!1}processStandardMove(e){return this.decorator.getCapturedPieces(e).length>0&&(this.decorator.plyCount=0),this.callHandler("processStandardMove",arguments)}affectOptions(e){const t=this.callHandler("affectOptions",arguments);e.isIrreversible?this.decorator.plyCount=0:this.decorator.plyCount++;const i=r.q3-this.decorator.fenOptions.tag("dead").filter(Boolean).length;return i>0&&Math.floor(this.decorator.plyCount/i)>this.totalFullMoves&&(this.decorator.assignGeneralTermination("50-move Rule"),this.injectIntoBaseClass((function(){this.spreadPointsBetweenPlayersEvenly()}))()),t}}},25168:function(e,t,i){"use strict";i.r(t),i.d(t,{Giveaway:function(){return u}});var o=i(77028),r=i(5593),s=i(14381),n=i(68463),a=i(82243),c=i(77396),l=i(17015);class u extends s.${static{s.$.initVariantRule(u)}static pointsForPiece=3;static stalematePoints={1:200,2:400,3:600};dependencies=new Map([[a.ForcedCapture,[]],[c.StalemateOptions,[c.stalemateOptionsValues.stalemateWins]]]);initiallyAliveColors=r.q3;getDecoratorType(){return o.c}getPublicProperties(){return{parameterValue:!0,information:{name:"Giveaway",description:"First to lose all pieces or stalemate wins",tag:"giveaway",color:n.p.widespread,displayIcon:l.w.gift}}}matchesPGNDeclaration(e){return/^Giveaway$/i.test(e)}serializeToParsingForm(){return"Giveaway"}isDisabled({variantDataRules:e}){return e.taboo}initDecoratorSettings(){this.decorator.fenOptions.setTag("royal",[null,null,null,null]),this.initiallyAliveColors=this.decorator.fenOptions.tag("dead").map(((e,t)=>e||this.decorator.fenOptions.tag("resigned")[t])).filter(Boolean).length;for(const e of this.wrappingDecorators)e.initDecoratorSettings?.()}processStandardMove(e){const t=this.decorator.getCapturedPieces(e),i=this.decorator.board.board;for(const e of t){const t=i[e[0]][e[1]];t.isPiece()&&this.assignPoints(t.color,u.pointsForPiece,!0)}return this.callHandler("processStandardMove",arguments),{endPiece:[]}}affectOptions(){const e=this.callHandler("affectOptions",arguments);return this.decorator.fenOptions.setTag("royal",[null,null,null,null]),e}obtainPointsForMate(){const e=this.decorator.fenOptions.tag("dead").filter(Boolean).length;switch(e){case 1:if(this.initiallyAliveColors===r.q3)return u.stalematePoints[1];case 2:if(this.initiallyAliveColors>=r.q3-1)return u.stalematePoints[2];case 3:return u.stalematePoints[3];default:return console.error(`Unexpected players length ${e}`),0}}assignPoints(e,t,i=!1){if(i){for(const i of this.wrappingDecorators)if(i.assignPoints)return void i.assignPoints(e,t);o.c.prototype.assignPoints.call(this.decorator,e,t)}}}},72858:function(e,t,i){"use strict";i.r(t),i.d(t,{KingOfTheHill:function(){return p}});var o=i(8971),r=i(30211),s=i(77028),n=i(5593),a=i(17744),c=i(14381),l=i(68463),u=i(20831),d=i(17015);class p extends c.${static{c.$.initVariantRule(p)}static defaultCoordinates=[[7,7],[7,6],[6,7],[6,6]];static defaultRoyal="K";hillSquares;constructor(e){super(),Array.isArray(e)&&e.every((e=>Array.isArray(e)&&2===e.length&&e.every((e=>"number"==typeof e))))?this.hillSquares=e:this.hillSquares=p.defaultCoordinates}getDecoratorType(){return s.c}getPublicProperties(){return{parameterValue:this.hillSquares,information:{name:"King of the Hill",description:"A king reaching the hill will checkmate all opponents",tag:"kingOfTheHill",color:l.p.autogenous,displayIcon:d.w.kingOfTheHill}}}matchesPGNDeclaration(e){const t=e.toLowerCase().match(/^KotH(?:=(.+))?$/i);if(t){if(t[1]){const e=[],i=t[1].split(",");for(const t of i){const i=(0,u._q)(t);i&&e.push(i)}e.length>0&&(this.hillSquares=e)}return!0}return!1}serializeToParsingForm(){return(0,o.Rt)(this.hillSquares,p.defaultCoordinates)?"KotH":`KotH=${this.hillSquares.map((e=>(0,n.kZ)(e))).join(",")}`}isDisabled(){return!1}getInsufficientMaterialData(){return{isPartiallyDisabled:!0,isDisabled:!0}}affectOptions(){const{board:e,sideToMove:t,fenOptions:i}=this.decorator,o=this.callHandler("affectOptions",arguments),s=i.tag("royal")[t],c=i.tag("dead"),l=i.tag("wb");if(e.variantData.giveaway&&this.hillSquares.some((t=>{const i=e.board[t[0]][t[1]];return i.isPiece()&&i.piece===p.defaultRoyal})))this.decorator.processInternalMove({type:a.Fi.Stalemate}),o.stalemates[t]=!0;else if(s&&this.hillSquares.some((e=>(0,r.ef)(e,s)))){const e=this.decorator.obtainPointsForMate();for(const i of n.O9)i!==t&&(c[i]||(c[i]=!0,this.decorator.assignPoints(t,e)));this.decorator.board.variantData.taboo?this.decorator.gameOver=`${(0,n.oh)(t,l).toUpperCase()} WON THE RACE!`:this.decorator.assignGeneralTermination("King of the Hill")}return o}}},5954:function(e,t,i){"use strict";i.r(t),i.d(t,{NCheck:function(){return u}});var o=i(72714),r=i(30211),s=i(77028),n=i(15140),a=i(5593),c=i(17744),l=i(14381);class u extends l.${static{l.$.initVariantRule(u)}defaultChecks;constructor(e){super(),Array.isArray(e)&&(0,o.CG)(e,a.q3)&&e.every((e=>"number"==typeof e))?this.defaultChecks=e:this.defaultChecks=(0,o.VS)(3,a.q3)}getDecoratorType(){return s.c}getPublicProperties(){const e=this.defaultChecks.filter(Boolean).reduce(((e,t,i,o)=>e+(o[i-1]===o[i]?"":`-${t}`)),"").slice(1);return{parameterValue:this.defaultChecks,information:{name:`${e}-Check`,textualForm:`${e}+`,description:`Checking a king ${e} times is checkmate`,tag:"nCheck"}}}matchesPGNDeclaration(e){const t=e.toLowerCase().match(/^(\d\d?\d?(?:-\d\d?\d?){0,3})-check$/i);if(t){const e=t[1].split("-");for(let t=0;t<=e.length;t++)if(e[t])this.defaultChecks[t]=Number(e[t]);else for(;t!==a.q3;)this.defaultChecks[t]=this.defaultChecks[t-1],t++;return!0}return!1}serializeToParsingForm(){return`${this.defaultChecks.join("-")}-check`}isDisabled({variantDataRules:e}){return e.giveaway}getInsufficientMaterialData(){return{isPartiallyDisabled:!0,isDisabled:!1}}initDecoratorSettings(){const e=this.decorator.fenOptions.tag("lives");for(const t of a.O9)null===e[t]&&(e[t]=this.defaultChecks[t]);for(const e of this.wrappingDecorators)e.initDecoratorSettings?.()}affectOptions(e,t=(0,n.Yx)()){const{board:i,sideToMove:s}=this.decorator,l=i.getCurrentChecks().map((e=>new Set(e))),u=!t.ignoreCheckmateChecks&&!t.ignoreNextTurn,d=this.decorator.fenOptions.tag("royal"),p=this.decorator.fenOptions.tag("lives"),h=this.callHandler("affectOptions",arguments),f=(0,c.$j)(e);if(u){const t=i.getCurrentChecks(s),n=(0,o.VS)(0,a.q3);for(const i of a.O9)for(const o of t[i]){const t=d[i];(!l[i].has(o)||t&&f&&(0,r.ef)(e.endCoordinates,t))&&n[i]++}if(p.every((e=>null!==e)))for(const e of a.O9)p[e]-=n[e],p[e]<=0&&(this.decorator.assignPoints(s,this.decorator.obtainPointsForMate()),this.decorator.turnPiecesDead(e),p[e]=0);this.decorator.getRealPlayers()>1&&(this.decorator.sideToMove=this.decorator.nextTurn(s),i.pregenerateAttacks())}return h}}},67090:function(e,t,i){"use strict";i.r(t),i.d(t,{OppositeMultiplier:function(){return a}});var o=i(77028),r=i(5593),s=i(88706),n=i(14381);class a extends n.${static{n.$.initVariantRule(a)}oppositeMultiplierValue=2;getDecoratorType(){return o.c}getPublicProperties(){return{parameterValue:this.oppositeMultiplierValue,information:{name:"Opposite's piece value",textualForm:`Ox${this.oppositeMultiplierValue}`,description:`Opposite's pieces are worth ${this.oppositeMultiplierValue} times their normal points value until one player is eliminated`,tag:"oppositeMultiplier"}}}matchesPGNDeclaration(e){const t=e.toLowerCase().match(/^OppX=(2|3|4|5|6)$/i);return!!t&&(this.oppositeMultiplierValue=Number(t[1]),!0)}serializeToParsingForm(){return`OppX=${this.oppositeMultiplierValue}`}isDisabled({variantDataRules:e,gameType:t,fenTags:i}){return t===r.Jy.Teams||e.giveaway||i.dead.value.reduce(((e,t,o)=>e+Number(t||i.resigned.value[o])),0)<=r.q3-1}getPointsForPiece(e){const t=this.decorator.fenOptions.tag("dead"),i=this.decorator.fenOptions.tag("resigned");return t.map(((e,t)=>e||i[t])).filter(Boolean).length===r.q3&&e.isPiece()&&e.color===(0,r.R4)(this.decorator.sideToMove)?s.Gf[e.piece].points.singlesPoints*this.oppositeMultiplierValue:this.callHandler("getPointsForPiece",arguments)}}},25427:function(e,t,i){"use strict";i.r(t),i.d(t,{OppositeSideCastling:function(){return c}});var o=i(17744),r=i(77028),s=i(14381),n=i(68463),a=i(5593);class c extends s.${static{s.$.initVariantRule(c)}getDecoratorType(){return r.c}getPublicProperties(){return{parameterValue:!0,information:{name:"Opposite-side Castling",description:"Once your opponent has castled, you can only castle to the opposite side",tag:"oppositeSideCastling",color:n.p.minor,displayIcon:"ὸ"}}}matchesPGNDeclaration(e){return/^OppositeSideCastling$/i.test(e)}serializeToParsingForm(){return"OppositeSideCastling"}isDisabled(){return!1}processStandardMove(e){const t=this.callHandler("processStandardMove",arguments);if("specialType"in e){let t;e.specialType===o.uj.CastlingKingside?t=this.decorator.fenOptions.tag("castleKingside"):e.specialType===o.uj.CastlingQueenside&&(t=this.decorator.fenOptions.tag("castleQueenside")),t&&(t[(0,a.R4)(this.decorator.sideToMove)]=!1)}return t}}},74406:function(e,t,i){"use strict";i.r(t),i.d(t,{PiecesGoToBanks:function(){return l}});var o=i(77028),r=i(12850),s=i(14381),n=i(68463),a=i(17744),c=i(17015);class l extends s.${getDecoratorType(){return o.c}getPublicProperties(){return{parameterValue:!0,information:{name:"Bank Captures",description:"Captured pieces go to banks",tag:"piecesGoToBanks",color:n.p.extending,displayIcon:c.w.copyToClipboard}}}matchesPGNDeclaration(e){return/^Crazy(?:house|wan)$/i.test(e)}serializeToParsingForm(){return""}isDisabled(){return!1}processStandardMove(e){const t=this.decorator.fenOptions.tag("promotedFrom");if(e.promotion){const i=this.decorator.board.board[e.startCoordinates[0]][e.startCoordinates[1]].piece;t.set(e.endCoordinates,i)}else for(const[i,o]of t)if(i[0]===e.startCoordinates[0]&&i[1]===e.endCoordinates[1]){t.delete(i),t.set(e.endCoordinates,o);break}return this.callHandler("processStandardMove",arguments)}affectOptions(e){const t=this.decorator.fenOptions,i=t.tag("areBanksEnabled"),o=t.tag("bank"),s=t.tag("promotedFrom");if(i[this.decorator.sideToMove]&&!(0,a.LR)(e)&&(0,a.$j)(e)){const t=this.decorator.getCapturedPieces(e),i=this.decorator.sideToMove,n=e=>{for(const[t,r]of o[i])if(t.piece===e&&t.color===i)return void o[i].set(t,r+1);o[i].set((0,r.HC)(i,e),1)};t.forEach((e=>{for(const[t,i]of s)if(t[0]===e[0]&&t[1]===e[1])return s.delete(t),void n(i);n(this.decorator.board.board[e[0]][e[1]].piece)}))}return this.callHandler("affectOptions",arguments)}}},19798:function(e,t,i){"use strict";i.r(t),i.d(t,{PlayForMate:function(){return c}});var o=i(17015),r=i(77028),s=i(5593),n=i(14381),a=i(68463);class c extends n.${static{n.$.initVariantRule(c)}initiallyAliveColors=s.q3;static checkmatePoints={1:24,2:32,3:48};getDecoratorType(){return r.c}getPublicProperties(){return{parameterValue:!0,information:{name:"Play for mate",description:"No points for pieces, only checkmates matter",tag:"playForMate",color:a.p.pointsAlternation,displayIcon:o.w.hashtag}}}matchesPGNDeclaration(e){return/^Play4Mate$/i.test(e)}serializeToParsingForm(){return"Play4Mate"}isDisabled({gameType:e}){return e===s.Jy.Teams}initDecoratorSettings(){this.initiallyAliveColors=this.decorator.fenOptions.tag("dead").map(((e,t)=>e||this.decorator.fenOptions.tag("resigned")[t])).filter(Boolean).length;for(const e of this.wrappingDecorators)e.initDecoratorSettings?.()}obtainPointsForMate(){const e=this.decorator.fenOptions.tag("dead").filter(Boolean).length;switch(e){case 1:if(this.initiallyAliveColors===s.q3)return c.checkmatePoints[1];case 2:if(this.initiallyAliveColors>=s.q3-1)return c.checkmatePoints[2];case 3:return c.checkmatePoints[3];default:return console.error(`Unexpected players length ${e}`),0}}getPointsForPiece(){return 0}}},82620:function(e,t,i){"use strict";i.r(t),i.d(t,{PointsForMate:function(){return n}});var o=i(5593),r=i(77028),s=i(14381);class n extends s.${static{s.$.initVariantRule(n)}pointsForMate;constructor(e){super(),this.pointsForMate="number"==typeof e?e:20}getDecoratorType(){return r.c}getPublicProperties(){return{parameterValue:this.pointsForMate,information:{name:`${this.pointsForMate}-point checkmate`,textualForm:`+${this.pointsForMate}`,description:`Checkmates & king captures are worth ${this.pointsForMate} points`,tag:"pointsForMate"}}}matchesPGNDeclaration(e){const t=e.match(/^PointsForMate=(3|5|10|40)$/i);return!!t&&(this.pointsForMate=Number(t[1]),!0)}serializeToParsingForm(){return`PointsForMate=${this.pointsForMate}`}isDisabled({variantDataRules:e,gameType:t}){return e.giveaway||e.playForMate||t===o.Jy.Teams}obtainPointsForMate(){return this.pointsForMate}}},77396:function(e,t,i){"use strict";i.r(t),i.d(t,{StalemateOptions:function(){return d},stalemateOptionsValues:function(){return l},verifyCustomStalemateValue:function(){return u}});var o=i(72714),r=i(77028),s=i(17744),n=i(14381),a=i(68463),c=i(17015);const l={stalemateLoses:"loss",stalemateWins:"win",stalemateDraws:"draw"},u=e=>Object.values(l).includes(e);class d extends n.${static{n.$.initVariantRule(d)}type;isFFA=!1;constructor(e){super(),"string"==typeof e&&u(e)?this.type=e:this.type=!1}getDecoratorType(){return r.c}getPublicProperties(){const e="draw"===this.type?"Stalemate is a draw":this.isFFA?"The remaining players share the points":"The stalemated player "+("loss"===this.type?"loses":"wins");return{parameterValue:this.type,information:{name:e,description:e,tag:"stalemateOptions",color:a.p.minor,displayIcon:c.w.dollarSign}}}matchesPGNDeclaration(e){const t=e.toLowerCase().match(/^Stalemate=(.+)$/i);if(t){const e=t[1];return u(e)&&(this.type=e),!0}return!1}serializeToParsingForm(){return`Stalemate=${this.type||"draw"}`}isDisabled(){return!1}initDecoratorSettings(){!1===this.type&&(this.decorator.board.gameType.isFFA()&&this.decorator.fenOptions.tag("dead").filter(Boolean).length>2?(this.type="win",this.isFFA=!0):(this.type="draw",this.isFFA=!1));for(const e of this.wrappingDecorators)e.initDecoratorSettings?.()}processInternalMove(e){const t=this.decorator.sideToMove,i=this.callHandler("processInternalMove",arguments);if(e.type===s.Fi.Stalemate){const e=this.decorator.obtainPointsForMate();switch(this.type){case"loss":if(!this.isFFA){this.decorator.points[t]+=e;break}case"draw":this.injectIntoBaseClass((function(){this.spreadPointsBetweenPlayersEvenly()}))();break;case"win":this.decorator.points[this.decorator.sideToMove]+=e;break;case!1:break;default:(0,o.h0)(this.type)}1===this.decorator.getRealPlayers()&&this.decorator.assignGeneralTermination("Stalemate",t)}return i}}},38191:function(e,t,i){"use strict";i.r(t),i.d(t,{Takeover:function(){return p}});var o=i(30211),r=i(77028),s=i(5593),n=i(12850),a=i(88706),c=i(14381),l=i(68463),u=i(65564),d=i(17015);class p extends c.${static{c.$.initVariantRule(p)}dependencies=new Map([[u.DeadKingWalking,[]]]);getDecoratorType(){return r.c}getPublicProperties(){return{parameterValue:!0,information:{name:"Takeover",description:"Checkmate players to take control of their pieces",tag:"takeover",color:l.p.phased,displayIcon:d.w.exchange}}}matchesPGNDeclaration(e){return/^Takeover$/i.test(e)}serializeToParsingForm(){return"Takeover"}isDisabled({gameType:e}){return e===s.Jy.Teams}affectOptions(){const e=this.decorator.sideToMove,t=this.decorator.board.getPlayerPieces(),i=this.callHandler("affectOptions",arguments);for(const o of s.O9)if(i.checkmates[o])for(const i of t[e]){const t=this.decorator.board.board[i[0]][i[1]];t.isDead()&&!a.Gf[t.piece].moveGenerationSettings.isPawn&&(this.decorator.board.board[i[0]][i[1]]=(0,n.HC)(e,t.piece))}return i}countTotalPointsOnBoard(){const e=this.decorator.fenOptions.tag("zombieImmune"),t=this.decorator.fenOptions.tag("royal"),i=[0,0,0,0];return this.decorator.board.getPlayerPieces().forEach(((r,s)=>{if(e[s])return;const n=t[s];for(const e of r)if(n&&(0,o.ef)(e,n))i[s]+=this.decorator.obtainPointsForMate();else{const t=this.decorator.board.board[e[0]][e[1]].piece;i[s]+=a.Gf[t].points.singlesPoints}})),i}}},21680:function(e,t,i){"use strict";i.r(t),i.d(t,{ThreefoldRepetition:function(){return s}});var o=i(77028),r=i(14381);class s extends r.${static{r.$.initVariantRule(s)}totalRepetitionsRequired;constructor(e){super(),this.totalRepetitionsRequired="number"==typeof e&&e>0?e:3}getDecoratorType(){return o.c}getPublicProperties(){const e=this.totalRepetitionsRequired===1/0;return{parameterValue:this.totalRepetitionsRequired,information:{name:e?"3-fold repetition disabled":`${this.totalRepetitionsRequired}-fold repetition`,textualForm:"",description:e?"3-fold repetition disabled":`After position repeats ${this.totalRepetitionsRequired} times game is over`,tag:"threefoldRepetition"}}}matchesPGNDeclaration(e){const t=e.match(/^ThreefoldRepetition=((?:\d+)|(?:Infinity))$/i);return!!t&&(this.totalRepetitionsRequired=Number(t[1]),!0)}serializeToParsingForm(){return`ThreefoldRepetition=${this.totalRepetitionsRequired}`}isDisabled(){return!1}affectOptions(){const e=this.callHandler("affectOptions",arguments);return this.decorator.board.moves.getHash(this.decorator.board.moves.constructPreliminaryHashString(this.decorator.board))+1>=this.totalRepetitionsRequired&&(this.decorator.assignGeneralTermination("Threefold Repetition"),this.injectIntoBaseClass((function(){this.spreadPointsBetweenPlayersEvenly()}))()),e}}},17224:function(e,t,i){"use strict";i.r(t),i.d(t,{AnyCapture:function(){return l}});var o=i(72714),r=i(5593),s=i(19659),n=i(14381),a=i(68463),c=i(17015);class l extends n.${static{n.$.initVariantRule(l)}getDecoratorType(){return s.V}getPublicProperties(){return{parameterValue:!0,information:{name:"Any Capture",description:"You can capture your own pieces",tag:"anyCapture",color:a.p.autogenous,displayIcon:c.w.captureAnything}}}matchesPGNDeclaration(e){return/^AnyCapture$/i.test(e)}serializeToParsingForm(){return"AnyCapture"}isDisabled(){return!1}configure(e){const t={...e,immunePieces:(0,o.VS)(!1,r.q3)};for(const e of this.wrappingDecorators)if(e.configure)return e.configure(t);return s.V.prototype.configure.call(this.decorator,t)}}},97288:function(e,t,i){"use strict";i.r(t),i.d(t,{PromoteTo:function(){return a}});var o=i(88706),r=i(52514),s=i(19659),n=i(14381);class a extends n.${static{n.$.initVariantRule(a)}promotionPieces;constructor(e){super(),this.promotionPieces=Array.isArray(e)&&e.every((e=>"string"==typeof e&&(0,o.IM)(e)))?e:[o.bB.queen,o.bB.rook,o.bB.bishop,o.bB.knight]}getDecoratorType(){return s.V}getPublicProperties(){const e=this.promotionPieces.reduce(((e,t)=>[...e,o.Gf[t].naming.name]),[]);return{parameterValue:this.promotionPieces,information:{name:"Promotion Pieces",textualForm:"",description:`Pawns promote to ${(0,r.zL)((0,r.uC)(e))}`,tag:"promotionPieces"}}}matchesPGNDeclaration(e){const t=e.match(/^PromoteTo=([A-Zx]+)$/i);if(t){const e=t[1].split("").filter((e=>(0,o.IM)(e)));return e.length&&(this.promotionPieces=e),!0}return!1}serializeToParsingForm(){return`PromoteTo=${this.promotionPieces.join("")}`}isDisabled(){return!1}initDecoratorSettings(){this.decorator.hooks.usePawnLogic&&(this.decorator.hooks.usePawnLogic.promotionPieces=this.promotionPieces);for(const e of this.wrappingDecorators)e.initDecoratorSettings?.()}}},55491:function(e,t,i){"use strict";i.r(t),i.d(t,{PromotionRank:function(){return c},disabledRank:function(){return a}});var o=i(52514),r=i(5593),s=i(19659),n=i(14381);const a=99;class c extends n.${static{n.$.initVariantRule(c)}promotionRank;constructor(e){super(),this.promotionRank="number"==typeof e?e:8}getDecoratorType(){return s.V}getPublicProperties(){return{parameterValue:this.promotionRank,information:{name:"Promotion Rank",textualForm:"",description:`on the ${this.promotionRank}${(0,o.od)(this.promotionRank)} rank`,tag:"promotionRank"}}}matchesPGNDeclaration(e){const t=e.match(/^Prom=(\d\d?)$/i);return!!t&&(this.promotionRank=Number(t[1]),!0)}serializeToParsingForm(){return`Prom=${this.promotionRank}`}isDisabled(){return!1}initDecoratorSettings(){this.decorator.hooks.usePawnLogic&&(this.decorator.hooks.usePawnLogic.promotionRanks=[r.iJ-this.promotionRank,this.promotionRank-1,this.promotionRank-1,r.iJ-this.promotionRank]);for(const e of this.wrappingDecorators)e.initDecoratorSettings?.()}}},83460:function(e,t,i){"use strict";i.r(t),i.d(t,{RoyalsCannotCapture:function(){return c}});var o=i(17015),r=i(19659),s=i(88706),n=i(14381),a=i(68463);class c extends n.${getDecoratorType(){return r.V}getPublicProperties(){return{parameterValue:!0,information:{name:"Royals Cannot Capture",description:"Royal pieces cannot capture pieces.",tag:"royalsCannotCapture",color:a.p.autogenous,displayIcon:o.w.handshake}}}matchesPGNDeclaration(){return!1}serializeToParsingForm(){return""}isDisabled(){return!1}getMovePossibility(e){const t=this.decorator.fenData.fenOptions.tag("royal")[this.decorator.color];t&&t[0]===this.decorator.i&&t[1]===this.decorator.j&&(e.special=s.hK.MoveOnly);for(const t of this.wrappingDecorators)if(t.getMovePossibility)return t.getMovePossibility(e);return r.V.prototype.getMovePossibility.call(this.decorator,e)}}},65587:function(e,t,i){"use strict";i.r(t),i.d(t,{Sideways:function(){return c}});var o=i(88706),r=i(19659),s=i(14381),n=i(68463),a=i(17015);class c extends s.${static{s.$.initVariantRule(c)}getDecoratorType(){return r.V}getPublicProperties(){return{parameterValue:!0,information:{name:"Sideways",description:"Pawns can also move one square sideways",tag:"sideways",color:n.p.autogenous,displayIcon:a.w.pawnSideways}}}matchesPGNDeclaration(e){return/^Sideways$/i.test(e)}serializeToParsingForm(){return"Sideways"}isDisabled(){return!1}getPossibleCells(){this.decorator.hooks.usePawnLogic&&this.injectIntoBaseClass((function(){this.generateJumpAttack({displacement:[0,-1],special:o.hK.MoveOnly}),this.generateJumpAttack({displacement:[0,1],special:o.hK.MoveOnly})}))();for(const e of this.wrappingDecorators)if(e.getPossibleCells)return e.getPossibleCells();Object.getPrototypeOf(this.decorator).getPossibleCells.call(this.decorator)}}},79019:function(e,t,i){"use strict";i.r(t),i.d(t,{Stonewall:function(){return n}});var o=i(19659),r=i(88706),s=i(14381);class n extends s.${static{s.$.initVariantRule(n)}getDecoratorType(){return o.V}getPublicProperties(){return{parameterValue:!0,information:{name:"Stonewall",textualForm:"",description:"Dead pieces cannot be captured",tag:"stonewall"}}}matchesPGNDeclaration(e){return/^Deadwall$/i.test(e)}serializeToParsingForm(){return"Deadwall"}isDisabled(){return!1}getMovePossibility(e){const{displacement:[t,i],special:s}=e;let n=e;(s===r.hK.AttackOnly||s===r.hK.Normal||s===r.hK.RayGen)&&this.decorator.board[t]&&this.decorator.board[t][i]&&this.decorator.board[t][i].isDead()&&(n={...e,special:r.hK.MoveOnly});for(const t of this.wrappingDecorators)if(t.getMovePossibility)return t.getMovePossibility(e);return o.V.prototype.getMovePossibility.call(this.decorator,n)}}},80634:function(e,t,i){"use strict";i.r(t),i.d(t,{Torpedo:function(){return a}});var o=i(19659),r=i(14381),s=i(68463),n=i(17015);class a extends r.${static{r.$.initVariantRule(a)}getDecoratorType(){return o.V}getPublicProperties(){return{parameterValue:!0,information:{name:"Torpedo",description:"Pawns can always jump two squares",tag:"torpedo",color:s.p.autogenous,displayIcon:n.w.torpedo}}}matchesPGNDeclaration(e){return/^Torpedo$/i.test(e)}serializeToParsingForm(){return"Torpedo"}isDisabled(){return!1}configure(e){const t={...e,baseRank:!0};for(const e of this.wrappingDecorators)if(e.configure)return e.configure(t);o.V.prototype.configure.call(this.decorator,t)}}},68463:function(e,t,i){"use strict";i.d(t,{p:function(){return r}});var o=i(5200);const r={minor:(0,o.TG)("#e01492"),visual:(0,o.TG)("#ad5709"),autogenous:(0,o.TG)("#f2791e"),metadata:(0,o.TG)("#89a5d3"),startingPosition:(0,o.TG)("#7030a0"),extending:(0,o.TG)("#fbaa07"),widespread:(0,o.TG)("#d40c0c"),pointsAlternation:(0,o.TG)("#00b0f0"),phased:(0,o.TG)("#00b050")}},34275:function(e,t,i){"use strict";i.d(t,{KH:function(){return k},XY:function(){return v},x7:function(){return C},xU:function(){return T},yS:function(){return P}});var o=i(53975),r=i(77028),s=i(19659),n=i(82243),a=i(11792),c=i(3936),l=i(55630),u=i(39567),d=i(25168),p=i(77396),h=i(21680),f=i(97288),g=i(55491),m=i(14381);const v=()=>({boardDecorators:[],pieceControlDecorators:[],fenDataDecorators:[],*[Symbol.iterator](){for(const e of[...this.boardDecorators,...this.pieceControlDecorators,...this.fenDataDecorators]){const t=e;yield t}}}),y=[c.SetupChess,n.ForcedCapture,l.Taboo,a.SeirawanSetup,f.PromoteTo,g.PromotionRank,d.Giveaway].reverse();function b(e,t){const i=(e,t)=>e.getDecoratorType()===t;i(e,o.$)?t.boardDecorators(e):i(e,s.V)?t.pieceControlDecorators(e):i(e,r.c)&&t.fenDataDecorators(e)}function P(e){const t=new Set,i=new Set,o=[g.PromotionRank,f.PromoteTo,p.StalemateOptions,u.FiftyMoveRule,h.ThreefoldRepetition];for(const e of m.$.variantRuleList){const o=new e;i.add(o),t.add(e)}const r=v(),s=e.split(/\s+/),n=e=>{b(e,{boardDecorators:e=>{r.boardDecorators.push(e)},pieceControlDecorators:e=>{r.pieceControlDecorators.push(e)},fenDataDecorators:e=>{r.fenDataDecorators.push(e)}});for(const[t,i]of e.dependencies)Object.values(r).some((e=>e.some((e=>e instanceof t))))||n(new t(...i))};for(const e of i)for(const t of s)e.matchesPGNDeclaration(t)&&(n(e),i.delete(e));for(const e of o)b(new e,{boardDecorators:t=>{r.boardDecorators.some((t=>t instanceof e))||r.boardDecorators.push(t)},pieceControlDecorators:t=>{r.pieceControlDecorators.some((t=>t instanceof e))||r.pieceControlDecorators.push(t)},fenDataDecorators:t=>{r.fenDataDecorators.some((t=>t instanceof e))||r.fenDataDecorators.push(t)}});for(const e of y)b(new e,{boardDecorators:()=>{const t=r.boardDecorators.findIndex((t=>t instanceof e));-1!==t&&r.boardDecorators.unshift(r.boardDecorators.splice(t,1)[0])},pieceControlDecorators:()=>{const t=r.pieceControlDecorators.findIndex((t=>t instanceof e));-1!==t&&r.pieceControlDecorators.unshift(r.pieceControlDecorators.splice(t,1)[0])},fenDataDecorators:()=>{const t=r.fenDataDecorators.findIndex((t=>t instanceof e));-1!==t&&r.fenDataDecorators.unshift(r.fenDataDecorators.splice(t,1)[0])}});return r}function C(e){const t={},i=m.$.variantRuleList.map((e=>new e));for(const e of i)t[e.getPublicProperties().information.tag]=!1;for(const i of e)t[(o=i.getPublicProperties()).information.tag]=o.parameterValue;var o;return t}function k(e){return e.map((e=>{const t=e.getPublicProperties().parameterValue,i=!1!==t?[t]:[];return new e.constructor(i)}))}function T(e){const t={variantDataRules:e.variantData,gameType:e.gameType.type,fenTags:e.data.fenOptions.tags};return{...e.variantRules,boardDecorators:e.variantRules.boardDecorators.filter((e=>!e.isDisabled(t))),pieceControlDecorators:e.variantRules.pieceControlDecorators.filter((e=>!e.isDisabled(t))),fenDataDecorators:e.variantRules.fenDataDecorators.filter((e=>!e.isDisabled(t)))}}},20461:function(e,t,i){"use strict";i.d(t,{W:function(){return k},V:function(){return M}});var o=i(14230),r=i(34275),s=i(71403);function n(e){let t="";const i=e=>{for(const o of e){o.metadata.currentFullMove&&(t=t.replace(/\s\.\.\s$/,""),t+=` ${o.metadata.currentFullMove}. `),t+=o.cachedNames.fullMoveNotation,o.comment&&(t+=` {${o.comment}}`),t+=" .. ";for(const e of o.alternativeLines)t+="(.. ",i(e),t+=" )"}t=t.replace(/\s\.\.\s$/,"")};return i(e.moves),t}var a=i(37395),c=i(72714),l=i(5593),u=i(50336),d=i(20831);const p="Variant",h="Date",f="Site",g="TimeControl",m="Termination",v="GameNr",y=()=>({tag:"playerData",currentValue:(0,c.fi)((()=>({})),l.q3),verifyTagInParsing(e){for(const t of l.O9){const i=(0,l.oh)(t);if((0,d.tk)(e,i)||(0,d.tk)(e,`${i}Elo`))return!0}return!1},parseTag(e){for(const t of l.O9){const i=(0,l.oh)(t),o=[...this.currentValue];if((0,d.tk)(e,i)){const r=(0,d.k5)(e,i);return r&&(o[t]={...o[t],name:r}),o}if((0,d.tk)(e,`${i}Elo`)){const r=Number((0,d.k5)(e,i));return isNaN(r)||(o[t]={...o[t],elo:r}),o}}throw new Error("Tag does not match any player data signature")},serialize(e){const t=[];for(const i of l.O9){const o=e.gameData.players[i];o.elo&&t.push((0,d.JY)(`${l.Q3[i]}Elo`,String(o.elo))),o.name&&t.push((0,d.JY)(`${l.Q3[i]}`,String(o.name)))}return t.join("\n")}}),b="Results",P="RuleVariants",C=()=>({variantType:{tag:"variantType",currentValue:l.Jy.FFA,verifyTagInParsing(e){return(0,d.tk)(e,p)},parseTag(e){const t=(0,d.k5)(e,p);for(const e of Object.values(l.Jy))if(t===e)return e;return l.Jy.FFA},serialize(e){return(0,d.JY)(p,e.gameType.type)}},startingPosition:(0,a.w)(),variantRules:{tag:"variantRules",currentValue:(0,r.XY)(),verifyTagInParsing(e){return(0,d.tk)(e,P)},parseTag(e){return(0,r.yS)((0,d.k5)(e,P))},serialize(e){const t=[];for(const i of e.variantRules){const e=i.serializeToParsingForm();e&&t.push(e)}return(0,d.JY)(P,t.join(" "))}},date:{tag:"date",currentValue:new Date,verifyTagInParsing(e){return(0,d.tk)(e,h)},parseTag(e){return new Date((0,d.k5)(e,h))},serialize(e){if(e.gameData.date)return"object"==typeof e.gameData.date?(0,d.JY)(h,e.gameData.date.toUTCString()):(0,d.JY)(h,e.gameData.date)}},site:{tag:"site",currentValue:"",verifyTagInParsing(e){return(0,d.tk)(e,f)},parseTag(e){return(0,d.k5)(e,f)},serialize(e){if(e.gameData.site)return(0,d.JY)(f,e.gameData.site)}},timeControl:{tag:"timeControl",currentValue:{baseTime:180,increment:2,isDelay:!1},verifyTagInParsing(e){return(0,d.tk)(e,g)},parseTag(e){const t={baseTime:180,increment:2,isDelay:!1},i=(0,d.k5)(e,g).match(/^((?:0\.\d\d?)?|(?:\d\d?s?))(?:(?:(?:\+|\|)(\d\d?)(D?))|(\smin))$/)?.slice(1);if(i){const[e,o,r]=i;if(!o)return t;t.isDelay=!!r,/\smin/.test(o)?t.increment=0:t.increment=Number(o),e.endsWith("s")?t.baseTime=Math.round(Number(e.slice(0,-1))):t.baseTime=60*Number(e)}return t},serialize(e){const t=e.gameData.timeControl,i=0===t.increment;let o="";return t.baseTime<60?o+=i?60*t.baseTime+" sec":60*t.baseTime+"s":t.baseTime>60&&i?o+=`${(0,u.O)(t.baseTime/60,1)} min`:o+=(0,u.O)(t.baseTime/60,1),i||(o+="|",o+=t.increment),t.isDelay&&(o+="D"),(0,d.JY)(g,o)}},termination:{tag:"termination",currentValue:void 0,verifyTagInParsing(e){return(0,d.tk)(e,m)},parseTag(e){const t=(0,d.k5)(e,m);return(0,l.wH)(t)?t:void 0},serialize(e){if(e.gameData.termination)return(0,d.JY)(m,e.gameData.termination)}},gameNumber:{tag:"gameNumber",currentValue:void 0,verifyTagInParsing(e){return(0,d.tk)(e,v)},parseTag(e){const t=Number((0,d.k5)(e,v));return isNaN(t)?void 0:t},serialize(e){if(e.gameData.gameNumber)return(0,d.JY)(v,e.gameData.gameNumber.toString())}},playerData:y(),results:{tag:"results",currentValue:"",verifyTagInParsing(e){return(0,d.tk)(e,b)},parseTag(e){return(0,d.k5)(e,b)},serialize(e){if(e.gameData.result)return(0,d.JY)(b,e.gameData.result)}}});function k(e){let t,i="";const n=e.match(/(?=1\.\s*?[xA-ZΑ-ωa-n0-9-])/);n?.index?(i=e.substring(n.index),t=e.substring(0,n.index).split("]").map((e=>e.trim()))):t=e.split("]").map((e=>e.trim()));const a=i.length?(0,s.Q)(i):[],c=C();for(const e of t){let t;for(t in c){const i=c[t];if(Object.prototype.hasOwnProperty.call(c,t)&&i.verifyTagInParsing(e)){i.currentValue=i.parseTag(e);break}}}const l={site:c.site.currentValue,gameNumber:c.gameNumber.currentValue,date:c.date.currentValue,timeControl:c.timeControl.currentValue,players:c.playerData.currentValue,termination:c.termination.currentValue,result:void 0},u=(0,r.x7)(c.variantRules.currentValue),d=Array.isArray(u.promotionPieces)?u.promotionPieces:[],p=Object.values(o.KR);return{gameData:l,gameType:c.variantType.currentValue,variantRules:c.variantRules.currentValue,variantRuleData:u,board:c.startingPosition.currentValue.board,fenData:c.startingPosition.currentValue.fenData,pieceSet:new Set([...c.startingPosition.currentValue.pieceSet,...d].filter((e=>!p.includes(e)))),moves:a}}const T=C();function M(e){return{board:Object.values(T).map((t=>t.serialize(e))).filter((e=>void 0!==e)).join("\n"),moves:n(e.moves)}}},71403:function(e,t,i){"use strict";i.d(t,{Q:function(){return u},T:function(){return l}});var o=i(72714),r=i(14230),s=i(12850),n=i(17744),a=i(88706),c=i(20831);const l={SPLIT:".",PIECE_REGEX:/[xA-ZΑ-ωa-nrbyg0-9-=+#@]/,PIECE_REGEX_SIMPLIFIED:/[A-ZΑ-ωa-n0-9-]/,MOVE_CAPTURING_REGEX:/^[A-ZΑ-ω]?([a-n]\d{1,2})(?:-|x[A-ZΑ-ω]?)[A-ZΑ-ω]?([a-n]\d{1,2})/,DUCK_MOVE_CAPTURING_REGEX:/Θ([a-n]\d{1,2})?-([a-n]\d{1,2})/,DROPPING_MOVE_CAPTURING_REGEX:/Θ?@([a-z])([A-ZΑ-ω])-([a-n]\d{1,2})/,BRACKETS:{COMMENT_START:"{",COMMENT_END:"}",VARIATION_START:"(",VARIATION_END:")"},COORDINATE_REGEX:/[a-n](?:(?:1[0-4])|(?:[1-9]))/,COMMENT_SYNTAXES:{CLOCK:/\[%timestamp (-?\d+?)]/,ARROWS:/\[%cal ((?:R|B|Y|G).+?)]/,SQUARES:/\[%csl ((?:R|B|Y|G).+?)]/,ANNOTATION:/\[%ann (.+?)]/}},u=e=>{const t=(i,u)=>{const d=[],p=u;function h(e){for(;i[e]&&l.PIECE_REGEX.test(i[e]);)e++;return e}function f(e){for(;i[e]&&i[e]!==l.BRACKETS.COMMENT_END;)e++;return e}function g(e){for(;i[e]&&/\d|\./.test(i[e]);)e++;return--e}function m(e){let t=0;for(;e<i.length;e++)switch(i[e]){case l.BRACKETS.COMMENT_START:e=f(e);break;case l.BRACKETS.VARIATION_START:t++;break;case l.BRACKETS.VARIATION_END:if(0==--t)return e}throw new TypeError("No matching parentheses for input "+i)}function v(){if(b){p.push(++C),P.path=p.slice(),p.pop(),P.moveData=b.map((e=>function(e){if((0,n.LR)(e))return{type:e.type};if("startCoordinates"in e){const t={startCoordinates:[...e.startCoordinates],endCoordinates:[...e.endCoordinates]};return"specialType"in e&&(t.specialType=e.specialType),"promotion"in e&&(t.promotion=e.promotion),t}return{endCoordinates:e.endCoordinates,piece:e.piece}}(e))),P.metadata=(0,n.SK)();const e=P.comment?.match(l.COMMENT_SYNTAXES.CLOCK);e&&!isNaN(Number(e[1]))&&(P.comment=P.comment?.replace(l.COMMENT_SYNTAXES.CLOCK,""),P.metadata.playerClock=Number(e[1]));const t=P.comment?.match(l.COMMENT_SYNTAXES.ARROWS);if(t){const e=t[1].split(",");for(const t of e){const[e,i]=[t[0],t.slice(1)],o=e.toLowerCase(),s=(0,c.Lx)(i);(0,r.OT)(o)&&s&&P.metadata.highlightedArrows.push([r.JF[o],...s])}P.comment=P.comment?.replace(l.COMMENT_SYNTAXES.ARROWS,"")}const i=P.comment?.match(l.COMMENT_SYNTAXES.SQUARES);if(i){const e=i[1].split(",");for(const t of e){const[e,i]=[t[0],t.slice(1)],o=e.toLowerCase(),s=(0,c._q)(i);(0,r.OT)(o)&&s&&P.metadata.highlightedSquares.push([r.JF[o],s])}P.comment=P.comment?.replace(l.COMMENT_SYNTAXES.SQUARES,"")}const o=P.comment?.match(l.COMMENT_SYNTAXES.ANNOTATION);o&&(P.metadata.annotation=o[1],P.comment=P.comment?.replace(l.COMMENT_SYNTAXES.ANNOTATION,"")),(0,n.Qc)(P)?d.push(Object.assign({},P)):console.error(`Not all properties of move wrapper are filled out: ${JSON.stringify(P)}`),P={alternativeLines:[],comment:""},b=void 0}}function y(e){const t=[],i=function(e){let t;for(t in n.Fi)if(Object.prototype.hasOwnProperty.call(n.Fi,t)&&n.Fi[t]===e)return{type:n.Fi[t]}}(e[0]);if(1===e.length&&void 0!==i)return[i];const u=function(e){const t={startCoordinates:[-1,-1],endCoordinates:[-1,-1]},i=e.match(/.*?=([A-Zx])/);i?.[1]&&(t.promotion=[(0,s.HC)(s.Ir,i[1].charAt(0))]);const r=e.match(l.MOVE_CAPTURING_REGEX);if(r){const e=(0,c._q)(r[1]),i=(0,c._q)(r[2]);return(0,o.lM)(e),(0,o.lM)(i),t.startCoordinates=e,t.endCoordinates=i,t}return/O-O-O.*/.test(e)?{...t,specialType:n.uj.CastlingQueenside}:/O-O.*/.test(e)?{...t,specialType:n.uj.CastlingKingside}:void 0}(e);u&&t.push(u);const d=function(e){const t=e.match(l.DROPPING_MOVE_CAPTURING_REGEX);if(t){const[,e,i,o]=t;if(!(0,r.OT)(e)||!(0,a.IM)(i))return;const n=(0,c._q)(o);if(!n)return;return{piece:(0,s.HC)(r.JF[e],i),endCoordinates:n}}}(e);d&&t.push(d);const p=function(e){const t=e.match(l.DUCK_MOVE_CAPTURING_REGEX);if(t){if(t[1]){const e=(0,c._q)(t[1]),i=(0,c._q)(t[2]);if(!e||!i)return;return{startCoordinates:e,endCoordinates:i}}{const e=(0,c._q)(t[2]);if(!e)return;return{piece:s.St,endCoordinates:e}}}}(e);if(p&&t.push(p),(0,n.nc)(t))return t;throw new Error(`Move length is 0 for string ${e}`)}let b,P={alternativeLines:[],comment:""},C=-1,k=-1;try{for(let o=0;o<i.length;o++){const r=isNaN(Number(i[o]));if(r&&!/\s/.test(i[o])&&i[o]!==l.SPLIT){if(l.PIECE_REGEX_SIMPLIFIED.test(i[o])){const e=h(o);b=y(i.substring(o,e)),o=e}else if(e[o]===l.BRACKETS.COMMENT_START){const t=f(o);P.comment=e.substring(o+1,t),o=t}else if(e[o]===l.BRACKETS.VARIATION_START){const i=m(o);p.push(C+1,++k),P.alternativeLines?.push([...t(e.substring(o+1,i),p.slice())]),o=i}}else(i[o]===l.SPLIT&&e[o+1]&&e[o+1]===l.SPLIT||e[o].trim()&&!r&&e[o+1]&&(e[o+1]===l.SPLIT||!isNaN(Number(e[o+1]))))&&(r||(o=g(o)),b&&v())}}finally{v(),p.push(C+1),P.path=p.slice(),(0,n.Qc)(P)&&d.push(Object.assign({},P))}return d};return t(e,[])}},37395:function(e,t,i){"use strict";i.d(t,{w:function(){return f}});var o=i(72714),r=i(92052),s=i(77028),n=i(5593),a=i(14230),c=i(12850),l=i(20831);function u(e,[t,i]){const o=(n.iJ-e[0])/2,r=(n.iJ-e[1])/2;return t<o||t>=o+e[0]||i<r||i>=r+e[1]}function d(e,t){const i=e.split(",").map((e=>Boolean(Number(e))));(0,o.CG)(i,n.q3)?t.forEach(((e,t,o)=>o[t]=i[t])):(console.error("Incorrect amount of arguments for the boolean parameter length in FENData: "+e),console.trace(`Expected ${n.q3} arguments, but got ${i.length}`))}const p={"4PC":"R-0,0,0,0-1,1,1,1-1,1,1,1-0,0,0,0-0-x,x,x,yR,yN,yB,yK,yQ,yB,yN,yR,x,x,x/x,x,x,yP,yP,yP,yP,yP,yP,yP,yP,x,x,x/x,x,x,8,x,x,x/bR,bP,10,gP,gR/bN,bP,10,gP,gN/bB,bP,10,gP,gB/bQ,bP,10,gP,gK/bK,bP,10,gP,gQ/bB,bP,10,gP,gB/bN,bP,10,gP,gN/bR,bP,10,gP,gR/x,x,x,8,x,x,x/x,x,x,rP,rP,rP,rP,rP,rP,rP,rP,x,x,x/x,x,x,rR,rN,rB,rQ,rK,rB,rN,rR,x,x,x","4PCo":"R-0,0,0,0-1,1,1,1-1,1,1,1-0,0,0,0-0-x,x,x,yR,yN,yB,yK,yQ,yB,yN,yR,x,x,x/x,x,x,yP,yP,yP,yP,yP,yP,yP,yP,x,x,x/x,x,x,8,x,x,x/bR,bP,10,gP,gR/bN,bP,10,gP,gN/bB,bP,10,gP,gB/bK,bP,10,gP,gQ/bQ,bP,10,gP,gK/bB,bP,10,gP,gB/bN,bP,10,gP,gN/bR,bP,10,gP,gR/x,x,x,8,x,x,x/x,x,x,rP,rP,rP,rP,rP,rP,rP,rP,x,x,x/x,x,x,rR,rN,rB,rQ,rK,rB,rN,rR,x,x,x","4PCb":"R-0,0,0,0-1,1,1,1-1,1,1,1-0,0,0,0-0-x,x,x,yR,yN,yB,yQ,yK,yB,yN,yR,x,x,x/x,x,x,yP,yP,yP,yP,yP,yP,yP,yP,x,x,x/x,x,x,8,x,x,x/bR,bP,10,gP,gR/bN,bP,10,gP,gN/bB,bP,10,gP,gB/bQ,bP,10,gP,gQ/bK,bP,10,gP,gK/bB,bP,10,gP,gB/bN,bP,10,gP,gN/bR,bP,10,gP,gR/x,x,x,8,x,x,x/x,x,x,rP,rP,rP,rP,rP,rP,rP,rP,x,x,x/x,x,x,rR,rN,rB,rQ,rK,rB,rN,rR,x,x,x","4PCn":"R-0,0,0,0-1,1,1,1-1,1,1,1-0,0,0,0-0-x,x,x,yR,yN,yB,yQ,yK,yB,yN,yR,x,x,x/x,x,x,yP,yP,yP,yP,yP,yP,yP,yP,x,x,x/x,x,x,8,x,x,x/bR,bP,10,gP,gR/bN,bP,10,gP,gN/bB,bP,10,gP,gB/bQ,bP,10,gP,gK/bK,bP,10,gP,gQ/bB,bP,10,gP,gB/bN,bP,10,gP,gN/bR,bP,10,gP,gR/x,x,x,8,x,x,x/x,x,x,rP,rP,rP,rP,rP,rP,rP,rP,x,x,x/x,x,x,rR,rN,rB,rQ,rK,rB,rN,rR,x,x,x","2PC":"R-0,1,0,1-1,1,1,1-1,1,1,1-0,0,0,0-0-{'pawnBaseRank':5,'wb':true,'dim':'8x8'}-x,x,x,x,x,x,x,x,x,x,x,x,x,x/x,x,x,x,x,x,x,x,x,x,x,x,x,x/x,x,x,x,x,x,x,x,x,x,x,x,x,x/x,x,x,yR,yN,yB,yQ,yK,yB,yN,yR,x,x,x/x,x,x,yP,yP,yP,yP,yP,yP,yP,yP,x,x,x/x,x,x,8,x,x,x/x,x,x,8,x,x,x/x,x,x,8,x,x,x/x,x,x,8,x,x,x/x,x,x,rP,rP,rP,rP,rP,rP,rP,rP,x,x,x/x,x,x,rR,rN,rB,rQ,rK,rB,rN,rR,x,x,x/x,x,x,x,x,x,x,x,x,x,x,x,x,x/x,x,x,x,x,x,x,x,x,x,x,x,x,x/x,x,x,x,x,x,x,x,x,x,x,x,x,x"},h="StartFen4",f=()=>({tag:"startingPosition",currentValue:{board:(0,r.BD)((()=>c.v2)),fenData:new s.c,pieceSet:new Set},verifyTagInParsing(e){return(0,l.tk)(e,h)},parseTag(e){const t=(0,l.k5)(e,h),i=t in p?p[t]:t,f=new s.c,g=(0,r.BD)((()=>c.v2)),m=new Set,v=(0,c.m9)("x"),y=i.split("-");if(y.length<7||y[y.length-1].split("/").length!==n.iJ)console.warn("FEN has less than 7 parts: "+i);else{const e=y[0].charAt(0).toLowerCase();(0,a.OT)(e)?f.sideToMove=a.JF[e]:console.warn("FEN option 1: side to move is not an alphabetic color: "+e),d(y[1],f.fenOptions.tag("dead")),d(y[2],f.fenOptions.tag("castleKingside")),d(y[3],f.fenOptions.tag("castleQueenside"));const t=y[4].split(",").map((e=>Number(e)));(0,o.CG)(t,n.q3)?f.points=t:console.warn(`FEN option 5: points is of incorrect length: ${t.join(",")}`),f.plyCount=Number(y[5]);const i=(0,o.VS)(null,n.q3),r=e=>e in f.fenOptions.tags;if(y[6].startsWith("{")){const e=JSON.parse(y[6].replaceAll("(","[").replaceAll(")","]").replaceAll("'",'"'));if("object"!=typeof e||null===e)throw new Error("Unexpected object definition syntax for "+String(e));for(const[t,i]of Object.entries(e)){if(!r(t))continue;const e=f.fenOptions.tags[t];e.value=e.parse(i)}}const s=y[y.length-1].split("/"),l=f.fenOptions.tag("dim");s.forEach(((e,t)=>{let o=0;for(let r of e.split(","))if(r.endsWith('"')&&(r=r.slice(0,-1)),isNaN(Number(r)))try{if(!u(l,[t,o])){const e=(0,c.m9)(r);g[t][o]=e,e.isPiece()&&("K"!==e.piece||i[e.color]||(i[e.color]=[t,o]),m.add(e.piece))}}finally{o++}else o+=Number(r)}));for(const e of n.O9)for(const[t]of f.fenOptions.tag("bank")[e])t.piece in a.KR||m.add(t.piece);f.fenOptions.setTag("royal",i);for(let e=0;e<n.iJ;e++)for(let t=0;t<n.iJ;t++)u(l,[e,t])&&(g[e][t]=v)}if(!f.fenOptions.tag("noCorners")){const e=3,t=n.iJ-1;e:for(let i=0;i<e;i++)for(let o=0;o<e;o++){const e=[[i,o],[t-i,o],[i,t-o],[t-i,t-o]];for(const t of e){const e=g[t[0]][t[1]];if(!e.isWall()||e.piece!==v.piece){f.fenOptions.setTag("noCorners",!0);break e}}}}return{fenData:f,board:g,pieceSet:m}},serialize(e){const{board:t,data:i}=e;let o="";o+=`${a.Od[i.sideToMove].toUpperCase()}-`,o+=`${i.fenOptions.tag("dead").map((e=>Number(e))).join(",")}-`,o+=`${i.fenOptions.tag("castleKingside").map((e=>Number(e))).join(",")}-`,o+=`${i.fenOptions.tag("castleQueenside").map((e=>Number(e))).join(",")}-`,o+=`${i.points.join(",")}-`,o+=`${i.plyCount}-`,o+=`${function(e){const t=[];let i;for(i in e.tags){if(!Object.prototype.hasOwnProperty.call(e.tags,i))continue;const o=e.tags[i].serialize();o&&t.push(o)}return`{${t.join(",")}}`}(i.fenOptions)}-`;let r=0;for(const e of t){for(const t of e)t.isEmpty()?r++:(0!==r&&(o+=`${r},`,r=0),o+=`${t.value},`);0!==r?(o+=`${r}/`,r=0):(o=o.slice(0,-1),o+="/")}return o=o.slice(0,-1),(0,l.JY)(h,o)}})},20831:function(e,t,i){"use strict";function o(e){if(0===e.length)return;const t=[14-Number(e.slice(1)),e.charCodeAt(0)-97];return Number.isNaN(t[0])||Number.isNaN(t[1])||t[0]<0||t[0]>13||t[1]<0||t[1]>13?void 0:t}function r(e){if(0===e.length)return;const t=e.split(":");return[[14-Number(t[0].slice(1)),t[0].charCodeAt(0)-97],[14-Number(t[1].slice(1)),t[1].charCodeAt(0)-97]]}i.d(t,{JY:function(){return s},Lx:function(){return r},_q:function(){return o},k5:function(){return a},tk:function(){return n}});const s=(e,t)=>`[${e} "${t}"]`,n=(e,t)=>e.toLowerCase().startsWith(`[${t.toLowerCase()} "`),a=(e,t)=>e.replace(`[${t} "`,"").slice(0,-1)},8971:function(e,t,i){"use strict";function o(e){let t=e.length,i=0;for(;0!==t;)i=Math.floor(Math.random()*t--),[e[t],e[i]]=[e[i],e[t]];return e}function r(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++){const o=e[i],s=t[i];if(Array.isArray(o)&&Array.isArray(s)){if(!r(o,s))return!1}else if(o!==s)return!1}return!0}function s(e){let t=1/0;for(const i of e)for(const e of i)0!==e&&e<t&&(t=e);return t}function n(e,t){let i=e.length;for(;i--;)if(t(e[i],i,e))return i;return-1}i.d(t,{Bx:function(){return s},Rt:function(){return r},Sy:function(){return o},qr:function(){return n}})},50336:function(e,t,i){"use strict";function o(e,t){const i=Math.pow(10,t),o=e*i;return o<0?Math.ceil(o/i):Math.floor(o/i)}function r(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>24}i.d(t,{O:function(){return o},y:function(){return r}})},67037:function(e,t,i){"use strict";function o(e,t,i=!1){const o=Object.getPrototypeOf(e);if("object"!=typeof o)throw new Error("Expected prototype to be an object");const r=Object.create(o);if("object"!=typeof r||null===r)throw new Error("Expected prototype to be an object");const s=Object.assign(r,i?{}:e);if(!(s instanceof t))throw new Error("Expected prototype to not be overridden");return s}i.d(t,{T9:function(){return r},lJ:function(){return o}});const r=e=>"object"==typeof e&&null!==e},52514:function(e,t,i){"use strict";function o(e){const t=Number(String(e).slice(-2));if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}function r(e){if(0===e.length)return"";if(1===e.length)return e[0];let t="";for(let i=0;i<e.length;i++)i===e.length-2?t+=` ${e[i]} or `:i===e.length-1?t+=e[i]:t+=e[i]+", ";return t}function s(e){return/[AEUIO]/i.test(e.charAt(0))?"an "+e:"a "+e}i.d(t,{od:function(){return o},uC:function(){return r},zL:function(){return s}})},73949:function(e,t,i){var o={"./BoardDecorators/AllowPassing.ts":19851,"./BoardDecorators/AlternativeTeams.ts":85038,"./BoardDecorators/BarePieceRule.ts":51226,"./BoardDecorators/Blindfold.ts":37869,"./BoardDecorators/CaptureTheKing.ts":22667,"./BoardDecorators/Chess960.ts":95291,"./BoardDecorators/Crazyhouse.ts":91617,"./BoardDecorators/DuckChess.ts":34819,"./BoardDecorators/FogOfWar.ts":5443,"./BoardDecorators/ForcedCapture.ts":82243,"./BoardDecorators/GameMetadataRules.ts":53821,"./BoardDecorators/Ghostboard.ts":74914,"./BoardDecorators/ParadigmChess30.ts":47992,"./BoardDecorators/PiecesFaceCenter.ts":50704,"./BoardDecorators/SeirawanSetup.ts":11792,"./BoardDecorators/SelfCheck.ts":20246,"./BoardDecorators/SetupChess.ts":3936,"./BoardDecorators/Taboo.ts":55630,"./BoardVariantModules/EngineMoveGeneration/Algorithms/ComfuterEvaluation.ts":61271,"./BoardVariantModules/EngineMoveGeneration/Algorithms/ComfuterEvaluationExtensions.ts":41138,"./BoardVariantModules/EngineMoveGeneration/Algorithms/MixedAlgorithms.ts":22655,"./BoardVariantModules/EngineMoveGeneration/Algorithms/RandomEvaluation.ts":15901,"./BoardVariantModules/EngineMoveGeneration/Algorithms/RandomEvaluationExtensions.ts":77832,"./BoardVariantModules/EngineMoveGeneration/BotInterface.ts":95488,"./BoardVariantModules/InsufficientMaterial/InsufficientMaterialChecker.ts":43341,"./BoardVariantModules/InsufficientMaterial/InsufficientMaterialConstructor.ts":11390,"./BoardVariantModules/InsufficientMaterial/PieceMedianCounter.ts":92513,"./BoardVariantModules/InsufficientMaterial/StateSerializer.ts":22953,"./BoardVariantModules/InsufficientMaterial/Utilities.ts":42478,"./FENDataDecorators/Atomic.ts":78965,"./FENDataDecorators/DeadKingWalking.ts":65564,"./FENDataDecorators/EnPassant.ts":50175,"./FENDataDecorators/FatalCapture.ts":89577,"./FENDataDecorators/FiftyMoveRule.ts":39567,"./FENDataDecorators/Giveaway.ts":25168,"./FENDataDecorators/KingOfTheHill.ts":72858,"./FENDataDecorators/NCheck.ts":5954,"./FENDataDecorators/OppositeMultiplier.ts":67090,"./FENDataDecorators/OppositeSideCastling.ts":25427,"./FENDataDecorators/PiecesGoToBanks.ts":74406,"./FENDataDecorators/PlayForMate.ts":19798,"./FENDataDecorators/PointsForMate.ts":82620,"./FENDataDecorators/StalemateOptions.ts":77396,"./FENDataDecorators/Takeover.ts":38191,"./FENDataDecorators/ThreefoldRepetition.ts":21680,"./PieceControlDecorators/AnyCapture.ts":17224,"./PieceControlDecorators/PromoteTo.ts":97288,"./PieceControlDecorators/PromotionRank.ts":55491,"./PieceControlDecorators/RoyalsCannotCapture.ts":83460,"./PieceControlDecorators/Sideways.ts":65587,"./PieceControlDecorators/Stonewall.ts":79019,"./PieceControlDecorators/Torpedo.ts":80634};function r(e){var t=s(e);return i(t)}function s(e){if(!i.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=s,e.exports=r,r.id=73949}}]);
//# sourceMappingURL=630.react-app.js.map